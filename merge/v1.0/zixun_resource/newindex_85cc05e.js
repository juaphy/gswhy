;/*!/pagelet/channels/channels.js*/
define("pagelet/channels/channels",["require","exports","module"],function(e,o,s){var n=200,t=546,a=1056,i=t+n,h=i,l=0,r=["news_military","news_world","news_fashion","news_travel","news_discovery","news_baby","news_regimen","news_story","news_essay","news_game","news_history","news_food"],c=r.join("|");s.exports=Pagelet.extend({el:"#pagelet-channels",events:{"mouseenter $moreBox":"showLayer","mouseleave $moreBox":"hideLayer"},channels:{"com.toutiao.channels scroll":"oChannelsScroll"},init:function(e){this.spec=e||{},this.$win=$(window),this.$doc=$(document),this.$more_item=$(".more-item"),this.adjustSelectedChannel(this.spec)},onMoreClick:function(){this.$more_item.addClass("show-channel"),this.$dom.moreBox.hide(),this.effectCode&&(h=a+n)},onFoldClick:function(){this.$more_item.removeClass("show-channel"),this.$dom.moreBox.show(),this.effectCode&&(h=i)},onCategoryClick:function(e){var o=$(e.currentTarget),s=o.data("category"),n="/"+s+"/";"__all__"===s&&(n="/"),window.location.href=n},channelNavEffect:function(){var e=this;if(e.effectCode){var o=e.$el.clone();o.removeAttr("id").addClass("channel-effect-1 fixed-channels").appendTo($("body")),$(window).on("scroll",function(){e.scrollTimer&&clearTimeout(e.scrollTimer),e.scrollTimer=setTimeout(function(){var s=$(document).scrollTop();switch(e.effectCode){case 1:s>h&&!e.showBottomChannels?(e.showBottomChannels=!0,o.addClass("show")):h>=s&&e.showBottomChannels&&(e.showBottomChannels=!1,o.removeClass("show"));break;case 2:s>h?l>s&&!e.showBottomChannels?(e.showBottomChannels=!0,o.addClass("show")):s>=l&&e.showBottomChannels&&(e.showBottomChannels=!1,o.removeClass("show")):h>=s&&e.showBottomChannels&&(e.showBottomChannels=!1,o.removeClass("show")),l=s}},50)})}},oChannelsScroll:function(e,o){o?this.$el.addClass("sticky"):this.$el.removeClass("sticky")},showLayer:function(e){var o=this,s=$(e.currentTarget),n=s.data("node"),t=n+"hidetimer",a=n+"showtimer";this[t]&&clearTimeout(this[t]),this[a]=setTimeout(function(){o.$dom[n].addClass("show-layer")},100)},hideLayer:function(e){var o=this,s=$(e.currentTarget),n=s.data("node"),t=n+"hidetimer",a=n+"showtimer";this[a]&&clearTimeout(this[a]),this[t]=setTimeout(function(){o.$dom[n].removeClass("show-layer")},100)},adjustSelectedChannel:function(e){var o=e.category||"_null_";if(-1!=c.indexOf(o)){var s=this.$dom.moreChannels,n=s.find(".item_"+o);if(n.length){var t=this.$dom.channelBox,a=t.children().last();n.appendTo(t),a.length&&a.prependTo(s)}}}})});
;/*!/pagelet/model/ad.js*/
define("pagelet/model/ad",["require","exports","module"],function(){var e={url:"/api/web_ads/",init:function(){this.data="",this.reqQueue=[],this.getDataFromServer()},getDataByPos:function(e){for(var t=this.data.length,r=0,u="";t>r;r++){var a=this.data[r];a.web_position==e&&(u=a)}return u},getDataFromServer:function(){var e=this;$.get(e.url,function(t){var t=t||{};"success"==t.status&&t.data?(e.data=t.data,e.consumQueue()):e.rejectQueue(t)})},rejectQueue:function(){for(;this.reqQueue.length;){var e=this.reqQueue.shift(),t=(e.pos,e.deferred);t.reject({msg:"广告请求错误"})}},consumQueue:function(){for(var e={1:"信息流",2:"右侧banner"};this.reqQueue.length;){var t=this.reqQueue.shift(),r=t.pos,u=t.deferred,a=this.getDataByPos(r);if(a)u.resolve(a);else{var s="没有"+e[r]+"广告";u.reject({msg:s})}}},getData:function(e){var t=$.Deferred(),r={deferred:t,pos:e};return this.reqQueue.push(r),this.data?this.consumQueue():this.getDataFromServer(),t}};return e});
;/*!/pagelet/model/ad_third.js*/
define("pagelet/model/ad_third",["require","exports","module"],function(){var t=function(t){this.timer="",this.offset=55,this.list=[],this.create(t)};return t.prototype.create=function(t){var e,i=this;$(t).each(function(t,o){e=$(o),i.list.push({dom:e,height:e.height(),offset:e.offset(),track:e.data("track")||e.attr("data-track"),visible:e.is(":visible"),inView:!1})}),$(document).scroll(function(){i.watch(i.offset||0)})},t.prototype.watch=function(t){var e,i=this.list,o=this,r=!1,n=$(window).scrollTop();this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){for(var a=0,s=i.length;s>a;a++)e=i[a],r=1*e.offset.top+1*e.height-t-n,r=r>0?!0:!1,r&&!e.inView&&e.visible&&o.report(e.track),e.inView=r},100)},t.prototype.report=function(t){var e=this,i=new Image;i.onload=e.callback,i.onerror=e.error,t&&(i.src=t+"?r="+Math.random())},t.prototype.callback=function(){},t.prototype.error=function(){},t});
;/*!/pagelet/nfeedlistx/cacheCtr.js*/
define("pagelet/nfeedlistx/cacheCtr",["require","exports","module"],function(e,t,n){var r=window.localStorage;n.exports={exist:function(){return r&&r.getItem},encode:function(e){return JSON.stringify(e)},decode:function(e){return JSON.parse(e)},get:function(e){var t;try{t=r.getItem(e)}catch(n){}return t},set:function(e,t){try{r.setItem(e,t)}catch(n){}},del:function(e){try{r.removeItem(e)}catch(t){}},clear:function(){try{r.clear()}catch(e){}}}});
;/*!/pagelet/nfeedlistx/nfeedlistx.js*/
define("pagelet/nfeedlistx/nfeedlistx",["require","exports","module","common/loginDialog/loginDialog","common/util/dateFormat","common/util/user","common/confirm/confirm","pagelet/model/ad","pagelet/model/ad_third","common/util/timeago","pagelet/nfeedlistx/cacheCtr"],function(require,exports,module){var dateFormat=(require("common/loginDialog/loginDialog"),require("common/util/dateFormat")),confirm=(require("common/util/user"),require("common/confirm/confirm")),TEMPLATE=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var i=0;i<data.length;i++){var item=data[i],feedimg="",gaTitleEvent="click_feed_news_word",hasImgList=!1;if(item.source=item.source.replace(/\s*/gi,""),0!=item.source.length||"forum"!=item.tag){if(item.has_video&&(gaTitleEvent="click_feed_news_video"),item.middle_mode?feedimg=item.image_url:item.image_list.length&&(item.has_gallery||(feedimg=item.image_list[0].url),item.has_gallery&&(gaTitleEvent="click_feed_news_image",hasImgList=!0)),__p+='\n<li class="item clearfix" data-node="item" ga_event="'+(null==(__t=gaTitleEvent)?"":_.escape(__t))+'">\n	',__p+=data[i].abstract?'\n	<div class="item-inner">\n	':'\n	<div class="item-inner no-abstract">\n	',__p+="\n\n	",feedimg&&(__p+='\n	<div class="lbox left">\n		<a ga_event="click_feed_newsimg" href="'+(null==(__t=data[i].source_url)?"":_.escape(__t))+'" target="_blank">\n			<img class="feedimg" src="'+(null==(__t=feedimg)?"":_.escape(__t))+'" onload="this.style.opacity=1;">\n			',data[i].has_video&&(__p+='\n			<i class="ftype video">\n				',data[i].video_duration_str&&(__p+="\n				<span>"+(null==(__t=data[i].video_duration_str)?"":_.escape(__t))+"</span>\n				"),__p+="\n			</i>\n			"),__p+='\n		</a>\n	</div>\n	<div class="rbox">\n		<div class="rbox-inner">\n	'),__p+='\n\n	<div class="title-box">\n		<a ga_event="click_feed_newstitle" class="link title" href="'+(null==(__t=data[i].source_url)?"":_.escape(__t))+'" target="_blank" data-node="title">\n			'+(null==(__t=data[i].title)?"":_.escape(__t))+"\n		</a>\n	</div>\n\n	",hasImgList){__p+='\n	<div class="img-list clearfix">\n		';for(var j=0;j<item.image_list.length;j++)__p+='\n		<a class="img-wrap" href="'+(null==(__t=item.source_url)?"":_.escape(__t))+'" target="_blank" ',j===data[i].image_list.length-1&&(__p+='style="margin-right: 0;"'),__p+=' ga_event="click_ feed_newstitle_pic">\n			<img src="'+(null==(__t=item.image_list[j].pc_url)?"":_.escape(__t))+'" alt="">\n		</a>\n		';__p+='\n		<span class="img-num">'+(null==(__t=item.gallary_image_count)?"":_.escape(__t))+"图</span>\n	</div>\n	"}__p+="\n\n	",data[i].abstract&&!hasImgList&&(__p+='\n	<div class="abstract">\n		<a ga_event="click_feed_newsabstract" class="link" href="'+(null==(__t=data[i].source_url)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=data[i].abstract)?"":_.escape(__t))+"</a>\n	</div>\n	"),__p+='\n\n	<div class="footer clearfix">\n		<div class="left lfooter">\n			',data[i].hot&&(__p+='\n			<span class="lbtn tag tag-hot">热</span>\n			'),__p+="\n			"," "!=data[i].source&&(__p+="undefined"==typeof data[i].media_url?'\n				<span class="lbtn source">'+(null==(__t=data[i].source)?"":_.escape(__t))+"&nbsp;&sdot;</span>\n			":'\n				<a class="lbtn source hover-color" href="'+(null==(__t=data[i].media_url||data[i].source_url)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=data[i].source)?"":_.escape(__t))+'&nbsp;&sdot;</a>\n				<a class="lbtn comment hover-color" href="'+(null==(__t=data[i].source_url)?"":_.escape(__t))+'/#comment_area" data-node="to_comment" target="_blank">'+(null==(__t=data[i].comment_count)?"":_.escape(__t))+"评论&nbsp;&sdot;</a>\n			"),__p+='\n\n			<span class="lbtn time" data-publishtime="'+(null==(__t=data[i].behot_time)?"":_.escape(__t))+'" title="'+(null==(__t=dateFormat(new Date(1e3*data[i].behot_time),"yyyy-MM-dd hh:mm"))?"":_.escape(__t))+'">\n				'+(null==(__t=dateFormat(new Date(1e3*data[i].behot_time),"hh:mm"))?"":_.escape(__t))+'\n			</span>\n		</div>\n\n		<div class="right rfooter">\n			<span class="rbtn dislike" title="不喜欢" data-node="dislike" data-groupid="'+(null==(__t=data[i].group_id)?"":_.escape(__t))+'" ga_event="dislike_delete"></span>\n		</div>\n	</div>\n\n	',feedimg&&(__p+="\n		</div></div>\n	"),__p+="\n	</div>\n</li>\n"}}__p+="\n"}return __p},ADModel=require("pagelet/model/ad"),ADMonitor=require("pagelet/model/ad_third");require("common/util/timeago");var cacheCtr=require("pagelet/nfeedlistx/cacheCtr"),CACHEID="1",LIST_AJAX="/api/article/recent/?source=2",DISLIKE_AJAX="/api/dislike/",UNREAD_DELAY=18e4,LOAD_HEIGHT=850;module.exports=Pagelet.extend({el:"#pagelet-nfeedlistx",events:{"click $unread":"onUnreadClick","click $loadMore":"onLoadMoreClick","click $commClose":"onCommCloseClick","click $title":"onTitleClick","click $commLink":"onTaqClick","click $dislike":"onDislikeClick"},channels:{"com.toutiao.feedlist refresh":"onFeedListRefresh"},init:function(e){var t=this;this.$win=$(window),this.$doc=$(document),this.spec=e,this.loading=!1,this.scrollTimer="",this.maxCreateTime=0,this.searchOffset=0,this.keyword=this.spec.keyword||"",this.pageid=this.spec.pageid||"",this.curMaxBehotTime=this.spec.max_behot_time,this.$win.on("scroll",$.proxy(this.onWinScroll,this)),this.getFirstScreen(),this.spec.unreadTips&&"__all__"===this.spec.category&&(this.unReadTimer=setTimeout(function(){t.$dom.unread.slideDown("fast")},UNREAD_DELAY))},getFirstScreen:function(){var e=this,t=window.START_TIME||(new Date).getTime();if(cacheCtr.exist()&&cacheCtr.get("cache_id")===CACHEID){var i=cacheCtr.get(location.pathname);i&&(i=cacheCtr.decode(i),this.render(i))}this.sendCustomLog({action:"log",event:"feed_appear_time",useTime:(new Date).getTime()-t}),this.onFeedListRefresh(function(){e.$dom.loadMore.show(),e.insertAD()})},insertAD:function(){var e=this,t=function(t){t.img&&(t.web_url||(e.$dom.commLink.bind("click",function(e){e.preventDefault()}),e.$dom.commLink.css({cursor:"default"})),e.$dom.commLink.attr("track",t.track_url).data("track",t.track_url).attr("href",t.web_url).html('<img src="'+t.img+'" onload="this.style.opacity=1;">'),e.$dom.commItem.show())},i=3,a=1,n=ADModel.getData(a);n.then(function(e){t(e,i);try{ad_monitor=new ADMonitor(".ad_nfeed",55)}catch(a){console.log&&console.log(a)}_taq.push(["trackevent",location.href,"pv","toutiao_web",null,""])},function(e){console.log(e.msg||"请求广告错误")})},render:function(e){e.dateFormat=dateFormat,this.$dom.listBox.append(TEMPLATE(e)),$(".time").timeago()},getArticleList:function(e){if(!this.loading){this.loading=!0;var t=(new Date).getTime(),i={count:20,category:this.spec.category,max_behot_time:this.curMaxBehotTime,utm_source:"toutiao",offset:0};this.maxCreateTime&&(i.max_create_time=this.maxCreateTime),$.ajax({url:LIST_AJAX,type:"GET",dataType:"json",context:this,data:i,success:function(i){if(this.loading=!1,i=i||{},"success"===i.message){var a=i.next||{},n=i.data||[],o=n[n.length-1]||{},s=(new Date).getTime();this.curMaxBehotTime=a.max_behot_time,this.maxCreateTime=o.create_time||0,n.length>5&&this.sendCustomLog({action:"log",event:"channel_ajax_time",useTime:s-t}),this.render(i),n.length>5&&this.sendCustomLog({action:"log",event:"channel_render_time",useTime:(new Date).getTime()-s}),i.has_more||(this.$dom.loadMore.hide(),this.$dom.noloadMore.show(),this.$win.off("scroll")),"function"==typeof e&&e()}},error:function(){this.loading=!1}})}},onLoadMoreClick:function(){window.gaqpush&&window.gaqpush("loadmore",""),this.getArticleList()},onTitleClick:function(e){var t=$(e.currentTarget);t.addClass("visited")},onCommCloseClick:function(e){var t=$(e.currentTarget),i=t.parents('[data-node="commItem"]');t.hide(),i.animate({height:0},200,function(){i.hide()})},onWinScroll:function(){this.scrollTimer&&clearTimeout(this.scrollTimer);var e=this;this.scrollTimer=setTimeout(function(){var t=e.$win.scrollTop(),i=e.$dom.listBox.height(),a=e.$win.height();LOAD_HEIGHT>i-t-a&&(e.getArticleList(),window.gaqpush&&window.gaqpush("loadmore",""))},50)},onUnreadClick:function(){var e=this;listener.trigger("com.toutiao.feedlist","refresh"),this.$dom.unread.hide(),this.unReadTimer=setTimeout(function(){e.$dom.unread.slideDown("fast")},UNREAD_DELAY)},onFeedListRefresh:function(e){var t=this;this.$dom.alertMsg.show(),window.scrollTo(0,0),this.spec.unreadTips&&"__all__"===this.spec.category&&(clearTimeout(this.unReadTimer),this.$dom.unread.hide(),this.unReadTimer=setTimeout(function(){t.$dom.unread.slideDown("fast")},UNREAD_DELAY)),$.ajax({url:LIST_AJAX,type:"GET",dataType:"json",context:this,data:{category:this.spec.category},success:function(i){if(this.$dom.alertMsg.slideUp("fast"),i=i||{},"success"!==i.message)return void this.$dom.loadMore.show();var a=i.next||{},n=i.data||[],o=n[n.length-1]||{};this.curMaxBehotTime=a.max_behot_time,this.maxCreateTime=o.create_time||0,i.dateFormat=dateFormat,this.$dom.listBox.html(TEMPLATE(i)),$(".time").timeago(),"function"==typeof e&&e(),t.cacheControl(i)},error:function(){this.$dom.alertMsg.hide(),this.loading=!1,this.$dom.loadMore.show()},complete:function(){listener.trigger("com.toutiao.refresh","stop")}})},cacheControl:function(e){cacheCtr.exist()&&(cacheCtr.set("cache_id",CACHEID),e.has_more&&cacheCtr.set(location.pathname,cacheCtr.encode(e)),!e.has_more&&cacheCtr.del(location.pathname))},onTaqClick:function(e){var t=e.target;_taq.push(["trackevent",location.href,"click","toutiao_web",t,""])},onDislikeClick:function(e){confirm().show({text:"不喜欢这类文章？",success:function(){var t=$(e.currentTarget),i=t.data("groupid");$.post(DISLIKE_AJAX,{group_id:i,action:"dislike"}),t.parents('[data-node="item"]').slideUp("fast",function(){t.remove()})}})},sendCustomLog:function(e){var t="http://toutiao.com/__utm.gif?",i=location.pathname||"",a=[];"/"!==i&&"/video/"!==i&&"/news_hot/"!==i&&(i="/other/"),a.push("toutiao_pc_channel="+i);for(k in e)a.push(k+"="+e[k]);var n=new Image;n.src=t+a.join("&")}})});
;/*!/pagelet/btestweather/btestweather.js*/
define("pagelet/btestweather/btestweather",["require","exports","module","common/util/storage"],function(require,exports,module){var TEMPERATRUE=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="today day_weather">\n  <span class="title">今天</span>\n  <div title="'+(null==(__t=weather.current_condition)?"":__t)+'" class="weather-icon weather-icon-'+(null==(__t=weather.weather_icon_id)?"":__t)+'">\n\n  </div>\n  <span class="temperature  ">\n      <em>'+(null==(__t=weather.low_temperature)?"":__t)+'</em><em>&#176;</em>\n      <em class="line">/</em>\n      <em>'+(null==(__t=weather.high_temperature)?"":__t)+'</em><em>&#176;</em>\n  </span>\n</div>\n\n<div class="tomorrow day_weather">\n  <span class="title">明天</span>\n  <div title="'+(null==(__t=weather.tomorrow_condition)?"":__t)+'" class="weather-icon weather-icon-'+(null==(__t=weather.tomorrow_weather_icon_id)?"":__t)+'">\n\n  </div>\n  <span class="temperature">\n      <em>'+(null==(__t=weather.tomorrow_low_temperature)?"":__t)+'</em><em>&#176;</em>\n      <em class="line">/</em>\n      <em>'+(null==(__t=weather.tomorrow_high_temperature)?"":__t)+'</em><em>&#176;</em>\n  </span>\n</div>\n\n<div class="after_tomorrow day_weather">\n  <span class="title">后天</span>\n  <div title="'+(null==(__t=weather.dat_condition)?"":__t)+'" class="weather-icon  weather-icon-'+(null==(__t=weather.dat_weather_icon_id)?"":__t)+'">\n\n  </div>\n  <span class="temperature">\n      <em>'+(null==(__t=weather.dat_low_temperature)?"":__t)+'</em><em>&#176;</em>\n      <em class="line">/</em>\n      <em>'+(null==(__t=weather.dat_high_temperature)?"":__t)+"</em><em>&#176;</em>\n  </span>\n</div>\n";return __p},CITYSELECT=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="province select-style" data-type="province" data-node="select">\n    <span class="name">北京</span>\n    <div class="active-icon">\n        <i class="arrow-down"></i>\n    </div>\n    <div class="province-list hide">\n        ';for(var i in data)__p+="\n            <a data-city='"+(null==(__t=i)?"":__t)+'\' href="javascript:;">'+(null==(__t=i)?"":__t)+"</a>\n        ";__p+='\n    </div>\n</div>\n<div class="city select-style" data-type="city" data-node="select">\n    <span class="name">北京</span>\n    <div class="active-icon">\n        <i class="arrow-down"></i>\n    </div>\n    <div class="city-list hide">\n        <a href="javascript:;">北京</a>\n    </div>\n</div>\n<div class="op">\n    <a href="javascript:;" class="ok-btn">确定</a>\n    <a href="javascript:;" class="cancel-btn">取消</a>\n</div>\n<!-- <div class="white-line-box"></div> -->\n'}return __p},storage=require("common/util/storage");module.exports=Pagelet.extend({el:"#pagelet-btestweather",events:{},cityData:{},init:function(){this.city=storage.get("WEATHER_CITY"),this.getWeather(),this.initCitySelect()},initCitySelect:function(){var t=this;$.ajax({url:"/stream/widget/local_weather/city/",type:"GET",dataType:"json",context:this,success:function(e){e=e||{},t.cityData=e.data||{},"success"===e.message&&(this.$dom.cityselect.html(CITYSELECT(e)),t.initCitySelectEvent())}})},initCitySelectEvent:function(){var t=this,e=this.$dom.cityselect,a=this.$dom["white-line-box"],i=window.ss=this.$dom.info.find(".location");i.on("click",function(){e.removeClass("hide"),a.removeClass("hide")}),e.find(".cancel-btn").on("click",function(t){t.preventDefault(),t.stopPropagation(),e.addClass("hide"),a.addClass("hide")}),e.find(".ok-btn").on("click",function(i){i.preventDefault(),i.stopPropagation();var n=e.find(".city .name").html();storage.set("WEATHER_CITY",n),t.updateCityWeather(n),e.addClass("hide"),a.addClass("hide")}),e.on("click",".select-style",function(t){t.preventDefault(),t.stopPropagation();var a=$(t.currentTarget).attr("data-type"),i=e.find("."+a+"-list"),n=i.attr("class");n!==a+"-list"?(i.removeClass("hide"),"province"===a?e.find(".city-list").addClass("hide"):e.find(".province-list").addClass("hide")):i.addClass("hide")}),e.find(".province").on("click","a",function(a){a.preventDefault(),a.stopPropagation();var i=$(this).attr("data-city"),n=t.cityData[i],s=0,c="",r="";e.find(".province .name").html(i);for(var l in n)s++,r||(r=l),c+='<a data-city="'+l+'" href="javascript:;">'+l+"</a>";e.find(".city .name").html(r),e.find(".city-list").html(c),e.find(".province-list").addClass("hide"),2>s?e.find(".city-list").addClass("short"):e.find(".city-list").removeClass("short")}),e.find(".city-list").on("click","a",function(t){t.preventDefault(),t.stopPropagation();var a=$(this).attr("data-city");e.find(".city .name").html(a),e.find(".city-list").addClass("hide")}),$(document).on("click",function(){e.find(".province-list").addClass("hide"),e.find(".city-list").addClass("hide")})},updateCityWeather:function(t){this.city=t,this.getWeather()},getWeather:function(){var t={};this.city&&(t.city=this.city),$.ajax({url:"/stream/widget/local_weather/data/",type:"GET",dataType:"json",data:t,context:this,success:function(t){t=t||{},"success"===t.message&&this.render_data(t)}})},render_data:function(t){var e=t.data.weather;this.$dom.info.find(".location .city-name").html(e.city_name),this.$dom.info.find(".wind").html(e.wind_direction+e.wind_level+"级");var a=e.aqi,i=this.levelAQI(a);this.$dom.info.find(".air p").html(e.quality_level+" "+a),this.$dom.info.find(".air").css({background:i.c}),this.$dom.temperature.html(TEMPERATRUE(t.data))},levelAQI:function(t){var e=!0;return t>=0&&50>=t?{c:e?"#5cbf4c":"#5c8828",t:"优"}:t>=51&&100>=t?{c:e?"#5cbf4c":"#5c8828",t:"良"}:t>=101&&150>=t?{c:e?"#ff9f2d":"#c58120",t:"轻度污染"}:t>=151&&200>=t?{c:e?"#ff9f2d":"#c58120",t:"中度污染"}:t>=201&&300>=t?{c:e?"#ff5f5f":"#cf3d3d",t:"重度污染"}:t>=301?{c:e?"#ff5f5f":"#cf3d3d",t:"严重污染"}:{c:"rgba( 214, 117, 3, 0.8 )",t:"其他"}}})});
;/*!/pagelet/btestnnav/btestnnav.js*/
define("pagelet/btestnnav/btestnnav",["require","exports","module","common/loginDialog/loginDialog","common/feedbackDialog/feedbackDialog","common/util/storage","pagelet/btestweather/btestweather"],function(require,exports,module){var loginDialog=require("common/loginDialog/loginDialog"),userTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a class="btn user-head user-item" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/">\n  <div class="user-image">\n    <img onload="this.style.opacity=1;" src="'+(null==(__t=avatar_url)?"":__t)+'">\n  </div>\n    <span>'+(null==(__t=name)?"":__t)+'</span>\n</a>\n<div class="layer">\n    <ul>\n        <li><a ga_event="nav_my_pin" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/" class="layer-item">我的收藏</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/subscribe/" class="layer-item">我的订阅</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followers/" class="layer-item">我的粉丝</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followings/" class="layer-item">我的关注</a></li>\n        <li><a ga_event="nav_loginout" href="http://web.toutiao.com/auth/logout/" class="layer-item">退出</a></li>\n    </ul>\n</div>\n';return __p},searchTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var i=0;i<words.length;i++){var search_txt=words[i],no=i+1;__p+='\n<li class="search-item">\n	<a  ga_event="new_navsearch_hot" class="" data-node="searchItem" data-txt="'+(null==(__t=search_txt)?"":_.escape(__t))+'" href="javascript:;">\n		<i class="search-no search-no-'+(null==(__t=no)?"":__t)+'">'+(null==(__t=no)?"":__t)+'</i>\n		<span class="search-txt">'+(null==(__t=search_txt)?"":_.escape(__t))+"</span>\n	</a>\n</li>\n"}__p+=""}return __p},topbarHeight=24,pgcinfo_ajax="/user/pgc_info/",pgcinfo_entry='<a class="new-article right" href="http://mp.toutiao.com/new_article/" ga_event="nav_write" target="_blank">发文</a>',feedbackDialog=require("common/feedbackDialog/feedbackDialog"),HOT_WORDS_AJAX=/hot_words/,storage=require("common/util/storage"),isIE=/msie/i.test(navigator.userAgent),hotwords_random=[],searchTips="大家都在搜：",Isweatherevent=0;require("pagelet/btestweather/btestweather").create(),module.exports=Pagelet.extend({el:"#pagelet-nnav",events:{"mouseenter $more":"showLayer","mouseleave $more":"hideLayer","mouseenter $moreNav":"showLayer","mouseleave $moreNav":"hideLayer","click $addToFavorites":"onAddToFavoritesClick","submit $searchForm":"onSearchFormSubmit","click $login":"onLoginClick","mouseenter $username":"showLayer","mouseleave $username":"hideLayer","click $navFeedback":"onNavFeedbackClick","focusin $searchBox":"onSearchBoxFocus","focusout $searchBox":"onSearchBoxBlur","click $searchItem":"onSearchItemClick","click $searchInput":"onSearchInputClick","mouseenter $weather":"showLayer","mouseleave $weather":"hideLayer"},channels:{"com.toutiao.user change":"onUserChange"},init:function(e){var t=this,a=e.isHomePage;if($(function(){$("#instantclick-bar").css("transform","translate(100%)"),$("#instantclick").css("opacity","0")}),$(window).on("scroll",function(){sTop=$(document).scrollTop(),sTop>topbarHeight&&!t.sticky?(t.sticky=!0,t.$el.addClass("scroll"),listener.trigger("com.toutiao.channels","scroll",!0)):topbarHeight>=sTop&&t.sticky&&(t.sticky=!1,t.$el.removeClass("scroll"),listener.trigger("com.toutiao.channels","scroll",!1))}),a){var o=window.external&&"addFavorite"in window.external||window.sidebar&&window.sidebar.addPanel;o&&this.$dom.addToFavorites.show()}this.showing=!1,this.fbDialog=feedbackDialog(),$(document).on("click",function(){t.fbDialog.hide()}),this.fbDialog.$el.on("click",function(e){e.stopPropagation()}),this.getHotwords(),this.getWeather()},showLayer:function(e){var t=this,a=$(e.currentTarget),o=a.data("node"),i=o+"hidetimer",s=o+"showtimer";this[i]&&clearTimeout(this[i]),this[s]=setTimeout(function(){t.$dom[o].addClass("show-layer")},100)},hideLayer:function(e){var t=this,a=$(e.currentTarget),o=a.data("node"),i=o+"hidetimer",s=o+"showtimer";this[s]&&clearTimeout(this[s]),this[i]=setTimeout(function(){t.$dom[o].removeClass("show-layer")},100)},onAddToFavoritesClick:function(){var e="http://toutiao.com",t="今日头条";try{window.external.AddFavorite(e,t)}catch(a){try{window.sidebar.addPanel(t,e,"")}catch(o){var i="Ctrl";-1!=navigator.userAgent.toLowerCase().indexOf("mac")&&(i="command"),alert("抱歉，您所使用的浏览器无法完成此操作。\n\n请使用快捷键"+i+"+D进行添加！")}}},onSearchFormSubmit:function(e){var t=this.$dom.searchInput,a=t.val(),o=a.slice(0,6);if(t.val()||e.preventDefault(),o===searchTips){var i=a.slice(6);t.val(i)}t.blur(),this.$dom.searchSubmit.blur(),setTimeout(function(){var e=Math.floor(10*Math.random())%10;t.val(searchTips+hotwords_random[e])},100)},onLoginClick:function(){loginDialog().show({successCb:function(){}})},onUserChange:function(e,t){var a=this;"1"!=a.$dom.userbox.data("in")&&(a.$dom.userbox.data("in",1),this.$dom.username.html(userTmpl(t)),$.ajax({url:pgcinfo_ajax,type:"get",cache:!1,dataType:"json",success:function(e){e=e||{},"success"===e.message&&e.data.is_pgc_author&&a.$dom.userbox.prepend(pgcinfo_entry)}}))},onNavFeedbackClick:function(e){e.stopPropagation(),this.fbDialog.showing?this.fbDialog.hide():(this.fbDialog.show(),window.gaqpush&&window.gaqpush("nav_feedback",""))},getHotwords:function(){$.ajax({url:HOT_WORDS_AJAX,type:"GET",cache:!1,context:this,dataType:"json",success:function(e){e=e||[],e.length&&(storage.set("hotwords",e.join("|")),hotwords_random=e),this.createSearch(e)}})},createSearch:function(e){if(this.hasHotwords=!!e.length,this.hasHotwords){var t={words:e};this.$dom.searchMenu.html(searchTmpl(t)),this.curHotword=e[0],this.$dom.searchInput.val(searchTips+this.curHotword)}},onSearchBoxFocus:function(e){var t=this,a=t.$dom.searchInput,o=a.val(),i=!1;if(isIE&&a.is(".item-clicked"))return void a.removeClass("item-clicked");var s=function(){var r=a.val();i||(i=o!==r),r&&i?t.hideLayer(e):t.showLayer(e),t.searchtimer=setTimeout(s,500)};s()},onSearchBoxBlur:function(e){this.searchtimer&&clearTimeout(this.searchtimer),this.hideLayer(e)},onSearchItemClick:function(e){var t=$(e.currentTarget),a=t.data("txt");this.$dom.searchInput.val(a).addClass("item-clicked"),this.$dom.searchForm.submit()},onSearchInputClick:function(){var e=this.$dom.searchInput.val();e===searchTips+this.curHotword&&this.$dom.searchInput.val("")},getWeather:function(){var e=$("#pagelet-btestweather");$(".weather").append(e),this.getcityweather();var t=this,a=$(".bottom-layer");0===Isweatherevent&&(this.$dom.weather.on("mouseenter",function(){var e=t.$dom.weather,o=e.find("[data-node = 'select']");gaqpush&&gaqpush("show_wheather_detail"),o.on("click",function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-type"),o=$(e.currentTarget).find("."+t+"-list"),i=o.attr("class");i!==t+"-list"?a.removeClass("hide"):a.addClass("hide")}),e.find(".ok-btn").on("click",function(e){e.preventDefault(),a.addClass("hide"),t.getcityweather()}),e.find(".cancel-btn").on("click",function(e){e.preventDefault(),a.addClass("hide")}),e.on("mouseleave",function(){a.addClass("hide")})}),Isweatherevent=1)},getcityweather:function(){this.city=storage.get("WEATHER_CITY");var e={};this.city&&(e.city=this.city),$.ajax({url:"/stream/widget/local_weather/data/",type:"GET",dataType:"json",data:e,context:this,success:function(e){e=e||{},"success"===e.message&&(this.render_data(e),this.$dom.weather.css("display","block"))}})},render_data:function(e){var t=e.data.weather,a=this.$dom.weather;a.find(".city_name").html(t.city_name),a.find(".city_condition").html(t.current_condition),a.find(".tem1").html(t.low_temperature),a.find(".tem2").html(t.high_temperature)}})});
;/*!/pagelet/btestcommbox/btestcommbox.js*/
define("pagelet/btestcommbox/btestcommbox",["require","exports","module","pagelet/model/ad"],function(e,t,o){var n=e("pagelet/model/ad");o.exports=Pagelet.extend({el:"#pagelet-btestcommbox",init:function(){var e=2,t=this,o=n.getData(e);o.then(function(e){e.web_url||t.preventDft(),e.img&&(t.$dom.link.attr("href",e.web_url),t.$dom.img.attr("src",e.img),t.$el.show(),t.$dom.link.parents("#pagelet-btestcommbox").show())},function(e){t.$dom.link.parents("#pagelet-btestcommbox").hide(),console.log(e.msg||"请求广告错误!")})},preventDft:function(){this.$dom.link.bind("click",function(e){e.preventDefault()}),this.$dom.link.css({cursor:"default"})}})});
;/*!/pagelet/btesthotnews/btesthotnews.js*/
define("pagelet/btesthotnews/btesthotnews",["require","exports","module"],function(require,exports,module){var TEMPLATE=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var i=0;news_num>i;i++)no=i+1,__p+='\n  <li>\n  <a href="/group/'+(null==(__t=news[i][0])?"":__t)+'/" target="_blank" ga_event="click_hot_news">\n    ',__p+=0==i?'\n      <div class="news-first">\n        <div class="news-first-icon"></div>\n        <img class="news-pic" src="'+(null==(__t=news[i][2])?"":__t)+'" onload="this.style.opacity=1" alt="'+(null==(__t=news[i][1])?"":__t)+'" />\n      </div>\n      <div class="news-content">\n        <div class="news-inner">\n          <div class="news-title">'+(null==(__t=news[i][1])?"":__t)+"</div>\n        </div>\n      </div>\n    ":'\n      <i class="news-no news-no-'+(null==(__t=no)?"":__t)+'">'+(null==(__t=no)?"":__t)+'</i>\n      <div class="news-title">'+(null==(__t=news[i][1])?"":__t)+"</div>\n    ",__p+="\n  </a>\n  </li>\n";__p+="\n"}return __p},LIST_AJAX="/api/article/real_time_news/?count=10&utm_source=toutiao&offset=0&_=1463385292415";module.exports=Pagelet.extend({el:"#pagelet-btesthotnews",events:{},init:function(){this.getlist()},render_data:function(n){var t=n.data.news.length;t>=8&&(t=8);var e={news:n.data.news,news_num:t};this.$dom.news.append(TEMPLATE(e))},getlist:function(){var n={count:10,utm_source:"toutiao",offset:0};$.ajax({url:LIST_AJAX,type:"GET",dataType:"json",context:this,data:n,success:function(n){this.loading=!1,n=n||{},"success"===n.message&&(this.render_data(n),n.data.news.length>0&&this.$el.show())}})}})});
;/*!/pagelet/company/company.js*/
define("pagelet/company/company",["require","exports","module"],function(e,n,t){t.exports=Pagelet.extend({el:"#pagelet-company",events:{},init:function(){}})});
;/*!/pagelet/recommendpgc/recommendpgc.js*/
define("pagelet/recommendpgc/recommendpgc",["require","exports","module"],function(require,exports,module){var RECOMMEND_PGC=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var i=0;media_num>i;i++){if(__p+='\n      <li class="Pgc_Item">\n\n        <a class="Pgc_Title" target="_blank" ga_event="click_pgc_recommend" href="'+(null==(__t=media[i].media_info.open_url)?"":__t)+'">\n          <div class="Pgc_Image">\n            <img src="'+(null==(__t=media[i].media_info.avatar_url)?"":__t)+'" onload="this.style.opacity=1" alt="'+(null==(__t=media[i].media_info.description)?"":__t)+'" />\n          </div>\n          <span class="Pgc_Name">'+(null==(__t=media[i].media_info.name)?"":__t)+"</span>\n        </a>\n        ",media[i].latest_article[0]){var a=media[i].latest_article[0].display_url,b=media[i].latest_article[0].title;__p+='\n        <a class="Pgc_Article" target="_blank" ga_event="click_pgc_recommend_article" href="'+(null==(__t=a)?"":__t)+'">\n          <div class="title">\n            '+(null==(__t=b)?"":__t)+"\n          </div>\n        </a>\n        "}if(__p+="\n\n        ",media[i].latest_article[1]){var a=media[i].latest_article[1].display_url,b=media[i].latest_article[1].title;__p+='\n        <a class="Pgc_Article" target="_blank" ga_event="click_pgc_recommend_article" href="'+(null==(__t=a)?"":__t)+'">\n          <div class="title">\n            '+(null==(__t=b)?"":__t)+"\n          </div>\n        </a>\n        "}__p+="\n\n      </li>\n"}__p+="\n"}return __p},LIST_AJAX="/recom_media/",if_first=0,all_Data=[];module.exports=Pagelet.extend({el:"#pagelet-recommendpgc",events:{"click $Pgc_Change":"changepgc"},init:function(){this.getpgc()},changepgc:function(){if(0==if_first){var e=all_Data.slice(5,10);if_first=1}else{var e=all_Data.slice(0,5);if_first=0}var a={media:e,media_num:5};this.$dom.Pgc_List.html(RECOMMEND_PGC(a))},getpgc:function(){var e={};$.ajax({url:LIST_AJAX,type:"GET",dataType:"json",context:this,data:e,success:function(e){this.loading=!1,e=e||{},"success"===e.message&&(all_Data=e.data,this.render(e),this.$el.show())},error:function(){this.loading=!1}})},render:function(e){var a=e.data.length;a>=5&&(a=5);var t={media:e.data,media_num:a};this.$dom.Pgc_List.html(RECOMMEND_PGC(t))}})});
;/*!/pagelet/nfeedback/nfeedback.js*/
define("pagelet/nfeedback/nfeedback",["require","exports","module","common/feedbackDialog/feedbackDialog"],function(e,o,i){e("common/feedbackDialog/feedbackDialog");i.exports=Pagelet.extend({el:"#pagelet-nfeedback",events:{"click $refresh":"onRefreshClick","click $back":"onBackClick","click $feedback":"onFeedbackClick"},channels:{"com.toutiao.refresh stop":"onRefreshStop"},init:function(){this.showing=!1,this.$win=$(window)},onRefreshClick:function(e){var o=$(e.target),i=o.is(".loading");i||(o.addClass("loading"),listener.trigger("com.toutiao.feedlist","refresh"))},onRefreshStop:function(){this.$dom.refresh.removeClass("loading")},onBackClick:function(){window.scrollTo(0,0)},onFeedbackClick:function(e){e.stopPropagation(),this.fbDialog.showing?this.fbDialog.hide():this.fbDialog.show()}})});
;/*!/pagelet/ngameentry/ngameentry.js*/
define("pagelet/ngameentry/ngameentry",["require","exports","module"],function(e,n,t){t.exports=Pagelet.extend({el:"#pagelet-ngameentry"})});
;/*!/pagelet/activity_ad/activity_ad.js*/
define("pagelet/activity_ad/activity_ad",["require","exports","module"],function(i,t,s){s.exports=Pagelet.extend({el:"#pagelet-activity",events:{"mouseenter $activity":"show_activity","mouseenter $shopping":"show_shopping"},init:function(){},show_activity:function(){$(".shopping").hide(),$(".activity").show(),this.$dom.shopping.removeClass("select"),this.$dom.activity.addClass("select"),gaqpush&&gaqpush("show_activity")},show_shopping:function(){$(".activity").hide(),$(".shopping").show(),this.$dom.activity.removeClass("select"),this.$dom.shopping.addClass("select"),gaqpush&&gaqpush("show_shopping")}})});