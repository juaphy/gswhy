var ugc={};ugc.publish=function(option){var o=$extend({that:"publish",events:"*[data-type=event]",textId:"replycontent",showImageId:"showUploadImageBox",autoHeightId:"addMoreEvent",autoHeightParentId:"autoVq",labels:[],keep:null,reply:false,commentUrl:"",callback:$empty,screnn:null,success:true,refashWala:$empty},option||{});$(o.that).getElements(o.events).each(function(item){if(item.get("data-data")=="image"){ugc.imageFile({that:item,callback:function(args){ugc.uploadShow(args,item,o.showImageId,function(){o.auo()});o.auo()}})}else{item.addEvent("click",function(e){var even=this.get("data-data");if((even=="icon"||even=="video")&&even&&ugc[even]){ugc[even].apply(this,[o.textId])}if(even&&o[even]){o[even].apply(this,[e])}})}});$(o.that).store("o",o.screnn);o.clintKey=function(){this.setStyle("height",120).setStyles({overflow:"hidden",height:this.scrollHeight});o.auo()};$(o.that).getElement("textarea").addEvents({keypress:o.clintKey,cut:o.clintKey,keyup:o.clintKey});o.title=null;o.auo=function(){var val=$(o.textId)?$(o.textId).value:"",re=/[^\u4e00-\u9fa5]/;
if(!val){return}if(val.length>100&&!o.reply){if(!o.title){o.newtxt=new Element("div",{styles:{"float":"left",width:"100%"}}).inject(o.textId,"before");$(o.textId).inject(o.newtxt);o.title=new Element("input",{type:"text",placeholder:"填写标题",name:"title",styles:{background:"#fff",width:"100%",border:0,"border-bottom":"1px solid #f9f9f9",display:"block","font-size":"24px",padding:"16px 0px","margin-bottom":16}}).inject(o.textId,"before")}}else{if(o.title){o.title.dispose();o.title=null}}if($(o.autoHeightId)){$(o.autoHeightId).setStyle("padding",0).setStyle("padding",((($(o.autoHeightParentId).getHeight()-160)/2)+"px 0px"))}};o.topic=function(){this.hide();var temp=this.retrieve("txt");if(temp){temp.show()}else{temp=new Element("span",{styles:{display:"block",width:"220px",height:28,"float":"left",border:"1px solid #bbb",overflow:"hidden",background:"#fff"}}).inject(this,"before"),it=new Element("input",{type:"text",placeholder:"请输入一个大家讨论的话题",name:"",styles:{"float":"left",border:"none",padding:"3px",width:"220px",height:21}}).inject(temp).addEvent("blur",function(){if(it.value==""){this.show();
temp.hide()}}.bind(this));this.store("txt",temp)}temp.getElement("input").focus()};o.submit=function(e){if(o.keep&&!ugc.keep){o.overflow=new Element("div",{styles:{position:"fixed",width:"100%",height:"100%",top:0,left:0,"z-indent":"9",opacity:0.6,"background-color":"#000","z-index":100,overflow:"hidden"}}).inject(document.body);var w=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth,h=screen.availHeight;o.mySwitch=new Element("div",{styles:{width:350,height:220,background:"#fff",position:"fixed",border:"1px solid #eee","z-index":101,"border-radius":"3px",top:((h-220)/2-60),left:(w-350)/2}}).inject(document.body);new Element("div",{html:"你的观点是支持哪一方啊？",styles:{height:60,"line-height":60,"text-align":"center","font-size":"22px",background:"#eee"}}).inject(o.mySwitch);new Element("span",{"class":"_grad",id:o.keep.red.id,styles:{width:"76px",height:"74px","float":"left","background-position":"-2px -8px",margin:"30px 45px"}}).inject(o.mySwitch).addEvent("click",function(){new Element("input",{type:"hidden",name:"mtid",value:this.id}).inject(o.textId,"before");
var d=document.getElement("*[data-id="+this.id+"]");ugc.keep=this.id;if(d){d.fireEvent("click")}o.overflow.dispose();o.mySwitch.dispose();o.callback(e)});new Element("span",{"class":"_grad",id:o.keep.green.id,styles:{width:"76px",height:"74px","float":"left","background-position":"-2px -102px",margin:"30px 45px"}}).inject(new Element("div",{styles:{height:"161px","float":"left",width:"173px","border-left":"1px solid #eee"}}).inject(o.mySwitch)).addEvent("click",function(){new Element("input",{type:"hidden",name:"mtid",value:this.id}).inject(o.textId,"before");var d=document.getElement("*[data-id="+this.id+"]");ugc.keep=this.id;if(d){d.fireEvent("click")}o.overflow.dispose();o.mySwitch.dispose();o.callback(e)});return}if(!o.reply){ugc.modifyContent.apply(o,[e])}o.callback(e)};o.label=function(e){if(this.retrieve("ing")){return}this.store("ing",true);var lb=$("labels");if(!lb){lb=new Element("input",{id:"labels",type:"hidden",name:"label"}).inject(o.textId,"before")}if(o.labels.filter(function(item){return item==this.id
}.bind(this)).length>0){o.labels.erase(this.id);this.removeClass("select");this.store("ing",null)}else{if(o.labels.length>2){ugc.awaken("最多支持3种印象！",e,true);return}o.labels.push(this.id);this.addClass("select");this.store("ing",null)}lb.value=o.labels};o.addLabel=function(e){if(o.labels.length>2){ugc.awaken("最多支持3种印象！",e,true);return}this.hide();o._this=this;if(o.Dtxt){o.Dtxt.show().inject(this,"before");o.Dipt.focus();return}o.Dtxt=new Element("label",{"class":"addlabel",styles:{display:"block",width:"170px",height:28,"float":"left",border:"1px solid #bbb",overflow:"hidden",background:"#fff"}}).inject(this,"before"),o.Dipt=new Element("input",{type:"text",placeholder:"输入你的印象...",id:"moderatoridName",styles:{"float":"left",border:"none",padding:"3px",width:"160px",height:21,outline:"none"}}).addEvent("blur",function(){if(this.value!=""){o._this.innerHTML=this.value}o.Dtxt.hide();o._this.show()}).inject(o.Dtxt)};o.vote=function(){if($("walageneralmark")&&$("relatedid")){new RatingGroup("walageneralmark",gewa.util.mymarks||0,($("tag")?$("tag").value:"movie"),$("relatedid").value,marks||{},function(){marks={};
marks.walageneralmark=this.rating})}};o.vote();o.searchMovie=function(){var tosearch=$("toSelectBox")?$("toSelectBox"):this,searchBox=$("searchBox");tosearch.addClass("none");var z={};z.tosearchBox=function(){searchBox.innerHTML="<div style='width:100%;height:40px;text-align:center;'><img src='http://static5.gewara.com/css/images/loading4.gif'/></div>";gewara.util.sendLoad(searchBox,GewaraUtil.basePath+"ajax/sns/searchMovieList.xhtml","",function(){gewaUtil.textOver(".selectMovieText");var wMovieText=$$("#selectMovie li").length*132;$("selectMovie").setStyle("width",wMovieText+"px");new ScrollerBar("movieListBox",{mode:"horizontal",wrapped:"selectMovie",step:112,flag:true});$$("#selectMovie li").each(function(item){z.closeBox();z.toMovieDetails(item)});new Asset.javascript(gewara.util.basePath+"activity/getConst.xhtml?citycode=310000&tag=cinema&v="+new Date().getMilliseconds(),{id:"myScriptMovie",onLoad:function(){z.autoChoice()}})})};z.autoChoice=function(){if(!$("choiseMovies")){return
}var tokens=eval("cinemacategoryid"),that=$("choiseMovies").getElement("input[name=movie]");new Autocompleter.Local(that,tokens,{delay:100,maxChoices:10,ipt:that,relatedFun:z.postSearchMovie,form:"",filter:function(){var values=this.queryValue.split(/ +/);return this.tokens.filter(function(token){var result=values.every(function(v){var reg=new RegExp(v.escapeRegExp(),"i");return reg.test(token.skey)});return result})},injectChoice:function(choice){z.modifyPlug(this,choice,"movie","categoryid","")},addChoiceEvents:function(el){return el.addEvents({mouseover:this.choiceOver.bind(this,[el]),click:this.choiceSelect.bind(this,[el])})}},$("popUpCenter"))};z.closeBox=function(){$("closeSelect").addEvent("click",function(){searchBox.innerHTML="";tosearch.removeClass("none");if(editor){editor.ait="";editor.toolbar.disable("ait");editor.onliePicture=""}o.labels=[]})};z.toMovieDetails=function(el){el.addEvent("click",function(){z.postSearchMovie(this)})};z.postSearchMovie=function(el){if(!el){return
}var that=$(el),enter=true,idz="";if(el&&el.id&&typeOf(el.id)=="array"){enter=false;idz=el.id[0]}else{if(that){idz=that.id}else{return}}gewara.util.sendLoad(searchBox,"/activity/ajax/sns/searchMovieDetails.xhtml",{relatedid:idz},function(){z.closeBox();o.vote();searchBox.getElements(o.events).addEvent("click",function(e){e.preventDefault();var even=this.get("data-data");if((even=="icon"||even=="video")&&even&&ugc[even]){ugc[even].apply(this,[o.textId])}if(even&&o[even]){o[even].apply(this,[e])}});if($("backMovieList")){$("backMovieList").addEvent("click",function(){searchBox.innerHTML="";z.tosearchBox();if(editor){editor.ait="";editor.toolbar.disable("ait");editor.onliePicture=""}})}if(editor){editor.ait=gewara.util.basePath+"movie/star/getStarListByMovie.xhtml?movieid="+idz;editor.toolbar.enable("ait");editor.onliePicture=gewara.util.basePath+"movie/moviePictureDetail.xhtml?mid="+idz+"&pvtype=apic"}}.bind(that))};z.modifyPlug=function(_this,choice,tag,role,img){var name=choice.skey.indexOf(",")>0?choice.skey.substring(0,choice.skey.indexOf(",")):choice.skey;
var img=img?img:"";var a=new Element("a",{href:"javascript:;","data-img":img,html:name,rel:role,id:choice.id,name:_this.element.get("name"),config:choice.address?choice.address:"",styles:{display:"block"}}).addEvent("click",function(event){event.preventDefault()});z.toMovieDetails(a);var el=new Element("li").adopt(a);el.inputValue=name;_this.addChoiceEvents(el).injectInside(_this.choices)};z.tosearchBox();return z};return o};ugc.staticReply=function(e,b,f,a,d,h,g,c){ugc.publish({that:b,textId:f,showImageId:a,autoHeightId:d,autoHeightParentId:h,reply:true,keep:""||c,callback:function(j){checkLogin(true,function(){var k={};$(b).getElements("input[type=text],input[type=hidden],textarea").each(function(l){k[l.name]=l.value});if(k.body==""){ugc.awaken("回复内容不能为空哦！",j,true);return}k.commentid=e;if(c){k.mtid=ugc.keep}gewara.util.sendRequest(GewaraUtil.basePath+"activity/ajax/sns/replyComment.xhtml",k,function(l){if(l.success){if($(a)){$(a).innerHTML=""}$(b).getElements("input[type=text],input[type=hidden],textarea").each(function(n){if(n.id!="labels"){n.value=""
}if(n.tagName="TEXTAREA"){n.focus()}});if(c){var m=$("getType").getElement("h2[data-id="+ugc.keep+"]");if(m){m.fireEvent("click")}}if($(g)){$(g).innerHTML="";gewara.util.sendLoad(g,GewaraUtil.basePath+"activity/ajax/sns/reCommentList.xhtml",{cid:e},function(){$(g).getElements("*[data-type=press]").addEvent("click",function(n){ugc.praise.apply(this,[n,"recomment"])});ugc.baseEnjoyCore({superNode:$(g)})})}}else{gewaUtil.alert(l.msg)}})}.bind(this))}})};ugc.icon=function(a){new Icon().innerHTML(this,a)};ugc.uploadForm={};ugc.imageFile=function(a){var b=new Element("input",{type:"file",name:"headlogo",styles:{background:"transparent",outline:"none","hide-focus":"expression(this.hideFocus=true)",opacity:0,position:"absolute","z-index":2,left:"-60px",width:150,top:"10px","font-size":"20px",visibility:"visible",cursor:"pointer"}}).addEvent("change",function(){var c=a.that.retrieve("file");if(c&&c.fileList.length>31){gewa.util.alert("一次最多只能上传32张图片哦！");return}ugc.upLoadFile(b,a)}).inject(a.that)
};ugc.upLoadFile=function(a,b){ugc.uploadForm.box=new Element("div",{id:"superUplodImagePanel",styles:{display:"none"}}).inject(document.body);new Element("iframe",{src:"blank.html",name:"iframe_async_upload",id:"iframe_async_upload",styles:{display:"none"}}).inject(ugc.uploadForm.box);ugc.uploadForm.form=new Element("form",{action:GewaraUtil.basePath+"common/uploadPicture.xhtml",method:"post",target:"iframe_async_upload"}).inject(ugc.uploadForm.box);if(Browser.ie6||Browser.ie7){ugc.uploadForm.setAttribute("encoding","multipart/form-data")}else{ugc.uploadForm.form.setAttribute("enctype","multipart/form-data")}new Element("input",{type:"hidden",name:"callback",value:""}).inject(ugc.uploadForm.form);new Element("input",{type:"hidden",name:"callbackUrl",value:GewaraUtil.basePath+"common/afterUploadPicture.xhtml?uploadtag=micro&callbackf=ugc.uploadCallback"}).inject(ugc.uploadForm.form);ugc.uploadForm.input=a;ugc.uploadForm.that=b.that;ugc.uploadForm.callback=b.callback;ugc.uploadForm.editor=b.editor;
a.inject(ugc.uploadForm.form);ugc.uploadForm.form.submit();ugc.uploadForm.input.inject(ugc.uploadForm.that)};ugc.uploadCallback=function(a){if($("superUplodImagePanel")){$("superUplodImagePanel").dispose()}if(ugc.uploadForm.input&&ugc.uploadForm.that){ugc.uploadForm.input.inject(ugc.uploadForm.that)}if(ugc.uploadForm.editor){ugc.uploadForm.editor.uploadCallback(a);ugc.uploadForm.input=null;ugc.uploadForm.that=null;ugc.uploadForm.showbox=null;ugc.uploadForm.editor=null;return}if(a.msg&&a.msg!="ok"){gewaUtil.alert(a.msg.indexOf("图片尺寸过大")>0?"不支持上传大于5M的图片，请优化图片哦！":a.msg);return}if(ugc.uploadForm){if(ugc.uploadForm.input&&ugc.uploadForm.that){if(ugc.uploadForm.callback&&ugc.uploadForm.callback instanceof Function){ugc.uploadForm.callback(a.picpath)}var b=ugc.uploadForm.that.retrieve("file")||{};b.filesize=a.fileSize;if(ugc.uploadForm.that.retrieve("file")){b.fileList.push(a.picpath);b.input.value=b.fileList;var c=a.picpath+"@"+a.fileSize;if($("files")){b.files.push(c);$("files").value=b.files.join(",")
}}else{if($("imgListCatch")){b.input=$("imgListCatch")}else{b.input=new Element("input",{type:"hidden",name:"imgPath"}).inject(ugc.uploadForm.that)}b.fileList=[];b.files=[];b.fileList.push(a.picpath);b.input.value=b.fileList;var c=a.picpath+"@"+a.fileSize;if($("files")){b.files.push(c);$("files").value=b.files.join(",")}ugc.uploadForm.that.store("file",b)}ugc.uploadForm.input=null;ugc.uploadForm.that=null;ugc.uploadForm.showbox=null}}};ugc.uploadShow=function(f,e,c,g,b,d){var a=new Element("li",{styles:{width:(b||76),"float":"left",height:(d||62),overflow:"hidden",position:"relative"}}).inject(c);new Element("span",{html:"x",styles:{display:"block",width:"20px","border-radius":"30px","font-size":"12px",height:"20px",cursor:"pointer","line-height":20,background:"#000",color:"#fff",opacity:"0.3","text-align":"center",right:0,top:0,position:"absolute"}}).inject(a).addEvent("click",function(){this.getParent("li").dispose();if(g){g()}var h=e.retrieve("file");if(h){h.fileList.erase(f);h.input.value=h.fileList
}if($("files")){var j=f+"@"+h.filesize;h.files.erase(j);$("files").value=h.files.join(",")}});new Element("img",{src:"http://img5.gewara.com/cw"+(b||70)+"h"+(d||56)+"/"+f}).inject(a)};ugc.video=function(){};ugc.getAndClearWalaElement=function(){if(!window.editor){return""}var b=editor.html();b=b.replace(/(<[^>]*)src="http:\/\/static5.gewara.com\/css\/sns\/failed.png"?[^>]*>/ig,function(c){return""});editor.edit.getImage(b);var a=new Element("div",{html:b});["script","link","style"].each(function(c){a.getElements(c).dispose()});_process(a);$("replycontent").value=a.innerHTML;return a.innerHTML};ugc.modifyContent=function(a){checkLogin(true,function(){ugc.getAndClearWalaElement();var f=GewaraUtil.basePath+"activity/ajax/sns/addComment.xhtml";if(this.commentUrl){f=this.commentUrl}var o=$("replycontent"),v=o.value,d={};var g=/<(img|IMG).*(?:\s*\w*?\s*=\s*".+?")*?\s*src\s*=\s*"(.+?)"(?:\s*\w*?\s*=\s*".+?")*\s*>/g;var b=/(<[^>]*)src="http:\/\/static5.gewara.com\/css\/sns\/loading.gif"?[^>]*>/ig;
var q=window.editor||"";if(!q){d.htmlText=""}else{d.htmlText=true}var p=new Element("div",{html:v});if(v.trim()==""){if(!q){o.highlight("#ffcc99","#fff")}ugc.awaken("说点什么吧？",a,true);return}var k=v.match(b);if(k&&k.length>0){ugc.awaken("还有"+k.length+"张图片没有上传成功哦！",a,true);return}v=v.replace(/(<[^>]*)(data-alt)="([^"]*)"([^>]*>)/ig,function(x,A,w,z,j){if(w){if(z.indexOf("分享视频")>0){var y=z.split("::");d.video=y[1];return y[0]}else{return z}}return x});if(v.length>50000){ugc.awaken("哇啦内容长度不可以超过50000个字！",a,true);return}var n=document.getElement("input[name=title]");if($("newUserIndex")&&$("type").value=="vote"&&document.getElement("input[name=voteTitle]")){n=document.getElement("input[name=voteTitle]")}var t="";var c=$("publish").getElement("input[name=imgPath]"),h=$("publish").getElement("input[name=files]");c=c?c.value:"";h=h?h.value:"";if($("video")){t=$("video").value}if(p.get("text").length>150&&n){if(n.value==""){ugc.awaken("写的太棒了，加一个标题更吸引人啊！",a,true);return}}if(n){d.title=n.value}if($("moderatoridName")){d.moderatoridName=$("moderatoridName").value
}if($("elementLoad")){d.elementLoad=$("elementLoad").value}d.micrbody=v.replace(/\n/g,"");d.videoPath=t;d.imgPath=c;d.files=h;if($("updateId")){d.id=$("updateId").value}if($("newUserIndex")){if(($("type").value=="vote")){if(n.value==""){ugc.awaken("投票主题不能为空哦！",a,true);return}var r=document.getElementsByName("voteTag");var m="";var s=0;for(i=0;i<r.length;i++){if(r[i].value!=""){m+=r[i].value+",";s++}}if(s<2){ugc.awaken("投票是一种态度，至少2个选项哦！",a,true);return}d.voteTag=m}}if($("isUserWala")){d.isUserWala=$("isUserWala").value}d.tag=$("tag").value;if($("relatedid")){d.relatedid=$("relatedid").value}if(gewa.util.values){d.isNew=gewa.util.values.isNew?gewa.util.values.isNew:null}else{d.isNew=null}if($("sendMemberId")){d.memberid=$("sendMemberId").value}if($("labels")){d.mtids=$("labels").value}if(ugc.keep){d.mtids=ugc.keep}if($("moderatorid")){d.moderatorid=$("moderatorid").value}if($("isqa")){d.isqa=$("isqa").checked}if($("type")){d.type=$("type").value}if($("atStarList")){d.atStarList=$("atStarList").value
}if(marks){d.generalmark=marks.walageneralmark?marks.walageneralmark:null}var u=$(a.target),l=u.getDimensions();var e=new Element("div",{html:"内容提交中...",styles:{width:l.width,height:l.height,"background-color":"#000","background-image":"url(http://static5.gewara.com/css/images/loading4.gif)","background-position":"center bottom","background-repeat":"no-repeat",opacity:"0.8",color:"#fff","line-height":l.height,"text-align":"center"}}).inject(u,"after").position($extend({relativeTo:u},{edge:{x:"center",y:"center"},position:{x:"center",y:"center"},offset:{y:1,x:1}}));ugc.iframeRequest(f,d,function(j){e.dispose();if(j.success){if(j.isUserWala){location.href=GewaraUtil.basePath+"activity/community/myIndex.xhtml"}else{if($("replycontent")){$("replycontent").value=""}if(ugc.keep){d.elementLoad=document.getElement("div[data-type="+ugc.keep+"]")}if($("walaTitle")){$("walaTitle").value=""}if(window.editor){editor.html("");editor.focus()}if($("replycontent")){$("replycontent").value=""}GewaOverText.update();
if(ugc.isSuccess){d.elementLoad=document.getElement('div[data-first= "walalist"]');if($("newUserIndex")&&$("type").value=="vote"&&document.getElement("input[name=voteTitle]")){$$("#toPubVoteBox input").each(function(z){z.value="";gewaUtil.textOver(z)})}}if(d.elementLoad){var y=new Element("div",{html:j.retval,"data-type":"content"}).inject(d.elementLoad,"top");var x=new Fx.Reveal(y,{duration:400,transition:"linear",onComplete:function(){this.element.dispose()}});ugc.baseEnjoyCore({superNode:y});ugc.initMore(y);y.store("fx",x);if($("publish")&&$("publish").retrieve("o")){$("publish").retrieve("o").target.fireEvent("click")}}else{ugc.success.apply(this,[d.micrbody,j])}this.auo();if($("wala_off")&&$("publish")){document.removeEvent("click",arguments.callee);$("wala_off").removeClass("none");$("publish").setStyles({height:"0",visibility:"hidden"});if($("wala_on_topic")){var w=$("wala_on_topic").getElements('a[class*="select"]');if(w){w.fireEvent("click")}}}}}else{gewaUtil.alert(j.msg)}}.bind(this))
}.bind(this))};ugc.iframeBox={};ugc.iframeRequest=function(a,c,d){ugc.iframeBox.box=new Element("div",{id:"iframeBox",styles:{display:"none"}}).inject(document.body);ugc.iframeBox.toRequest=new Element("iframe",{id:"iframeRequest",name:"iframeRequest",styles:{display:"none"}}).inject(ugc.iframeBox.box);ugc.iframeBox.form=new Element("form",{action:a+"?callback=ugc.iframeBox.callBack",method:"post",target:"iframeRequest"}).inject(ugc.iframeBox.box);if(Browser.ie6||Browser.ie7){ugc.iframeBox.form.setAttribute("encoding","multipart/form-data")}else{ugc.iframeBox.form.setAttribute("enctype","multipart/form-data")}for(var b in c){if(b=="micrbody"){new Element("textarea",{name:b,value:c[b]}).inject(ugc.iframeBox.form)}else{new Element("input",{type:"text",name:b,value:c[b]}).inject(ugc.iframeBox.form)}}ugc.iframeBox.callback=d;ugc.iframeBox.form.submit()};ugc.success=function(txt,that){if(!this.success){this.refashWala.call();return}if($(that)){return that}var html='<div class="shareT" style="width: auto; line-height: 22px; color: rgb(102, 102, 102); text-indent:12px;font-size: 12px; font-weight: normal; height: auto; overflow: hidden;"><div style="width:80%;margin:0 auto;height:100px;overflow:hidden;line-height:100px;font-size:28px;font-weight:bold;margin-top:10px;"><img height="100" src="http://static.gewara.cn/css/home/register_succ.png?v=000" style="float:left;">哇啦，已发布成功！</div>';
html+='<div class="ui_shareBar" style="text-align:left;margin:0 0 0 187px;padding:0px;"><span data-type="shareBt" class="shareList left mr30" style="padding:0px;"><em style="background-position:0px 6px;" class="left mr20">分享</em><span id="bdshare" class="left bdsharebuttonbox"><a data-cmd="weixin" class="shareWeixin bds_weixin"></a><a data-cmd="tsina" class="shareSina"></a><a data-cmd="qzone" class="shareQzone"></a></span></span><span data-type="detail" class="dianzan" style="float:left;">查看详情</span></div></div></div>';$("publish").innerHTML=html;$$(".WalaEditor_ui_overlay").dispose();$("publish").getElement("span[data-type=detail]").addEvent("click",function(){document.location.href=GewaraUtil.basePath+"wala/"+that.id});txt=txt.replace(/<[^>]*>/ig,"");window._bd_share_config={common:{onAfterClick:function(){},bdSnsKey:{tsina:"2536251945",tqq:"801037658"},bdText:txt,bdUrl:"http://www.gewara.com/wala/"+that.id,bdMini:"2",bdPic:"",bdStyle:"0",bdSize:"16"},share:{}};if($("baiduShareInit")){$("baiduShareInit").dispose();
window._bd_share_main=null}with(document){0[(getElementsByTagName("head")[0]||body).appendChild(new Element("script",{id:"baiduShareInit"})).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date()/3600000)]}};ugc.keep=null;ugc.isSuccess=false;ugc.support=function(a){var b=$extend({events:"span[data-type=support],a[data-type=support]",counts:"*[data-count=",element:document.body,isKeep:true},a||{});b.bind=function(){b.els=$(this.element).getElements(this.events);b.els.addEvent("click",function(g){if(b.isKeep&&ugc.keep){ugc.awaken("你已"+((this.get("data-id")==ugc.keep)?this.get("title"):document.getElement("*[data-id="+ugc.keep+"]").get("title"))+"，你还可以发表支持观点！",g,true);return}var f=this.get("data-id"),d={relatedid:f,type:this.get("data-dataType")};var c=$(b.element).getElement(b.counts+f+"]");checkLogin(true,function(){var e=GewaraUtil.basePath+"activity/ajax/sns/memberSupport.xhtml";GewaraUtil.sendRequest(e,d,function(h){if(h.success){ugc.keep=f;if($("labels")){$("labels").value=f
}if(b.isKeep){b.els.addClass("disable");this.removeClass("disable")}if(c){ugc.rise(this,c)}}else{gewaUtil.alert(h.msg)}}.bind(this))}.bind(this))})};b.bind();return b};ugc.awakenCache=null;ugc.awaken=function(h,d,c){var g={};if(c&&$("ugcNotice")){if(ugc.awakenCache){ugc.awakenCache.close()}return}g.elements=new Element("div",{id:"ugcNotice",html:h,styles:{padding:"12px 10px","background-color":"#000",color:"#fff","font-size":16,"border-radius":"6px","z-index":"999",position:"absolute",top:0,right:0}}).setOpacity(0).inject(document.body);if(d){var f=window.getScrollTop()+(window.getHeight()/2)-105,e=window.getWidth(),b=(g.elements.getWidth()>192?192:g.elements.getWidth());var a=d.page.x+16;if(a+b>e){a=d.page.x-b-32}g.elements.setStyles({left:a,top:d.page.y+16,width:b})}g.show=function(){new Fx.Elements(g.elements,{duration:400}).start({"0":{opacity:[0,0.5],"margin-top":[-50,0]},"1":{opacity:0.75}});g.close.delay(3000)};g.close=function(){var j=new Fx.Elements(g.elements,{duration:400,onComplete:function(){g.elements.dispose();
ugc.awakenCache=null}}).start({"0":{opacity:[0.75,0],"margin-top":[0,-50]},"1":{opacity:0}})};g.show();return ugc.awakenCache=g};ugc.baseScreen=function(b){var d='<div style="padding:180px 0 120px 343px;"><img src="http://static5.gewara.com/css/images/loading4.gif"/></div>';var c=$extend({content:"实在抱歉，没有找到你请求的内容！",callback:$empty,title:""},b||{});if($("baseScreen")){var a=$("baseScreen").retrieve("baseScreen");if(a){a=$extend(a,b||{});a.contentPanel.innerHTML=d;a.show.delay(600,null,[a,false])}return}c.screen=new Element("div",{"class":"ui_sidePanel",styles:{"z-index":66,opacity:0,overflow:"hidden","overflow-y":"auto",position:"fixed",top:0,right:0,height:screen.availHeight-56,width:0}}).inject(document.body);c.topw=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth;c.w=c.topw>960?960:c.topw;c.target=new Element("a",{"class":"ui_sidePanel_close",styles:{"background-color":"#f57d48"}}).inject(c.screen).addEvent("click",function(){c.hasClose(true)});c.titlebox=new Element("h2",{html:c.title,styles:{height:60,"font-size":22,"line-height":"88px",padding:"2px 16px",display:"block"}}).inject(c.screen);
c.contentPanel=new Element("div",{html:d,id:"baseScreen",styles:{width:(c.w>960?940:c.w-20),padding:"20px 0 0 0px",right:0,position:"absolute","padding-bottom":"100px"}}).inject(c.screen);$(document.body).setStyles({width:document.body.clientWidth});$(document.html).setStyle("overflow","hidden");c.contentPanel.store("baseScreen",c);c.show=function(e,f){if(f){new Fx.Elements(c.screen,{duration:300,onComplete:function(){c.overid=new Element("div",{styles:{width:"100%",height:document.body.clientHeight,overflow:"hidden",opacity:0.7,background:"#000",position:"absolute",top:0,left:0,"z-index":60}}).addEvent("click",function(){c.hasClose()}).inject(document.body);c.screen.addEvent("scroll",function(){c.target.setStyle("top",this.getScroll().y+2)});e.callCallback.delay(300,null,[e])}}).start({"0":{opacity:[0,1],width:[0,c.w]}})}else{e.callCallback.delay(300,null,[e])}};c.callCallback=function(e){if($(e.content)&&e.ajax){gewara.util.sendLoadCore(e.content,e.url,e.values,function(){e.contentPanel.innerHTML="";
e.content.show().inject(e.contentPanel);if(e.callback&&e.callback instanceof Function){e.callback(e)}})}else{e.contentPanel.innerHTML="";if($(e.content)){$(e.content).show().inject(e.contentPanel);if($(e.content).tagName=="IFRAME"){$(e.content).setStyles({width:(e.w>960?940:e.w-20),height:(screen.availHeight-188),"float":"right","overflow-x":"hidden"})}}else{e.contentPanel.innerHTML=e.content}if(e.callback&&e.callback instanceof Function){e.callback(e)}}};c.close=function(){new Fx.Elements(c.screen,{duration:300,onComplete:function(){c.contentPanel.store("baseScreen",null);c.screen.dispose();c.overid.dispose();$(document.body).set("style","");$(document.html).set("style","")}}).start({"0":{opacity:[1,0],width:[c.w,0]}})};c.hasClose=function(e){var f=($("baseScreen")&&$("replycontent")&&$("replycontent").value!="");if(e&&f){gewaUtil.confirm("你有内容未发布，确认要关闭吗？",c.close)}if(f){return}c.close()};c.show(c,true);return c};ugc.onLoadScreen=function(a,c){var b=new Element("iframe",{sandbox:"restricted",id:"screenIframe",name:"screenIframe",target:"top",frameborder:0,src:a,styles:{border:0}});
return ugc.baseScreen({content:b,title:c})};ugc.ajaxScreen=function(b,a,f,c,d){var e=new Element("div",{styles:{padding:(c||0)}});ugc.baseScreen({content:e,url:b,values:a,callback:f,title:d,ajax:true})};ugc.ajaxPopo=function(b,a,f,c,d){var e=new Element("div",{styles:{padding:(c||0)}});ugc.popUp(function(g){gewara.util.sendLoadCore(g.body,b,a,function(){f.call()})})};ugc.baseEnjoyCore=function(a){var b=$extend({superNode:"",events:"*[data-type=enjoy]"},a||{});(b.superNode?$(b.superNode):document.body).getElements(b.events).each(function(c){if(c.get("data-enjoy")=="report"){c.addEvents({mouseenter:function(){this.innerHTML="举报"},mouseleave:function(){this.innerHTML=""},click:function(f){f.preventDefault();var g=this.get("data-enjoy");if(g&&ugc[g]){ugc[g].apply(this,[f])}}});return}else{if(c.get("data-enjoy")=="share"){c.addEvents({mouseenter:function(){var e=this.get("data-content");ugc.share.open(this,"http://www.gewara.com/wala/"+this.get("data-id"),e)},mouseleave:function(){ugc.share.close(this)
},click:function(f){var g=this.retrieve("share");if(!g){ugc.share.open(this,loction,desc,picList)}}});return}else{if(c.get("data-enjoy")=="headTips"){var d={};d.p=new Element("div",{"class":"friendDetails leftImg",styles:{position:"absolute","z-index":999}}).inject(document.body);c.hover(d.p,null,function(){d.p.inject(document.body);d.p.innerHTML='<div style="text-align:center;padding:20px;"><img src="http://static5.gewara.com/css/images/loading4.gif"/></div>';d.p.setStyles({width:220,height:60});var e=c.getLeft()+c.getCoordinates().width/2;if(e+c.getCoordinates().width+440>document.body.clientWidth){c.removeClass("leftImg");e=440-c.getCoordinates().width;d.p.removeClass("leftImg")}else{e=0;if(!(d.p.hasClass("leftImg"))){d.p.addClass("leftImg")}}d.p.toPos(c,"bottomLeft",-e,0)},function(){(function(){d.p.dispose()}).delay(500)},400,function(f){if(!this.retrieve("html")){GewaraUtil.sendLoad.delay(500,null,[d.p,GewaraUtil.basePath+"activity/community/ajax/getAttentionInfo.xhtml",{attentionid:this.get("data-memberid"),isAttention:this.get("data-isAttention")?this.get("data-isAttention"):""},function(e){if(e.success){d.h=d.p.getElements("a[data-type=text]").length>0?262:180;
d.p.morph({width:[220,438],height:[60,d.h]});this.store("html",d.p.innerHTML);d.p.getElements(".tipsAt").addEvent("click",function(){ugc.callAt(this.get("data-memberid"))})}}.bind(this)])}else{(function(){d.p.innerHTML=c.retrieve("html");d.p.morph({width:[220,438],height:[60,d.h]})}).delay(500)}}.bind(c));d.p.dispose()}else{c.addEvent("click",function(f){f.sotp;f.preventDefault();var g=this.get("data-enjoy");if(g&&ugc[g]){ugc[g].apply(this,[f])}})}}}})};ugc.build=function(b,a,e){var d={};d._this=this;d.superBox=this.getParent("*[data-type=replay]");d.box=new Element("div",{"class":"clear ",styles:{"margin-top":8,padding:20,display:"none",background:"#f0f0f0","border-top":"1px solid #e5e5e5",position:"relative"}}).inject(d.superBox,"after");d.arrow=new Element("i",{"class":"tBorder",styles:{left:"auto",right:"5%","text-indent":"0",color:"#e5e5e5","text-shadow":"none",top:"-12px","font-size":"16px","line-height":"25px",height:"22px",width:"15px"}}).inject(d.box);d.arrow.innerHTML='◆<i class="toTop" style="font-size:16px;text-indent:0;top:3px;line-height:22px; height:22px;width:15px;border:0 none;color:#f0f0f0;">◆</i>';
var c="输入回复内容";if(this.get("data-enjoy")=="aTail"){d.box.setStyle("background","#fff");c="在这里输入回复@内容...";d.box.addClass("aTailBox");d.arrow.setStyles({right:"15%"});d.arrow.getElement("i").setStyles({color:"#fff"})}d.superTxt=new Element("div",{"class":"clear"}).inject(d.box);d.txtbox=new Element("div",{styles:{border:"1px solid #ccc","border-right-color":"#f0f0f0","-webkit-box-shadow":"0 4px 4px 0 rgba(0, 0, 0, 0.04) inset","box-shadow":"0 4px 4px 0 rgba(0, 0, 0, 0.04) inset","float":"left",padding:8,background:"#fff",width:(d.superBox.getWidth()-135)}}).inject(d.superTxt);d.txt=new Element("textarea",{name:"body",id:("text"+this.get("data-id")),placeholder:c,styles:{"float":"left",resize:"none","font-size":14,height:50,border:"none",background:"#fff",outline:"none",width:(d.superBox.getWidth()-135)}}).inject(d.txtbox);d.imgeClickBox=new Element("div",{styles:{width:"75px","float":"left",height:"68px",border:"1px solid #ccc","border-left":"0px"}}).inject(d.superTxt);d.image=new Element("span",{"class":"upImage","data-type":"cache",html:"图片",styles:{width:75,height:"100%"}}).inject(d.imgeClickBox);
d.imagebox=new Element("ul",{"class":"clear",styles:{width:"100%"}}).inject(d.txtbox);ugc.imageFile({that:d.image,callback:function(f){ugc.uploadShow(f,d.image,d.imagebox,function(){d.auo()});d.auo()}});d.clintKey=function(){this.setStyle("height",50).setStyles({overflow:"hidden",height:this.scrollHeight});d.auo()};d.txt.addEvents({keypress:d.clintKey,cut:d.clintKey,keyup:d.clintKey});d.auo=function(){d.imgeClickBox.setStyle("padding",(((d.txtbox.getHeight()-70)/2)+"px 0px"))};d.navs=new Element("div",{"class":"clear",styles:{width:"100%"}}).inject(d.box);d.face=new Element("span",{"class":"mini_iFace","data-type":"cache"}).inject(d.navs).addEvent("click",function(){ugc.icon.apply(this,[d.txt])});d.txt.focus();new Element("input",{type:"button",value:"发送",styles:{"float":"right",background:"#ff8041",border:"none","font-size":"14px",width:77,padding:"8px 0",color:"#fff",cursor:"pointer"}}).inject(d.navs).addEvent("click",function(f){checkLogin(true,function(){a=a||{};d.box.getElements("input[type=text],input[type=hidden],textarea").each(function(g){if(g.name=="body"&&d._this.get("data-enjoy")&&d._this.get("data-enjoy")=="aTail"){a[g.name]="回复@"+d._this.get("data-userName")+":"+g.value
}else{a[g.name]=g.value}});if(a.body==""){ugc.awaken("回复内容不能为空哦！",f,true);return}a.commentid=d._this.get("data-id");gewara.util.sendRequest(b,a,function(g){if(g.success){d.box.getElements("input[type=text],input[type=hidden],textarea").each(function(h){h.value=""});d.reContent.innerHTML="";e.call()}else{gewaUtil.alert(g.msg)}})}.bind(this))});d.reContent=new Element("div",{"data-ids":this.get("data-id")}).inject(d.box);return d};ugc.replay=function(d){var c=this.retrieve("key"),b=$$(".commentSelect");b.each(function(g){var e=g.retrieve("key");if(e){e.fx.dissolve()}});if(c){c.fx.toggle();return}var a=GewaraUtil.basePath+"activity/ajax/sns/replyComment.xhtml";var f=ugc.build.apply(this,[a,{},function(){gewara.util.sendLoad(f.reContent,GewaraUtil.basePath+"activity/ajax/sns/reCommentList.xhtml",{cid:f._this.get("data-id")},function(){f.reContent.getElements("*[data-type=press]").addEvent("click",function(g){alret(1);ugc.baseEnjoyCore({superNode:f.reContent})})});ugc.baseEnjoyCore({superNode:f.reContent})
}]);gewara.util.sendLoad(f.reContent,GewaraUtil.basePath+"activity/ajax/sns/reCommentList.xhtml",{cid:this.get("data-id")},function(e){if(f.reContent.getElements("dl").length>7){new Element("a",{href:"/wala/"+f._this.get("data-id"),html:"阅读全部",target:"_blank"}).inject(new Element("div",{"class":"ui_warning center",styles:{margin:"20px"}}).inject(f.reContent))}ugc.baseEnjoyCore({superNode:f.reContent});f.fx=new Fx.Reveal(f.box,{duration:200,transition:"linear",link:"ignore",onComplete:function(){var g=this.element.getParent("div[data-type=onlie]");f.reContent.getElements("*[data-type=press]").addEvent("click",function(h){ugc.praise.apply(this,[h,"recomment"])})}}).reveal()});this.store("key",f);return f};ugc.aTail=function(c){var b=this.retrieve("key");$$(".aTailOpen").each(function(f){var e=f.retrieve("key");if(e){e.fx.dissolve()}});if(b&&b.fx){b.fx.toggle();return}var a=GewaraUtil.basePath+"activity/ajax/sns/replyComment.xhtml";var d=ugc.build.apply(this,[a,{replyid:this.get("data-recomment"),atmemberids:this.get("data-userid"),commentid:this.get("data-id")},function(){ugc.awaken("已回复成功！！",c,true);
d.fx.dissolve();var e=d._this.getParent("div[data-ids="+d._this.get("data-id")+"]");if(e){gewara.util.sendLoad(e,GewaraUtil.basePath+"activity/ajax/sns/reCommentList.xhtml",{cid:d._this.get("data-id")},function(){e.getElements("*[data-type=press]").addEvent("click",function(f){ugc.praise.apply(this,[f,"recomment"])});ugc.baseEnjoyCore({superNode:e})})}}]);gewara.util.sendLoad(d.reContent,GewaraUtil.basePath+"activity/ajax/sns/aboutReCommentList.xhtml",{recommentid:this.get("data-recomment")},function(e){d.fx=new Fx.Reveal(d.box,{duration:200,transition:"linear",link:"ignore",onComplete:function(){var g=this.element.retrieve("isaTail");var f=g.hasClass("aTailOpen");if(f){g.removeClass("aTailOpen")}else{g.addClass("aTailOpen")}}}).reveal();this.store("key",d)});d.box.store("isaTail",this);this.store("key",d);return d};ugc.replayContent=function(a){var b=$extend({superNode:"",events:"*[data-type=enjoy]"},option||{})};ugc.praise=function(c,a,b,d){if(this.retrieve("fx")){if(a=="moderatortag"){if(d&&d instanceof Function){d()
}}else{ugc.awaken("你已经赞过啦！",c,true)}return}checkLogin(true,function(){var e={relatedid:this.get("data-id"),type:(a||"comment"),moderatorid:this.get("data-moderatorid")};GewaraUtil.sendRequest(GewaraUtil.basePath+"activity/ajax/sns/memberSupport.xhtml",e,function(f){if(f.success){this.store("fx",true);ugc.rise(this,(b||""),function(){if(d&&d instanceof Function){d(f)}})}else{if(f.msg=="已支持过啦！"){if(a=="moderatortag"){if(d&&d instanceof Function){d()}}else{ugc.awaken("你已经赞过啦！",c,true)}this.store("fx",true)}else{ugc.awaken(f.msg,c,true)}}}.bind(this))}.bind(this))};ugc.greatAnswer=function(b,a){checkLogin(true,function(){var c={relatedid:this.get("data-id"),type:(a||"qa"),moderatorid:this.get("data-moderatorid")};GewaraUtil.sendRequest(GewaraUtil.basePath+"activity/ajax/sns/greateAnswer.xhtml",c,function(d){if(d.success){ugc.awaken("这条回复已设为最佳答案！",b,true);this.addClass("select")}else{ugc.awaken(d.msg,b,true)}}.bind(this))}.bind(this))};ugc.report=function(b,a){checkLogin(true,function(){var c={};
c.callback=function(d,e){GewaraUtil.sendRequest(GewaraUtil.basePath+"activity/ajax/sns/reviewIllegalData.xhtml",e,function(f){if(f.success){ugc.awaken("已举报成功，我们将尽快处理！",b,true)}else{ugc.awaken(f.msg,b,true)}}.bind(this))};c.relatedid=this.get("data-id");c.tag=this.get("data-tag");c.list=[{name:"广告垃圾信息",callback:c.callback,values:{relatedid:c.relatedid,tag:c.tag,type:"1"}},{name:"不友善信息",callback:c.callback,values:{relatedid:c.relatedid,tag:c.tag,type:"2"}},{name:"违法信息",callback:c.callback,values:{relatedid:c.relatedid,tag:c.tag,type:"3"}},{name:"其它",callback:c.callback,values:{relatedid:c.relatedid,tag:c.tag,type:"4"}}];ugc.popo.apply(this,[c.list])}.bind(this))};ugc.del=function(b,a){checkLogin(true,function(){gewaUtil.confirm("确认要删除吗？",function(){gewara.util.sendRequest(this.get("rel"),{id:this.get("data-id")},function(c){if(c.success){if(this.getParent("dl")){this.getParent("dl").dissolve()}}else{gewaUtil.alert(c.msg)}}.bind(this))}.bind(this))}.bind(this))};ugc.popo=function(a){if(typeof a!="object"){return
}var b={};b.box=new Element("div",{styles:{position:"absolute","z-index":999,width:"150px",background:"#f9f9f9",border:"1px solid #e5e5e5"}}).position({relativeTo:this,position:"leftBottom",offset:{x:5,y:10}}).inject(document.body);b.ul=new Element("ul").inject(b.box);a.each(function(c){new Element("li",{html:c.name,styles:{"text-indent":"12px",height:"36px","line-height":"36px",width:"100%","font-size":"16px",background:"#f9f9f9","border-bottom":"1px solid #fff",color:"#666",cursor:"pointer"}}).addEvents({mouseenter:function(){this.setStyles({background:"#ff6200",color:"#fff"})},mouseleave:function(){this.setStyles({background:"#f9f9f9",color:"#666"})},click:function(d){c.callback.apply(this,[d,c.values])}.bind(this)}).inject(b.ul)}.bind(this));document.addEvent("click",function(d){var c=$(d.target);if(c!=b.box&&c!=this&&!this.contains(c)){document.removeEvent("click",arguments.callee);b.box.dispose()}}.bind(this));return b};ugc.share={};ugc.share.base=function(b,a,d,c){if(!b){return}b.addEvents({mouseenter:function(){ugc.share.open(this,a,d,c)
},mouseleave:function(){ugc.share.close(this)},click:function(){var e=this.retrieve("share");if(!e){ugc.share.open(this,a,d,c)}}})};ugc.share.create=function(a,b,e,c){var d=a.retrieve("share");c=c||"";if(d){return}d={};d.that=a;d.qzData="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+b+"&showcount='1'&desc="+e+"&pics:"+c;d.wbData="http://service.weibo.com/share/share.php?url="+b+"&utm_source=js-share&utm_medium=weibo&appkey=2536251945&pic="+c+"&title="+e+"&ralateUid=1644150884";d.w=d.that.getDimensions().x/2,d.h=d.that.getDimensions().y;d.style={width:d.w,height:d.h,overflow:"hidden",position:"absolute",display:"block",top:0,"background-image":"url(http://static.gewara.cn/css/sns/share.png)","background-repeat":"no-repeat"};d.weibo=new Element("a",{href:d.wbData,target:"_blank"}).inject(d.that);d.weibo.setStyles($extend({left:"auto",right:-d.w,"background-color":"#FF9999","background-position":(d.h>50?"center 5px":"center -145px")},d.style));d.qzone=new Element("a",{href:d.qzData,target:"_blank"}).inject(d.that);
d.qzone.setStyles($extend({left:-d.w,"background-color":"#FFCC99","background-position":(d.h>50?"center -62px":"center -179px")},d.style));d.weixin="";a.store("share",d);return d};ugc.share.open=function(a,b,e,c){var d=a.retrieve("share");if(!d){d=ugc.share.create(a,b,e,c)}d.weibo.set("tween",{duration:200});d.qzone.set("tween",{duration:200});d.weibo.tween("right",0);d.qzone.tween("left",0)};ugc.share.close=function(a){var b=a.retrieve("share");if(!b){return}b.weibo.tween("right",-(b.w));b.qzone.tween("left",-(b.w))};ugc.qrcode=function(e,d,c,b){var a=qrcode(d||4,c||"M");a.addData(e);a.make();if(b){return a.createTableTag()}else{return a.createImgTag()}};ugc.weixinShare=function(){};ugc.weiboShare=function(){ugc.onLoadScreen("http://service.weibo.com/share/share.php?url=http://www.gewara.com/movie/184981143/&utm_source=js-share&utm_medium=weibo&appkey=2536251945&pic=http://img5.gewara.cn/images/movie/201408/s_4c4c968e_147f1e8e78e__7faa.jpg||http://img5.gewara.cn/images/movie/201408/s_4c4c968e_147f1e8e78e__7fab.jpg||http://img5.gewara.cn/images/movie/201408/s_4c4c968e_147f1e8e78e__7fac.jpg&title=四大名捕大结局&ralateUid=1644150884")
};ugc.qzoneShare=function(){ugc.onLoadScreen("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://www.gewara.com/movie/184981143")};ugc.rise=function(d,h,g,e){var a=function(j){if(!j){if(e){return e}else{return +1}}else{if(e){return j+e}else{return j+1}}};var b=new Element("b",{html:a(),styles:{"font-size":14,"font-family":"verdana",opacity:0,"z-index":99}}).inject(document.body);b.position({relativeTo:d,position:"center",offset:{x:0,y:0}});var f=b.getPosition(),c=0;new Fx.Elements(b,{duration:400,onComplete:function(){if(c!=0){b.dispose();(h?h:d).innerHTML=a(isNaN((h?h:d).get("text").toInt())?0:(h?h:d).get("text").toInt());if(g&&g instanceof Function){g()}}c++}}).start({"0":{"font-size":[14,20],top:[f.y,f.y-60],opacity:[0,1]}}).chain(function(){this.start({"0":{"font-size":[20,14],opacity:[1,0],top:[f.y-60,(h?(h.getPosition().y-10):(f.y-10))],left:[f.x,(h?h.getPosition().x:f.x)]}})})};ugc.popUp=function(b){var a={};$(document.html).setStyle("overflow","hidden");if($("popoDialogPanel")&&$("popoDialogOverid")){a.body=$("popoDialogBody");
a.over=$("popoDialogOverid");a.content=$("popoDialogPanel")}else{a.over=new Element("div",{id:"popoDialogOverid",styles:{width:"100%",height:"100%",opacity:0.8,background:"#000",position:"absolute",top:0,left:0,"z-index":60,display:"block"}}).inject(document.body);a.content=new Element("div",{id:"popoDialogPanel",styles:{width:"100%",height:"100%",position:"fixed",top:0,left:0,"z-index":61,display:"block","overflow-y":"scroll"}}).inject(document.body);a.panel=new Element("div",{styles:{width:"750px",position:"relative",top:"50px",margin:"0 auto","z-index":63,display:"block"}}).inject(a.content);new Element("a",{href:"javascript:void(0)","class":"closeBox"}).addEvent("click",function(){ugc.popUpClose()}).inject(a.panel);a.body=new Element("div",{id:"popoDialogBody"}).inject(a.panel)}b(a)};ugc.popUpClose=function(){$(document.html).set("style","");if($("popoDialogPanel")&&$("popoDialogOverid")){$("popoDialogPanel").dispose();$("popoDialogOverid").dispose()}};ugc.dialogWrite=function(a,b){ugc.popUp(function(d){var c=GewaraUtil.basePath+"activity/sns/toWala.xhtml";
gewara.util.sendLoad(d.body,c,{type:a},function(){gewaUtil.textOver(".tText");gewaUtil.textOver(".ui_wala_textArea");if(a=="normal"){ugc.loadEditor("#replycontent",true,true)}else{ugc.publish()}})})};ugc.loadEditor=function(b,c,a,d){if(!editor){window.editor=null}if(c&&!$("jssdk_editor")){new Asset.javascript(gewara.util.cdnPath+"scripts/editor/kindeditor.js?v=000",{id:"jssdk_editor",onLoad:function(){editor=KindEditor.create(b,{allowPreviewEmoticons:false,allowImageUpload:true,pasteType:1,autoHeightMode:true,onliePicture:d?(GewaraUtil.basePath+"movie/moviePictureDetail.xhtml?mid="+gewa.util.values.relatedid+"&pvtype=apic"):"",ait:d?(GewaraUtil.basePath+"movie/star/getStarListByMovie.xhtml?movieid="+gewa.util.values.relatedid):"",overflow:!a,autoScrollMenu:true,afterCreate:function(){this.loadPlugin("autoheight");var e=$("walaTitle");if(e){new GewaOverText(e)}ugc.publish()},items:["emoticons","bold","forecolor","link","ait","media","image"]})}})}else{editor=null;editor=KindEditor.create(b,{allowPreviewEmoticons:false,allowImageUpload:true,pasteType:1,overflow:!a,onliePicture:d?(GewaraUtil.basePath+"movie/moviePictureDetail.xhtml?mid="+gewa.util.values.relatedid+"&pvtype=apic"):"",ait:d?(GewaraUtil.basePath+"movie/star/getStarListByMovie.xhtml?movieid="+gewa.util.values.relatedid):"",autoHeightMode:true,autoScrollMenu:true,afterCreate:function(){this.loadPlugin("autoheight");
var e=$("walaTitle");if(e){new GewaOverText(e)}ugc.publish()},items:["emoticons","bold","forecolor","link","ait","media","image","template"]})}};ugc.pageNo=0;ugc.scrollAjaxContent=function(a){var b=$extend({url:"",callback:$empty,other:"",isNotScroll:false,doubb:{},defiy:false,scrollback:$empty},a||{});if(!b.isNotScroll){window.addEvents({scroll:function(c){b.scrollback(window.getScroll().y);if(window.getScroll().y>=$("superFooter").getPosition().y-600){Object.keys(b.doubb).each(function(e,d){if(!b["i"+d]){b.creatAjaxContent({that:e,values:b.doubb[e],other:b[e],index:d})}})}}})}b.pageNo=ugc.pageNo;b.empty=null;b.creatAjaxContent=function(c){if(!b["cache"+c.index]){return}b["cache"+c.index]=false;if(c.values.wait){return}if(c.values.pageNo%5==0&&c.values.pageNo!=0&&!c.values.pagestep){c.values.wait=true;b["cache"+c.index]=true;return}c.other.innerHTML="加载数据中...";var d=new Element("div",{"data-type":"content",styles:{display:"none"}}).inject(c.that);c.other.getParent().inject(c.that);c.values.pageNumber=c.values.pageNo;
GewaraUtil.sendLoad(d,b.url,c.values,function(e){if($("page")){c.other.getParent().hide()}b.callback.apply(b,[d]);c.values.pageNo++;c.values.pageNumber=c.values.pageNo;if(d.innerHTML==""){d.dispose();c.other.innerHTML="已经加载完啦！";b["i"+c.index]=true;return}b["cache"+c.index]=true;var f=new Fx.Reveal(d,{duration:400,transition:"linear",onComplete:function(){if(!d.retrieve("fx")){d.store("fx",f)}else{d.dispose()}}}).reveal();ugc.initMore(d);ugc.baseEnjoyCore({superNode:d});if(d.getElements("div[data-type=onlie]").length<c.values.maxCount){c.other.innerHTML="已经加载完啦！";b["i"+c.index]=true;return}c.other.innerHTML="点击加载更多"}.bind(this))};Object.keys(b.doubb).each(function(e,d){b["cache"+d]=true;b[e]=new Element("a",{href:"#",html:"点击加载更多"}).inject(new Element("div",{"class":"ui_warning center",styles:{margin:"20px"}}).inject(e)).addEvent("click",function(f){f.preventDefault();b.creatAjaxContent({that:e,values:b.doubb[e],other:this,index:d})});b.doubb[e].wait=false;if(b.defiy){b.creatAjaxContent({that:e,values:b.doubb[e],other:b[e],index:d})
}else{var c=$(e).getElements("div[data-type=content]");if(c.length>0){c.each(function(g){var f=new Fx.Reveal(g,{duration:400,transition:"linear",onComplete:function(){this.element.dispose()}});ugc.baseEnjoyCore({superNode:g});ugc.initMore(g);g.store("fx",f)})}else{b.creatAjaxContent({that:e,values:b.doubb[e],other:b[e],index:d})}}});b.conn=function(){Object.keys(b.doubb).each(function(d,c){if(b.doubb[d].pageNo%5==0&&b.doubb[d].pageNo!=0){b.doubb[d].pageNo=ugc.pageNo;b.doubb[d].wait=false;b["cache"+c]=true;b[d].getParent().show()}})};return b};ugc.initMore=function(a){if(!a){return}a.getElements("a[data-type=more],img[data-type=more]").addEvent("click",function(b){b.preventDefault();ugc.ajaxScreen(this.get("data-href"),{},function(){if(window.ajaxInit){window.ajaxInit()}},"20px 60px 0px 0px")})};ugc.flys=function(a){var b=$extend({element:"scrollMarix",fxDom:"ul",arrList:"li",pointer:"left",parent:null,callback:$empty},a||{});b.top=$(b.element);if(!b.top){return}b.init=function(){b.paly();
if(b.arrList.length<2){return}b.top.setStyle("left",-(1200-b.x));b.arrList=b.top.getElements("li").setStyles({"float":"left"});b.arrList.set("class","");b.parent=b.top.getParent().setStyle("width",b.w);b.top.setStyle("width",b.arrList.length*1200);b.topFx=new Fx.Elements(b.top.getElement(b.fxDom),{duration:400,onComplete:function(){b.top.getElements("span[data-type=fly]").setStyle("opacity",0);b.arrList=b.top.getElements("li");var c=b.arrList[(b.pointer=="left"?0:(b.arrList.length-1))];c.set("opacity",0);c.inject(this.elements[0],b.pointer=="left"?"bottom":"top");c.tween("opacity",1);this.elements[0].setStyle("margin",0);b.arrList=b.top.getElements("li");b.contentShow()}});new Element("span").inject(new Element("div",{"class":"dropLeft",styles:{left:0,width:b.x}}).inject(b.top,"before").addEvents({click:function(){b.pointer="right";b.paly()},mouseenter:function(){$clear(b.clear)}}));new Element("span").inject(new Element("div",{"class":"dropRight",styles:{right:0,width:b.x-1}}).inject(b.top,"after").addEvents({click:function(){b.pointer="left";
b.paly()},mouseenter:function(){$clear(b.clear)}}));b.fly();b.clear=b.paly.periodical(5000);b.parent.addEvents({mouseenter:function(){$clear(b.clear)},mouseleave:function(){b.clear=b.paly.periodical(5000)}})};b.contentShow=function(){var c=b.arrList[1].retrieve("fx"),d=b.pointer=="left"?360:(-360);if(c){b.temp.getElements("i").removeClass("crrPlayer");c.curr.addClass("crrPlayer");c.player.start({0:{"margin-left":[b.cot(d,240),0],opacity:[0,1]},1:{"margin-left":[b.cot(d,180),0],opacity:[0,1]},2:{"margin-left":[b.cot(d,120),0],opacity:[0,1]},3:{"margin-left":[b.cot(d,60),0],opacity:[0,1]},4:{"margin-left":[b.cot(d,0),0],opacity:[0,1]}})}};b.cot=function(d,c){d=d>0?(d-c):(d+c);return d};b.paly=function(){b.w=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth;if(b.w<1300){b.w=1300}b.x=(b.w-1200)/2;b.top.getElements("a[data-type=isManager]").setStyle("opacity",0);if(b.topFx){b.topFx.start({"0":{"margin-left":[0,(b.pointer=="left"?(-1200):1200)]}})}};b.fly=function(){b.temp=Element("div",{styles:{width:b.arrList.length*15,height:10,position:"absolute",bottom:10,left:((b.w-b.arrList.length*15)/2)}}).inject(b.parent);
b.arrList.each(function(e,c){var d={};d.player=new Fx.Elements(e.getElements("span[data-type=fly]"),{frames:30,duration:260,onComplete:function(){e.getElement("a[data-type=isManager]").tween("opacity",1)}});d.curr=new Element("i",{"class":"playerTag"}).inject(b.temp);e.store("fx",d);if(c==1){b.contentShow()}e.getElements("*[data-type=press]").addEvent("click",function(f){ugc.praise.apply(this,[f,"moderatortag","",function(){var h=GewaraUtil.basePath+"activity/ajax/sns/loadAddComment.xhtml";var g={tag:this.get("data-tag"),relatedid:this.get("data-related"),moderatorid:this.get("data-moderatorid"),mtid:this.get("data-id"),elementLoad:"walaList"};ugc.ajaxScreen(h,g,function(){ugc.publish({screnn:this})},"20px 60px 0px 0px","发哇啦...")}.bind(this)])})})};b.init();return b};ugc.staitcSuperPosition=function(a){var b=$extend({that:"",callback:$empty},a||{});if(!b.that&&!$(b.that)){return}b.t=$(b.that).getParent().getPosition();b.s=$(b.that).getParent().getDimensions();if($("superFooter")){b.footer=$("superFooter");
b.fh=b.footer.getDimensions().height}window.addEvents({scroll:function(){var d=window.getScroll().y,c=b.footer.getPosition().y;if(d>=b.t.y&&(b.footer?(c-b.s.height-b.fh):0)>b.t.y){$(b.that).setStyles({position:"fixed",left:b.t.x,top:(c-b.s.height-d-110>0)?0:(c-b.s.height-d-110),width:b.s.width,padding:"20px 0",background:"#fff"})}else{$(b.that).removeProperties("style")}}.bind(this)});b.scroll=function(){}};ugc.staticPostion=function(a){var b=$extend({that:"div[data-type=staticPosition]",name:"",id:"",callback:$empty},a||{});b.showObject=function(){var c=b.that.get("data-fllow");if(!c){return}new Element("div",{html:c,styles:{position:"absolute",top:0,left:b.top.getDimensions().x+30,height:46,width:660,"text-align":"center","line-height":"38px",padding:"0 20px",background:"url(http://static.gewara.cn/css/sns/ner.png) center 0 no-repeat",color:"#fff","font-size":24}}).inject(b.dom)};b.initStatic=function(){b.that=document.getElement(b.that);if(!b.that){return}b.top=b.that.getParent();b.pos=b.top.getPosition();
b.dom=new Element("div",{"class":"index_slide_nav",styles:{position:"absolute",top:b.pos.y,left:b.pos.x+1,"z-index":9,display:"none"}}).inject(document.body);b.showObject()};b.initStatic();b.refash=function(c){if(!b.that){return}if(c>b.pos.y){if(!b.dom.getElement(b.that)){b.that.inject(b.dom.show())}b.dom.setStyle("top",b.pos.y+(c-b.pos.y))}else{b.dom.hide();b.that.inject(b.top,"top")}};return b};ugc.deleteWala=function(a){gewaUtil.confirm("删除后不能阅览了，确认要执行吗？",function(){gewara.util.sendRequest(GewaraUtil.basePath+"activity/ajax/sns/delComment.xhtml",{id:a},function(b){if(b.success){location.href=GewaraUtil.basePath+"wala/"}else{gewaUtil.alert(b.msg)}})})};ugc.pictureInit=function(a){var b=$extend({node:"pictureView",picList:[],path:"http://static5.gewara.com/"},a||{});if(!$(b.node)){return}b.picList=b.picList.split(",");if(b.picList.length>1){b.wrappeder=new Element("div",{"class":"groupImgsControl",id:"_wrappeder"}).inject(b.node,"after");b.wrapped=new Element("ul",{id:"_wrapped",styles:{width:b.picList.length*156}}).inject(b.wrappeder);
b.picList.each(function(c,d){var e=new Element("li",{"class":d==0?"select":""}).inject(b.wrapped);new Element("img",{src:b.path+"cw160h120/"+c}).addEvent("click",function(){b.image(b.path+b.picList[b.wrapped.getElements("img").indexOf(this)]);b.wrapped.getElements("li").removeClass("select");this.getParent().addClass("select")}).inject(e);new Element("i",{html:"◆"}).inject(e)}.bind(this));if(b.picList.length>4){b.wrappeder.setStyle("padding-bottom",18);new ScrollerBar("_wrappeder",{mode:"horizontal",wrapped:"_wrapped"})}}b.loadding=function(){b.wh=$(b.node).getDimensions();b.img=$(b.node).getElement("img");if(!b.img){b.img=new Element("img",{src:b.path+"css/images/blank.gif"}).inject(b.node)}b.lazeImg=new Element("img",{src:gewara.util.cdnPath+"css/images/loading3.gif",styles:{position:"absolute",top:b.wh.height/2-85,left:b.wh.width/2,"z-index":999}}).inject(b.node)};b.image=function(d){var c=new Element("img",{src:d});b.lazeImg.show();c.onload=function(){var f=(b.wh.width-this.width)/2,e=(b.wh.height-this.height)/2;
b.lazeImg.hide();b.img.src=d;if(this.height>b.wh.height||this.width>b.wh.width){if(this.height>this.width){b.img.setStyles({height:"100%",width:"auto"})}else{if(this.width>b.wh.width){b.img.setStyles({width:"100%",height:"auto"})}}}else{b.img.setStyles({width:"auto",height:"auto"})}c=null};return};b.loadding();b.image(b.path+b.picList[0]);return b};showMovieMark=function(b,c,a){var d=b;checkLogin(true,function(){var g=$("fxContent");if($("walaEbox")){g.setStyle("height",$("walaEbox").getDimensions().height-166)}g.toggleClass("none");if(g.hasClass("none")){d.innerHTML="分项评分"}else{d.innerHTML="收起"}if(g.retrieve("mark")==null){g.store("mark",true);var f=GewaraUtil.basePath+"ajax/common/getMemberTreasure.xhtml";var e={tag:"movie",relatedid:c,newMovie:"Y",t:GewaraUtil.rtime()};GewaraUtil.sendRequest(f,e,function(h){if(h.success){showMark(h,c)}})}})};function domarks(){var h={markname:this.groupId,markvalue:this.rating,tag:"movie",relatedid:this.relatedid};var a=GewaraUtil.basePath+"ajax/common/saveOthermark.xhtml";
gewara.util.sendRequest(a,h);$(this.groupId).set("lang",this.rating);var f=$("storymark").get("lang");var e=$("screenmark").get("lang");var d=$("audiomark").get("lang");var c=$("actormark").get("lang");var b=0;if(f>0){b+=1}if(e>0){b+=1}if(d>0){b+=1}if(c>0){b+=1}var g=((parseInt(f)+parseInt(e)+parseInt(d)+parseInt(c))/b)+"";if(g.indexOf(".")>0&&(g.length-g.indexOf("."))>=2){g=g.substring(0,g.indexOf("."))}if($("walageneralmark")){var j=$("walageneralmark").getElements("li");j[(parseInt(g)-1)].fireEvent("click");if($("walageneralmarkPoint")){$("walageneralmarkPoint").set("html",g+".0")}}}function showMark(a,b){new RatingGroup("storymark",a.storymark,"movie",b,{},domarks);new RatingGroup("screenmark",a.screenmark,"movie",b,{},domarks);new RatingGroup("audiomark",a.audiomark,"movie",b,{},domarks);new RatingGroup("actormark",a.actormark,"movie",b,{},domarks)}function theCheck(){var a=$$(".theCheck");if(a){a.each(function(b){b.addEvent("click",function(){this.toggleClass("select")})})}}ugc.cancelAt=function(b,a){checkLogin(true,function(){GewaraUtil.sendRequest(GewaraUtil.basePath+"activity/community/ajax/cancelAttention.xhtml",{attentionid:b},function(c){if(c.success){if(a&&$(a)){$(a).innerHTML="+关注";
$(a).set("class","at toAt");4;$(a).set("onclick","ugc.callAt("+b+",this);");document.getElements("b[data-count=friendAt]").each(function(e){var d=e.innerHTML;e.innerHTML=parseInt(d)-1})}}})})};ugc.callAt=function(b,a){checkLogin(true,function(){GewaraUtil.sendRequest(GewaraUtil.basePath+"activity/community/ajax/addAttention.xhtml",{attentionid:b},function(c){if(c.success){if(a&&$(a)){$(a).innerHTML="取消关注";$(a).set("class","at noAt");$(a).set("onclick","ugc.cancelAt("+b+",this);")}document.getElements("b[data-count=friendAt]").each(function(e){var d=e.innerHTML;e.innerHTML=parseInt(d)+1})}})})};var slidein={};slidein.ready=function(b){var c=b&&$(b)?$(b):$(document.body),a="";c.getElements('*[data-type="slideReady"]').addEvent("click",function(){a=ugc.ajaxScreen(this.get("data-url"),{},function(d){ugc.baseEnjoyCore({superNode:(a?a:d).contentPanel});slidein.ready((a?a:d).contentPanel);this.removeClass("new")}.bind(this),"0px 60px 0px 0px")})};ugc.loadAjaxWala=function(a){var b=$extend({url:"",loadingCallback:$empty,values:{},afterCallback:$empty,loop:false,that:"",loadingPanel:""},a||{});
b.scorller=true;b.contentEnd=false;b.initEditor=true;b.oldtime=new Date().getTime();b.request=function(d,c){if(b.contentEnd){return}if(!b.content){b.dom()}b.content.removeProperties("style");b.content.innerHTML='<div style="text-align:center;padding:30px 0 30px 80px;"><img src="http://static5.gewara.com/css/images/loading4.gif"/></div>';b.content.removeEvents("click");gewara.util.sendLoad("",b.url,b.values,function(e){if(c){$(b.that).innerHTML=""}if(gewara.util._isObject(e)){b.content.innerHTML=b.notice();b.contentEnd=true}else{if(b.content){b.content.innerHTML=e;d(b.content)}b.dom()}b.scorller=true})};b.editor=function(){Asset.css(gewara.util.cdnPath+"css/wala_movie.css?time="+b.oldtime);Asset.javascript(gewara.util.cdnPath+"scripts/editor/kindeditor.js?time="+b.oldtime,{onLoad:function(){b.instaillEditor()}})};b.instaillEditor=function(){editor=KindEditor.create("#replycontent",{allowPreviewEmoticons:false,allowImageUpload:true,pasteType:1,autoHeightMode:true,autoScrollMenu:true,afterCreate:function(){this.loadPlugin("autoheight");
publishs=ugc.publish({success:false,refashWala:b.refashPage});_this=this;var c=$("walaTitle");if(c){new GewaOverText(c)}if($("previewBtn")){$("previewBtn").addEvent("click",function(){editor.clickToolbar("preview")})}},items:["bold","forecolor","link","image"]})};b.loopPage=function(){if(b.contentEnd){return}b.request(function(c){b.scorller=false;if(c){b.loadingCallback(b.content,function(){if(b.values.pageNumber===0&&b.initEditor){b.editor()}ugc.baseEnjoyCore({superNode:c});ugc.initMore(c);b.values.pageNumber++;b.initEditor=false})}})};b.dom=function(){b.content=new Element("div",{"data-type":"content",html:"点击加载更多内容",styles:{"margin-left":"100px","text-align":"center","font-size":"16px"}}).addEvent("click",b.loopPage).inject(b.that)};b.notice=function(){var c='<dl class="userBodyList clear"><dd class="rightBody"><div class="rightBodyBox noThing" style="padding:30px 0;"><div class="noThingBox"><p>嗨，已经加载完啦~</p></div></div></dd></dl>';return c};if(b.loop){window.addEvents({scroll:function(c){if(b.contentEnd){return
}if(!b.scorller){return}if(document.body.clientHeight-document.body.scrollTop-window.getScroll().y-window.screen.height<0){if(!b.content){b.dom()}if(new Date().getTime()-b.oldtime>=2000){b.oldtime=new Date().getTime();b.scorller=false;b.loopPage()}}}})}b.refashPage=function(){b.values.pageNumber=0;b.request(function(c){b.scorller=false;b.initEditor=true;if(c){b.loadingCallback(b.content,function(){if(b.values.pageNumber===0&&b.initEditor){b.instaillEditor()}ugc.baseEnjoyCore({superNode:c});ugc.initMore(c);b.values.pageNumber++;b.initEditor=false})}},true)};b.loopPage()};var gewara=gewara||{};gewara.util={};var gewa=gewa||{};gewa.string={};gewa.util={};var GewaraUtil=gewara.util,gewaUtil=gewa.util,gewaString=gewa.string;gewara.util.onReturn=function(a,b){if(!a){a=window.event}if(a&&a.keyCode&&a.keyCode==13){b()}};gewara.util.rtime=function(){return new Date().getTime()};gewara.util.basePath="/";gewara.util.httpsPath="https://www.gewara.com/";gewara.util.imgPath="http://img5.gewara.com/";gewara.util.cdnPath="http://static5.gewara.com/";gewara.util.icon=gewara.util.cdnPath+"css/global/pub_icon.png";gewara.util.retdata={};gewara.util.retdata.success=true;gewara.util.member={};gewara.util.member.login=false;gewara.util.member.isMobile=false;gewara.util.member.headUrl="";gewara.util.isNumber=function(a){return/^\d+$/.test(a)};gewara.util.isWarp=window.screen.availWidth>=1280;gewa.util.cinemaCityPy="";gewara.util.isNotNull=function(a){return(!(a.match(/^\s*$/)))};gewara.util._isObject=function(a){return a.toString()==="[object Object]"};gewara.util._hasObject=function(a){a=a.toString().indexOf("[object Object]");
return a>=0?true:false};gewara.util.isMobile=function(a){return(/^(?:13\d|15[0-9]|18[0-9]|17[0-9]|14[0-9])-?\d{5}(\d{3}|\*{3})$/.test(a))};gewara.util.isEmail=function(a){return(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)*(\.[a-zA-Z]{2,4})$/.test(a))};gewara.util.isIdCard=function(a){return(/(^\d{15}$)|(^\d{17}([0-9]|[X,x])$)/.test(a))};gewara.util.replaceStr=function(a){$(a).value=$(a).value.replace(/[^\d]/g,"")};gewara.util.isVideoURL=function(a){var b="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&amp;=+$%-]+: )?[0-9a-z_!~*'().&amp;=+$%-]+@)?(([0-9]{1,3}\\.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+\\.)*(tudou|youku|56|ku6|qq|sohu|iqiyi|qiyi)\\.[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-zA-Z_\\/!~*'().;?:@&amp;=+$,%#-]+)+/?)$";return new RegExp(b).test(a)};var _debug=function(){if("\v"=="v"){alert(arguments)}else{try{console.info(arguments)}catch(a){}}};gewara.util.refreshCaptcha=function(f,c,e){if($(f+"Img")){$(f+"Img").setStyle("background","url("+gewara.util.cdnPath+"css/images/loading2.gif) center center no-repeat")
}var h=gewara.util.basePath;var d=gewara.util.httpsPath;if(e){h=e.replace("https","http");d=e}if($("baoshan_test_001")||!document.location.href.contains("gewara.com")||document.location.href.contains("w137.gewara.com")||document.location.href.contains("m137.gewara.com")){var b=h.indexOf("://");if(b>0){b+=3;h=h.substring(b,h.length);b=h.indexOf("/");h=h.substring(b,h.length)}var g=d.indexOf("://");if(g>0){g+=3;d=d.substring(g,d.length);g=d.indexOf("/");d=d.substring(g,d.length)}}if($(f).value==""){gewara.util.sendRequest(h+"getCaptchaId.xhtml",{r:gewara.util.rtime()},function(i){if(i.success){$(f).value=i.retval;var j=d+"captcha.xhtml?captchaId="+i.retval+"&r="+gewara.util.rtime();if(c){j=j+"&zt="+c}$(f+"Img").src=j}else{alert("获取验证码出错，请重新获取！")}},"get")}else{var a=d+"captcha.xhtml?captchaId="+$(f).value+"&r="+gewara.util.rtime();if(c){a=a+"&zt="+c}$(f+"Img").src=a}$(f+"Input").value="";if($(f+"Input").retrieve("label")){$(f+"Input").retrieve("label").text.innerHTML="输入验证码"}$(f+"Input").onfocus=null
};gewara.util.openwin=function(a,c){var b=new Element("form",{target:c,action:a,method:"post",styles:{display:"none","z-index":"-1"}}).addEvent("submit",function(){b.submit()}).inject(document.body);b.fireEvent("submit")};gewara.util.getLength=function(c){var b=0;for(var a in c){if(c.hasOwnProperty(a)){b++}}return b};gewara.util.baseValidForm=function(f,c){var b=$(f).getElements("*[mustTxt]");var a=true;try{$each(b,function(e,h){var g=$(e).get("value");if(!GewaraUtil.isNotNull(g)){if(c=="admin"){alert($(e).get("mustTxt"))}else{if(c=="member"){gewaUtil.alert($(e).get("mustTxt"))}else{if($(e)){$(e).focus()}if($(e)&&$(e).type!="hidden"&&!$(e).match("textarea")){GewaraUtil.showValidateErr(e,$(e).get("mustTxt"))}else{gewaUtil.alert($(e).get("mustTxt"))}}}a=false;throw"break"}})}catch(d){return false}return a};gewara.util.showValidateErr=function(c,e,a,b){c=$(c);if(!c){gewaUtil.alert(e);return false}if(c.retrieve("tips")==null){c.store("tips",true);var d=new Element("div",{styles:{position:"absolute",width:"auto",height:"20px",border:"1px solid #ffcccc",background:"#ffeeee",padding:"0px 5px",color:"#333","z-index":"999",overflow:"hidden"}}).inject(document.body);
new Element("div",{"class":"errmsg",html:e}).inject(d);d.position({relativeTo:c,position:"leftBottom",offset:{x:(c.getParent("label.text"))?-7:0,y:(c.getParent("label.text"))?-2:0}});(function(){d.dispose();c.store("tips",null)}).delay(2600)}else{return false}};gewara.util.showErrorMsg=function(a,b){if(!$(a)){return}var c=new Hash(b);c.each(function(f,d){var e=$(a).getElement("*[name="+d+"]");if(d&&e){GewaraUtil.showValidateErr(e,f)}})};gewara.util.showLoading=function(b){if(!$("loadingPic")){var a=new Element("img",{id:"loadingPic",src:GewaraUtil.cdnPath+"css/home/loading.gif",styles:{display:"block",position:"absolute",top:"0px",left:"0px",visibility:"hidden",padding:"4px","z-index":"401"}});a.inject(document.body)}gewara.util.toCenter("loadingPic",b)};gewara.util.hideLoading=function(){if($("loadingPic")){$("loadingPic").setStyle("visibility","hidden")}};gewara.util.showDialog=function(e,f,b,c){if(!f){f=$(e).getStyle("z-index")}if(f<10){f=200}var d=$("dialogDisabledZone"),a=$(document.body).getScrollSize();
if(!d){d=new Element("div",{id:"dialogDisabledZone",styles:{position:"absolute","z-index":f-1,left:"0px",top:"0px","background-color":"#000"}});d.inject($(document.body),"top")}d.setStyles({width:a.x,height:a.y,display:"",visibility:"visible","z-index":f-1});d.setOpacity(0.6);$(e).setStyles({position:"absolute","z-index":f,display:"",top:0,left:0,visibility:"visible"}).show();gewara.util.toCenter(e);if(b){$(e).pin()}};gewara.util.showAlbumDialog=function(d,f,a,b){if(!f){f=$(d).getStyle("z-index")}if(f<10){f=200}$(document.body).setStyle("overflow","hidden");var c=$("dialogDisabledZone"),e=$(document.body).getSize();winSize=$(document.body).getScrollSize();if(!c){c=new Element("div",{id:"dialogDisabledZone",styles:{position:"absolute","z-index":f-1,left:"0px",top:"0px","background-color":"#474747"}});c.inject($(document.body),"top")}c.setStyles({width:winSize.x,height:winSize.y,display:"",visibility:"visible","z-index":f-1});$(d).setStyles({position:"absolute",height:e.y,"z-index":f,display:"",top:0,left:0,visibility:"visible"}).show();
gewara.util.toCenter(d);if(a){$(d).pin()}};gewara.util.hideAlbumDialog=function(a){if($("dialogDisabledZone")){$("dialogDisabledZone").setStyles({visibility:"hidden",top:"0px",height:"0px"})}if($(a)){$(a).setStyles({display:"none",visibility:"hidden",top:"0px"})}};gewara.util.hideDialog=function(a){if($("dialogDisabledZone")){$("dialogDisabledZone").setStyles({visibility:"hidden",top:"0px",height:"0px"})}if($(a)){$(a).setStyles({display:"none",visibility:"hidden",top:"0px"})}};gewara.util.toCenter=function(c,b){var a=$(b)||document.body,d=$(c).getStyle("z-index");if(!d||(d<10)){d=100}$(c).setStyles({position:"absolute","z-index":d,visibility:"visible"});$(c).position({relativeTo:a,position:"center",edge:"center"})};gewara.util.moveTo=function(d,c,b,a){if(!b){b=0}if(!a){a=0}var e=$(d).getStyle("z-index");if(!e||e<10){e=100}$(d).setStyles({position:"absolute","z-index":e,visibility:"visible"});$(d).position({relativeTo:$(c),position:"upperLeft",offset:{x:b,y:a}});return this};gewara.util.moveToMouse=function(b,a,c){$(b).setStyles({position:"absolute","z-index":zIndex,visibility:"visible"});
$(b).position({relativeTo:document.body,position:"upperLeft"})};gewara.util.getValues=function(c,d){if(!$(c)){return null}var b=$(c).toQueryString().parseQueryString();if(!d){return b}var e=new Hash(b),a={};e.each(function(g,f){if(f){a[f]=(g&&g.join)?g.join(d):g}});return a};gewara.util.getPostValues=function(b){if(!$(b)){return null}var a=$(b).toQueryString().parseQueryString();return a};gewara.util.setValues=function(a){var b=new Hash(a);b.each(function(d,c){if(c&&$(c)){if($(c).getAttribute("type")){$(c).value=d}else{if($(c).match("select")){$(c).getElements("option").each(function(e){if(e.value==d){e.selected=true}})}else{$(c).innerHTML=d}}}})};gewara.util.updateHtml=function(b,a){var c=new Hash(b);c.each(function(e,d){if(d&&$(d+"_"+a)){$(d+"_"+a).set("html",e)}})};gewara.util.inArea=function(b,a,d){var c=$(b).getCoordinates();return a>=c.left&&a<=c.right&&d>=c.top&&d<=c.bottom};gewara.util.outArea=function(b,a,d){var c=$(b).getCoordinates();return a<c.left||a>c.right||d<c.top||d>c.bottom
};gewara.util.show=function(a){try{a.show()}catch(b){}};gewara.util.hide=function(a){try{a.hide()}catch(b){}};gewara.util.openWindow=function(b,c,d,j,a,h,f){var i=20,e=120,g;if(window.screen.height){i=(window.screen.height-j)/2}if(window.screen.width){e=(window.screen.width-d)/2}g=window.open(b,c,"width="+d+",height="+j+",resizable="+(a?"yes":"no")+",scrollbars="+(h?"yes":"no")+",status="+(f?"1":"0")+",top="+i+",left="+e);if(g){g.focus()}return g};gewara.util.isEmptyObject=function(b){for(var a in b){return false}return true};gewara.util.sendRequest=function(url,values,callback,vmethod){if(typeof values==="object"){if(gewara.util.isEmptyObject(values)){vmethod="get"}}var myRequest=new Request({url:url,method:vmethod||"post",onSuccess:function(resText){eval(resText);if(callback){callback.run(data)}},onFailure:function(res){if(callback){var data={success:false,msg:"网络请求错误！"};if(res.status==403){data.msg="无权限！"}callback.run(data)}}});myRequest.send({data:values})};gewara.util.sendRequest4Json=function(c,a,e,b){if(typeof a==="object"){if(gewara.util.isEmptyObject(a)){b="get"
}}a.callMethod="ajax";var d=new Request.JSON({url:c,method:b||"post",onSuccess:function(f){f.success=f.success||(f.code=="0000");f.msg=f.msg||f.error;f.retval=f.retval||f.data;if(e){e.run(f)}},onFailure:function(g){if(e){var f={success:false,msg:"网络请求错误！"};if(g.status==403){f.msg="无权限！"}e.run(f)}},onError:function(h,f){var g={success:false,msg:"数据格式错误！"};if(e){e.run(g)}}});d.send({data:a})};gewara.util.sendLoad=function(c,b,a,f,d,e){return gewara.util.sendLoadCore(c,b,a,f,"true",d,e)};gewara.util.sendLoadEasy=function(c,b,a,f,d,e){return gewara.util.sendLoadCore(c,b,a,f,"false",d,e)};gewara.util.sendLoadCore=function(el,url,values,callback,iseval,ori,method){try{var off=url.indexOf("#"),selector="";if(off>=0){selector=url.slice(off+1,url.length);url=url.slice(0,off)}var storeValue=$(ori)?$(ori).retrieve("key"):null;var storeJS=$(ori)?$(ori).retrieve("js"):null;iseval=iseval||"true";if(storeValue==null){new Request.HTML({headers:{"Cache-Control":"no-cache,no-store","If-Modified-Since":"0"},url:url,method:method||"get",evalScripts:false,async:true,link:"cancel",onSuccess:function(responseTree,responseElements,responseHTML,responseJavaScript){if(selector&&responseElements.length!=0){var child=new Element("div",{html:responseHTML}).getElement("*[id="+selector+"]");
responseHTML=child.innerHTML}if(responseElements.length==0){if(callback){try{eval(responseHTML)}catch(e){}if(typeof data=="object"){callback.run({success:false,html:responseHTML,json:data})}else{callback.run({success:true,html:responseHTML})}}}else{if(el&&$(el)){$(el).set("html",responseHTML);if(iseval=="true"){eval(responseJavaScript)}$(ori)?$(ori).store("key",responseHTML):null;$(ori)?$(ori).store("js",responseJavaScript):null;if(callback){callback.run({success:true,html:responseHTML})}}else{if(callback){callback.run(responseHTML)}}}},onFailure:function(res){if(callback){callback.run({success:false,msg:"网络请求错误！"})}}}).send({data:values})}else{if(el&&$(el)){if(storeValue){$(el).set("html",storeValue)}if(storeJS){eval(storeJS)}if(callback){callback.run({success:true,html:storeValue})}}else{if(callback){callback.run(storeValue)}}}}catch(e){}};gewara.util.sendLoadXML=function(c,b,a,d){new Request({headers:{"Cache-Control":"no-cache,no-store","If-Modified-Since":"0"},url:b,method:"get",evalScripts:false,onSuccess:function(f,e){if(d){d.run({success:true,html:f,xml:e})
}},onFailure:function(e){if(d){d.run({success:false,msg:"网络请求错误！"})}}}).send({data:a})};gewara.util.slideIn=function(c){var b=$(c);var a=new Fx.Slide(b,{mode:"vertical",transition:"sine:in",duration:300});a.slideIn()};gewara.util.removeAllOptions=function(a){var b=$(a);b.getElements("option").dispose()};gewara.util.addOptions=function(a,c,g,d){var f=$(a),b,e;c.each(function(h){if(g instanceof Function){b=g.run(h)}else{b=h[g]}if(d instanceof Function){e=d.run(h)}else{e=h[d]}new Element("option",{value:b,text:e}).inject(f)})};gewara.util._escapeHtml=true;gewara.util.setEscapeHtml=function(a){gewara.util._escapeHtml=a};gewara.util._shouldEscapeHtml=function(a){if(a&&a.escapeHtml!=null){return a.escapeHtml}return gewara.util._escapeHtml};gewara.util.escapeHtml=function(a){var c=document.createElement("div");var b=document.createTextNode(a);c.appendChild(b);return c.innerHTML};gewara.util._isHTMLElement=function(a,c){if(a==null||typeof a!="object"||a.nodeName==null){return false}if(c!=null){var b=a.nodeName.toLowerCase();
if(typeof c=="string"){return b==c.toLowerCase()}}return true};gewara.util._isArray=function(a){return(a&&a.join)?true:false};gewara.util.addRows=function(e,d,a,b){e=$(e);if(e==null){return}if(!gewara.util._isHTMLElement(e,["table","tbody","thead","tfoot"])){return}if(!b){b={}}if(!b.rowCreator){b.rowCreator=gewara.util._defaultRowCreator}if(!b.cellCreator){b.cellCreator=gewara.util._defaultCellCreator}var c,f;if(gewara.util._isArray(d)){for(f=0;f<d.length;f++){b.rowData=d[f];b.rowIndex=f;b.rowNum=f;b.data=null;b.cellNum=-1;c=gewara.util._addRowInner(a,b);if(c!=null){e.appendChild(c)}}}else{if(typeof d=="object"){f=0;for(var g in d){b.rowData=d[g];b.rowIndex=g;b.rowNum=f;b.data=null;b.cellNum=-1;c=gewara.util._addRowInner(a,b);if(c!=null){e.appendChild(c)}f++}}}};gewara.util._addRowInner=function(a,b){var d=b.rowCreator(b);if(d==null){return null}for(var e=0;e<a.length;e++){var c=a[e];if(typeof c=="function"){b.data=c(b.rowData,b)}else{b.data=c||""}b.cellNum=e;var f=b.cellCreator(b);if(f!=null){if(b.data!=null){if(gewara.util._isHTMLElement(b.data)){f.appendChild(b.data)
}else{if(gewara.util._shouldEscapeHtml(b)&&typeof(b.data)=="string"){f.innerHTML=gewara.util.escapeHtml(b.data)}else{f.innerHTML=b.data}}}d.appendChild(f)}}return d};gewara.util._defaultRowCreator=function(a){return document.createElement("tr")};gewara.util._defaultCellCreator=function(a){return document.createElement("td")};gewara.util.removeAllRows=function(c,a){c=$(c);if(c==null){return}if(!a){a={}}if(!a.filter){a.filter=function(){return true}}if(!gewara.util._isHTMLElement(c,["table","tbody","thead","tfoot"])){return}var d=c.firstChild;var b;while(d!=null){b=d.nextSibling;if(a.filter(d)){c.removeChild(d)}d=b}};function selectAll(a){$(a).getElements("option").each(function(b){b.selected=true})}var PanelGroup=new Class({tabList:[],initialize:function(c,g,d,i,e,b){this.activeClass=d||"active";this.hideClass=i||"none";this.eventName=e||"click";this.current=g||"";var j=this.activeClass,f=this.hideClass,h=this.eventName,a=this;if(g&&$(g)){$(g).addClass(this.activeClass);$(g+"_content").removeClass(f)
}this.tableList=c;c.each(function(l,k){if($(l)){$(l).addEvent(h,function(){if($(a.current)){$(a.current).removeClass(j);$(a.current+"_content").addClass(f)}a.current=l;$(l).addClass(j);$(l+"_content").removeClass(f);if(b&&$defined(b)&&typeof b=="function"){b.call(this,this)}})}})}});var ClassGroup=new Class({initialize:function(a,f,e,d){this.current=f||"";this.activeClass=e||"active";this.hideClass=d||"none";this.tableList=a;var c=this.activeClass,b=this;if(f){$(f).addClass(c)}a.each(function(g){if($(g)){$(g).addEvent("click",function(){if($(b.current)){$(b.current).removeClass(c)}b.current=g;$(g).addClass(c)})}})}});function resizePicture(b,g,e,f,d){var a=0,c=0,i=f||"/userfiles/",h="";b.each(function(j){Asset.image(j.get("src"),{styles:{opacity:0,position:"absolute",left:0,top:0},onLoad:function(){var k=this.getSize();if(k.x>=g){if(k.x>=g||e){if(j.getParent().tagName!="A"){j.inject(new Element("a",{href:j.src.replace(d+"/","sw600h600/"),rel:"lightbox[galerie]",target:"_blank"}).inject(j,"before"))
}}if(k.x>=g&&!d){a=k.y*g/k.x;c=g;j.set("width",c);j.set("height",a);j.setStyles({width:c+"px",height:a+"px"})}slidePicture()}this.dispose()}}).inject(document.body)})}function slidePicture(){var a=$$("a").filter(function(b){return b.rel&&b.rel.test(/^lightbox/i)});$$(a).slimbox({},null,function(b){return(this==b)||((this.rel.length>8)&&(this.rel==b.rel))})}function copyToClipboard(a){var b=$(a);if(Browser.Engine.trident){b.select();therange=b.createTextRange();therange.execCommand("Copy");gewaUtil.alert("复制成功。现在您可以粘贴（Ctrl+v）到Blog 或BBS中了。");return}else{gewaUtil.alert("您使用的浏览器不支持此复制功能，请使用Ctrl+C或鼠标右键。");b.select()}}function stopPropagation(a){a.stopPropagation()}function getFCKHtml(a){var b=FCKeditorAPI.GetInstance(a);return b.GetXHTML()}function getFCKText(a,b){var c=FCKeditorAPI.GetInstance(a),d=$(c.EditorDocument.body).get("text");if(b&&d.length>b){return d.substring(0,b)}return d}function setFCKHtml(a,c){var b=FCKeditorAPI.GetInstance(a);return b.SetHTML(c)}function getAndClearFCKElement(a){var c=FCKeditorAPI.GetInstance(a);
var b=new Element("div",{html:c.GetXHTML()});["script","link","style"].each(function(d){b.getElements(d).dispose()});_process(b);c.SetHTML(b.innerHTML);return b.innerHTML}function _process(a){a.removeAttribute("class");a.getChildren().each(function(b){_process(b)})}function insertFCKHtml(a,c){var b=FCKeditorAPI.GetInstance(a);return b.InsertHtml(c)}function refreshPage(){var c=""+document.location.href,a=c.indexOf("refresh"),d=c.indexOf("#"),b="";if(d>0){b=c.substring(d);c=c.substring(0,d)}if(a>0){c=c.substring(0,a-1)}else{a=c.indexOf("?");if(a>0){c=c+"&refresh=1"}else{c=c+"?refresh=1"}}c+=b;document.location.href=c}var runtopAndBottom=new Class({initialize:function(a,b){this.isPause=false;this.maxScroll=$(a).getScrollSize().y-$(a).getSize().y;var d=this,c=function(){if(!d.isPause){d.fx.start(0,$(a).getScroll().y+b)}};this.fx=new Fx.Scroll(a,{duration:500,transition:Fx.Transitions.Sine.easeOut,onComplete:function(){if($(a).getScroll().y==d.maxScroll){this.set(0,0)}}});$(a).addEvents({mouseover:function(){d.isPause=true
},mouseout:function(){d.isPause=false}});c.periodical(3000)}});function checkLogin(c,a,b){if(!b){b=function(){}}if(gewara.util.member.login){a()}else{gewara.util.sendRequest(GewaraUtil.basePath+"ma/common/checkLogon.xhtml",{},function(d){if(d.success){gewara.util.member.login=true;gewara.util.member.memberid=d.id;gewara.util.member.nickname=d.nickname;gewara.util.member.isMobile=d.isMobile;gewara.util.member.headUrl=d.headUrl;a()}else{showLogin(a,b)}})}}function gotoPosition(a){if($(a)){$(window).scrollTo(0,$(a).getPosition().y)}}function gotoURL(a,b){if(b){document.location.target=b}document.location.href=a}var DefaultValue=new Class({initialize:function(b,a){if($(b).value.trim()==""){$(b).value=a}$(b).addEvents({blur:function(){if(this.value.trim()==""){this.value=a}},focus:function(){if(this.value.trim()==a){this.value=""}}})}});function addMemberTreasure(memberid,tag,obj){checkLogin(true,function(){var url=GewaraUtil.basePath+"micro/addMicroAttention.xhtml";new Request({url:url,method:"post",onSuccess:function(resText){eval(resText);
if(data.success){if(tag=="micro"){if($chk(obj)&&$chk(obj.getParent("span"))){obj.getParent("span").set("text","已关注").addClass("gray")}else{refreshPage()}}else{gewaUtil.alert(data.retval)}}else{gewaUtil.alert(data.msg)}}}).send({data:{memberid:memberid}})})}function microChange(c){var a=140;if($chk($(c).value)){a=140-$(c).value.length}if(a<0){var b=Math.abs(a);$("microText").set("styles",{color:"#C03B0C"});$("microText").set("html",'已超出<b style="font-size:15px;font-family: Constantia,Georgia" id="font">'+b+"</b>个汉字")}else{$("microText").set("styles",{color:"black"}).set("html",'你还可以输入<b style="font-size:15px;font-family: Constantia,Georgia" id="font">'+a+"</b>个字")}}function isCommuBlack(c,d){var b=GewaraUtil.basePath+"home/commu/isCommuBlack.xhtml";var a={commuid:c};return GewaraUtil.sendRequest(b,a,function(e){if(e.success){if(d){window.document.location=d}}else{gewaUtil.alert(e.msg)}})}function addFans(e,d,a){var c=GewaraUtil.basePath+"ajax/common/tobeFans.xhtml";var b={relatedid:d,tag:a};
GewaraUtil.sendRequest(c,b,function(f){if(f.success){gewaUtil.alert("已添加成功!")}else{gewaUtil.alert(f.msg)}});$(e).removeEvent("click",addFans)}function removeFriendRelate(c){if(confirm("解除好友关系从好友列表中删除，确认删除吗？")){var b=GewaraUtil.basePath+"wala/removeFriend.xhtml";var a={memberid:c};GewaraUtil.sendRequest(b,a,function(d){if(d.success){refreshPage()}else{gewaUtil.alert(d.msg)}})}}gewara.util.successAlert=function(a){$(a).addClass("OkMsg");$(a).innerHTML="设置成功！";(function(){$(this).removeClass("OkMsg");$(this).innerHTML=""}.bind(a)).delay(3000)};var tableDialog=new Class({Implements:[Options,Events],options:{},initialize:function(c){this.setOptions(c);this.options.table=new Element("table",{cellspacing:"0",cellpadding:"0",border:"0",width:"100%"});var b=new Element("tbody").inject(this.options.table);var d=new Element("tr").inject(b);new Element("td").addClass("dialog_tl").inject(d);new Element("td").addClass("dialog_c").inject(d);new Element("td").addClass("dialog_tr").inject(d);var e=new Element("tr").inject(b);
new Element("td").addClass("dialog_c").inject(e);this.options.content=new Element("td").inject(e);new Element("td").addClass("dialog_c").inject(e);var a=new Element("tr").inject(b);new Element("td").addClass("dialog_bl").inject(a);new Element("td").addClass("dialog_c").inject(a);new Element("td").addClass("dialog_br").inject(a)}});gewara.util.mask=function(b,a){gewa.util.mask({element:b,mid:a||"mskid_defined_",title:"正在提交，请稍等..."})};gewara.util.mask2=function(b,a){gewa.util.mask2({element:b,mid:a||"mskid_defined_"})};gewara.util.unmask=function(){gewa.util.clearMask(arguments[0])};gewa.util.maskContent=function(d,h,i,b,c,l,n,f,g,k,a,m){var e=(i?i.length*20+100:""),j=h?h.length*12>360?360:h.length*12+20:40,j=e?e>j?e:j:e;gewa.util.core({bgel:$chk(d)?$(d):document.body,content:h,title:i||"",width:b||j,def:c||"",callback:l||$empty,bgcolor:n||"#fff",dialogBgcolor:f||"#aaa",isEsc:g||false,cancelCallback:k||$empty,initCallback:a||$empty,isPin:m||false})};gewa.util.issure=function(d,g,h,b,c,j,e,k,a,l){var f=(h?h.length*20+100:""),i=g?g.length*12>360?360:g.length*12+40:40,i=f?f>i?f:i:f;
gewa.util.core({bgel:$chk(d)?$(d):document.body,content:g,title:h||"",width:b||i,def:c||"",callback:j||$empty,issure:true,cancelCallback:k||$empty,initCallback:a||$empty,sureBt:e||"确定",cancelBt:l||"取消"})};gewa.util.confirm=function(f,g,e,d,b,c){var a=f.length*16<320?320:f.length*16+60;a=a>360?360:a;return gewa.util.core({bgel:$chk(e)?$(e):document.body,content:f,title:"格瓦拉生活网提示",width:d||a,issure:true,callback:g,zIndex:600,isConfirm:true,opacity:0.4,def:"confirm",sureBt:b||"确定",cancelBt:c||"取消"})};gewa.util.alert=function(e,g,d,c,f,b){var a=e?e.length*16<320?e.length*16>360?360:320:e.length*16+60:320;return gewa.util.core({bgel:$chk(d)?$(d):document.body,content:e,title:f||"格瓦拉生活网提示",width:c||a,issure:true,callback:g||$empty,zIndex:601,isAlert:true,opacity:0.4,def:"alert",sureBt:b||"确定"})};gewa.util.tips=function(){var a=arguments[1]?arguments[1].length*12>360?360:arguments[1].length*12+40:60;gewa.util.core({bgel:$chk($(arguments[0]))?$(arguments[0]):document.body,content:arguments[1],isFlag:false,width:arguments[2]||a,def:arguments[3]?arguments[3]:"tips",point:arguments[4]||"down",callback:arguments[5]||$empty(),zindex:arguments[6]?arguments[4]:300,ishide:arguments[7]||1,isEsc:arguments[8]||false,size:arguments[9]||15,tipsBgColor:arguments[10]||"#fff",tipsPtImg:arguments[11]||"css/home/opt.png"})
};gewa.util.popo=function(e,d,c,a,b,g){d=$(d)?$(d).getElement(".none").get("html"):d;var f=function(h,i){if(b&&typeof b=="function"){b(h,i,a,g)}else{gewa.util.tips(h,d,c,i,a,g)}};e.each(function(h){h.addEvents({mouseenter:function(){this.store("isher",true);(function(){if(this.retrieve("isher")!=null){var i=e.indexOf(this);if(gewa.util.container["tips_"+i]){gewa.util.container["tips_"+i].isAttach=true}else{f(this,"tips_"+i)}}}).delay(200,this)},mouseleave:function(){var i=e.indexOf(this);this.store("isher",null);if(gewa.util.container["tips_"+i]){gewa.util.container["tips_"+i].isAttach=false;gewa.util.container["tips_"+i].disposeTips.delay(120,["tips_"+i])}}})})};gewa.util.container=new Hash();gewa.util.core=function(i){var e=i.def||"default";var j=i.recreate||true;if(gewa.util.container[e]&&$defined(gewa.util.container[e])&&gewa.util.container[e].coreDialog){gewa.util.container[e].show(e);return false}var d={};gewa.util.container[e]=d;d.options=$extend({def:"default",content:"",bgel:document.body,isFlag:true,ishide:true,border:1,width:360,title:"",bgcolor:"#fff",zIndex:300,issrue:false,callback:$empty,cancelCallback:$empty,initCallback:$empty,sureBt:"确定",cancelBt:"取消",isConfirm:false,isAlert:false,point:"up",opacity:0.4,tipsBorderColor:"#999",tipsBgColor:"#fff",tipsPtImg:"css/home/opt.png",ietipsPtImg:"css/home/opt.gif?v=000",allowmax:960,dialogBgcolor:"#aaa",isEsc:false,isPin:false},i||{});
d.coreDialog={};d.options.bgel=$(d.options.bgel);if(d.options.bgel&&d.options.bgel.match("body")){d.p=d.options.bgel.getScrollSize()}else{d.p=d.options.bgel.getDimensions()}d.pos=d.options.bgel.getPosition();d.coreDialog=new Element("div",{styles:{width:"auto",display:"inline-block",height:"auto",opacity:0,position:"absolute",top:0,"z-index":d.options.zIndex+1}}).inject(document.body);d.coreDialog.set("id","self"+d.options.def);d.isAttach=true;d.coreTable=new Element("table",{cellspacing:"0",cellpadding:"0",border:"0",width:"100%"}).addClass("tableLayer").inject(d.coreDialog);d.coreTbody=new Element("tbody").inject(d.coreTable);d.coreTR=new Element("tr").inject(d.coreTbody);new Element("td").addClass("t_l").inject(d.coreTR);new Element("td").addClass("t_c").inject(d.coreTR);new Element("td").addClass("t_r").inject(d.coreTR);d.coreTR=new Element("tr").inject(d.coreTbody);new Element("td").addClass("m_l").inject(d.coreTR);d.coreTD=new Element("td",{styles:{padding:1,background:d.options.dialogBgcolor}}).addClass("m_c").inject(d.coreTR);
new Element("td").addClass("m_r").inject(d.coreTR);d.coreTR=new Element("tr").inject(d.coreTbody);new Element("td").addClass("b_l").inject(d.coreTR);new Element("td").addClass("b_c").inject(d.coreTR);new Element("td").addClass("b_r").inject(d.coreTR);if(d.options.isFlag){if(d.options.isEsc){if($("dailogCoreDisable")){$("dailogCoreDisable").setStyles({width:d.p.x+"px",height:d.p.y+"px",top:d.pos.y+"px",left:d.pos.x+"px","background-color":d.options.dialogBgcolor,"z-index":d.options.zIndex}).show()}else{new Element("div",{id:"dailogCoreDisable",styles:{position:"absolute",width:d.p.x+"px",height:d.p.y+"px",top:d.pos.y+"px",left:d.pos.x+"px","z-indent":"9",opacity:d.options.opacity,"background-color":d.options.dialogBgcolor,"z-index":d.options.zIndex}}).inject(document.body)}}else{oldStyle={styles:{position:"absolute",width:d.p.x+"px",height:d.p.y+"px",top:d.pos.y+"px",left:d.pos.x+"px","z-indent":"9",opacity:d.options.opacity,"background-color":d.options.dialogBgcolor,"z-index":d.options.zIndex}};
newStyle={styles:{position:"fixed",width:"100%",height:"100%",top:0,left:0,"z-indent":"9",opacity:d.options.opacity,"background-color":d.options.dialogBgcolor,"z-index":d.options.zIndex,"overflow-y":"scroll"}};d.coreDisable=new Element("div",oldStyle).inject(document.body);d.coreDisable.set("id","parent"+d.options.def)}}else{d.tapImg=gewara.util.cdnPath+d.options.tipsPtImg;d.ietipsPtImg=gewara.util.cdnPath+d.options.ietipsPtImg;d.coreTable.addClass("fixTableLayer");d.los=new Element("div",{styles:{height:(d.options.point=="up"||d.options.point=="down")?"15px":"33px",width:(d.options.point=="up"||d.options.point=="down")?"33px":"15px",overflow:"hidden",position:"absolute",background:"url("+(!Browser.ie6?d.tapImg:d.ietipsPtImg)+") no-repeat"}}).inject(d.coreDialog);if(d.options.ishide&&d.options.ishide==1){d.coreDialog.addEvents({mouseenter:function(){d.isAttach=true;if(d.options.callback){d.options.callback()}},mouseleave:function(){d.isAttach=false;if(d.options.callback){d.options.callback()
}d.disposeTips.delay(120,[e])}})}else{if(d.options.callback){d.options.callback()}}}if(d.options.title){new Element("h2",{text:d.options.title?d.options.title:"格瓦拉生活网提示",styles:{height:"42px","line-height":"42px","text-indent":"10px","font-size":"16px","font-weight":"bold",background:"#f0f0f0",width:"100%",display:"block",color:"#333"}}).inject(d.options.isFlag?d.coreTD:d.coreDialog);if(!d.options.isConfirm&&!d.options.isAlert){new Element("span",{styles:{position:"absolute",top:"14px",right:"16px",cursor:"pointer",display:"block",height:"23px",width:"23px",background:"url("+gewara.util.icon+") 0 -142px no-repeat"}}).addEvents({click:function(){d.options.cancelCallback.call();d.dispose(e)},mouseenter:function(){this.setStyle("background-position","-23px -142px")},mouseleave:function(){this.setStyle("background-position","0 -142px")}}).inject(d.options.isFlag?d.coreTD:d.coreDialog)}}d.content=new Element("div",{styles:{padding:d.options.isEsc?"":"10px",width:"auto","line-height":"22px",color:"#666","font-size":"12px","font-weight":"normal","background-color":d.options.isFlag?d.options.bgcolor:d.options.tipsBgColor,height:"auto",overflow:"hidden"}}).inject(d.coreTD);
if($(d.options.content)){$(d.options.content).show().setStyle("opacity",1).inject(d.content)}else{d.content.innerHTML=d.options.content?d.options.content:"哦，出错了..."}d.show=function(){var k=arguments[0]?arguments[0]:"default";if(gewa.util.container[k]){gewa.util.show(gewa.util.container[k].coreDialog,function(){if(gewa.util.container[k].coreDisable){gewa.util.container[k].coreDisable.show()}})}};d.getPositionSettings=function(k){var l=d.options.isFlag?0:d.options.size||15;var m=d.options.isFlag?"center":d.options.point;switch(m){case"left":case 8:case 9:case 10:return{edge:{x:"left",y:"top"},position:{x:"right",y:"top"},offset:{x:l,y:-l}};case"right":case 2:case 3:case 4:return{edge:{x:"right",y:"top"},position:{x:"left",y:"top"},offset:{x:-l,y:-l}};case"up":case 11:case 12:case 1:return{edge:{x:k?k:"left",y:"bottom"},position:{x:k?k:"left",y:"top"},offset:{y:-l,x:(!k)?(-l):l+10}};case"down":case 5:case 6:case 7:return{edge:{x:k?k:"left",y:"top"},position:{x:k?k:"left",y:"bottom"},offset:{y:l,x:(!k)?(-l-5):l+10}};
case"center":return{edge:{x:"center",y:"center"},position:{x:"center",y:"center"},offset:{y:0,x:0}}}};d.hide=function(){var k=arguments[0]?arguments[0]:"default";if(!gewa.util.container[k]){return}if(gewa.util.container[k]){d.morph(gewa.util.container[k],function(){if(gewa.util.container[k]){gewa.util.container[k].coreDisable.hide()}})}};d.dispose=function(){var k=arguments[0]?arguments[0]:"default",l=arguments[1];if(!gewa.util.container[k]){return}if(gewa.util.container[k]){d.morph(gewa.util.container[k],function(){if(gewa.util.container[k]&&$(gewa.util.container[k].options.content)){if(l){$(gewa.util.container[k].options.content).dispose()}else{$(gewa.util.container[k].options.content).hide().inject(document.body)}}if(gewa.util.container[k]&&gewa.util.container[k].coreDialog){gewa.util.container[k].coreDialog.dispose()}if($("dailogCoreDisable")&&gewa.util.container[k].options.isEsc){$("dailogCoreDisable").hide()}else{if(gewa.util.container[k]&&gewa.util.container[k].coreDisable){gewa.util.container[k].coreDisable.dispose()
}}gewa.util.container.erase(k)})}};d.morph=function(n,l){if(!n){return}if(n.coreDialog){var q=n.coreDialog.getPosition(),o=window.getScroll(),p=n.coreDialog.getDimensions();var k=n.coreFloor.retrieve("key");if(k){if(!n.options.bgel.match("body")){q.x=q.x==0?k.l:q.x+o.x;q.y=q.y==0?k.t:q.y+o.y}if(!d.options.isFlag){var m=d.options.bgel.retrieve("vp")}n.coreDialog.setStyle("overflow","hidden");n.coreDialog.set("morph",{duration:d.options.isFlag?260:200,transition:Fx.Transitions.linear,link:"cancel",onComplete:function(){if(l&&typeof l=="function"){l()}}}).morph({opacity:[1,0],width:[p.width,0],height:[p.height,0],top:[d.options.isFlag?q.y:m.top-d.coreDialog.h/2,(!d.options.isFlag)?m.top:p.height/2+q.y],left:[d.options.isFlag?q.x:m.left-d.coreDialog.w/2,(!d.options.isFlag)?m.left:p.width/2+q.x],"font-size":[12,4]});if(n.coreDialog.getElement("table")){n.coreDialog.getElement("table").set("morph",{duration:300,transition:Fx.Transitions.linear,link:"cancel"}).morph({"margin-left":[0,-p.width/5],"margin-top":[0,-p.height/5],width:[p.width,p.width/5],height:[p.height,p.height/5],"font-size":[12,4]})
}}else{l()}}};d.disposeTips=function(){if(gewa.util.container[this]&&!gewa.util.container[this].isAttach){d.dispose(this,true)}};d.sanim=function(){var m=arguments[0],l=arguments[1];d.options.counter={count:l};var k=(function(){if(this.count==0){if(d.options.callback){d.options.callback()}d.dispose(e);clearInterval(k)}m.setStyle("width","80px");m.value=d.options.sureBt+"("+this.count+")";this.count--}).periodical(1000,d.options.counter)};if(d.options.issure){d.buttonBox=new Element("div",{styles:{width:"94%",height:"100%",overflow:"hidden"}}).inject(new Element("div",{styles:{height:"32px",padding:"0 0 15px 0",width:"100%",background:"#fff",overflow:"hidden"}}).inject(d.options.isFlag?d.coreTD:d.coreDialog));if(!d.options.isAlert){new Element("input",{type:"button",value:d.options.cancelBt}).addEvents({click:function(){d.options.cancelCallback.call();d.dispose(e)}}).inject(new Element("label",{styles:{"float":"right",margin:"0 0 0 15px"}}).addClass("bigWhiteBt bigBt button").addEvents({mouseenter:function(){this.addClass("bg_hover")
},mouseleave:function(){this.removeClass("bg_hover")}}).inject(d.buttonBox))}d.cancel=new Element("input",{type:"button",value:d.options.sureBt}).addEvents({click:function(){if(d.options.isConfirm&&d.options.callback){d.options.callback();d.dispose(e)}else{if(d.options.counter){d.options.counter.count=0}else{if(d.options.callback){d.options.callback()}}}}}).inject(new Element("label",{styles:{"float":"right"}}).addClass("button redBt bigBt").addEvents({mouseenter:function(){this.addClass("bg_hover")},mouseleave:function(){this.removeClass("bg_hover")}}).inject(d.buttonBox));if(d.options.isAlert||d.options.isConfirm){d.content.setStyles({padding:"20px 20px 20px 60px","background-image":"url("+gewara.util.icon+")","background-repeat":"no-repeat","font-size":"16px","background-position":d.options.isAlert?"6px -742px":"6px -447px"})}if(d.options.isAlert){d.sanim(d.cancel,4)}}d.coreDialog.w=d.options.width?d.options.width:d.coreDialog.clientWidth>360?360:d.coreDialog.clientWidth;d.coreDialog.h=d.coreDialog.offsetHeight;
var a="";if(!d.options.isFlag){a=d.options.tipsBgColor}else{if(d.options.isAlert||d.options.isConfirm){a="#fff"}else{a=d.options.bgcolor}}var b="";if(d.options.point=="up"||d.options.point=="down"){var h=d.options.bgel.getPosition(),f=d.options.bgel.getDimensions(),g=(window.getSize().x-d.options.allowmax)/2;if((h.x+f.width+d.coreDialog.w)>(g+d.options.allowmax)){b="right"}}d.coreFloor=new Element("div",{styles:{border:"1px solid #dcdcdc",width:1,height:1,position:"absolute",overflow:"hidden","background-image":(!d.options.isAlert||!d.options.isConfirm)?"":"url("+gewara.util.cdnPath+"css/images/loading.gif)","background-position":"center center","background-repeat":"no-repeat","background-color":a,"z-index":d.options.zIndex}}).inject(document.body).position($extend({relativeTo:d.options.bgel},d.getPositionSettings(b)));d.coreDialog.l=d.coreFloor.getPosition().x;d.coreDialog.t=d.coreFloor.getPosition().y;if(d.coreFloor.retrieve("key")==null){d.coreFloor.store("key",{x:d.coreDialog.w,y:d.coreDialog.h,t:d.coreDialog.t,l:d.coreDialog.l})
}d.coreDialog.setStyle("width",d.coreDialog.w);d.coreFloor.set("morph",{duration:d.options.isFlag?260:200,transition:Fx.Transitions.linear,link:"cancel",onComplete:function(){try{d.coreDialog.setStyles({opacity:1});d.coreDialog.position($extend({relativeTo:d.options.bgel},d.getPositionSettings(b)));if(d.options.bgel==document.body&&!d.options.isPin&&!navigator.userAgent.match(/Windows NT 6.1/i)&&!navigator.userAgent.match(/rv:11/i)){d.coreDialog.pin()}d.coreFloor.dispose();if(navigator.userAgent.match(/Windows NT 6.1/i)&&navigator.userAgent.match(/rv:11/i)){(function(){d.coreDialog.setStyles({top:d.coreDialog.t-d.coreDialog.h/2,left:d.coreDialog.l-d.coreDialog.w/2})}).delay(10)}if(d.options.isFlag&&(d.options.isEsc||d.options.isAlert||d.options.isConfirm)){document.addEvent("keypress",function(l){if(l.key=="esc"){d.dispose(e,true)}if(l.key=="enter"){if(d.options.isConfirm&&d.options.callback){d.options.callback();d.dispose(e)}else{if(d.options.counter){d.options.counter.count=0}else{if(d.options.callback){d.options.callback()
}}}}document.removeEvent("keypress",arguments.callee)})}d.options.initCallback.call()}catch(k){}}});if(d.options.isFlag){d.coreFloor.morph({opacity:[0,1],width:[0,d.options.width?d.options.width:d.coreDialog.clientWidth>360?360:d.coreDialog.clientWidth],height:[0,d.coreDialog.offsetHeight],left:[d.coreDialog.l,d.coreDialog.l-d.coreDialog.w/2],top:[d.coreDialog.t,d.coreDialog.t-d.coreDialog.h/2]})}else{var c={};c.chlid=d.options.bgel.getDimensions();if(d.options.point=="left"){c.left=d.coreDialog.l+d.coreDialog.w/2+10;c.top=d.coreDialog.t+d.coreDialog.h/2;d.los.setStyles({left:"-9px",top:"12px","background-position":"0 -11px"})}else{if(d.options.point=="right"){c.left=d.coreDialog.l-d.coreDialog.w/2-10;c.top=d.coreDialog.t+d.coreDialog.h/2;d.los.setStyles({right:"-9px",top:"12px","background-position":"-33px -11px"})}else{if(d.options.point=="up"){if(b==""){d.los.setStyles({bottom:"-9px",left:"20px","background-position":"-9px -32px"});c.left=d.coreDialog.l+d.coreDialog.w/2}else{d.los.setStyles({bottom:"-9px",right:"20px","background-position":"-9px -32px"});
c.left=d.coreDialog.l-d.coreDialog.w/2}c.top=d.coreDialog.t-d.coreDialog.h/2+f.y/2}else{if(b==""){d.los.setStyles({top:"-9px",left:"20px","background-position":"-13px 0"});c.left=d.coreDialog.l+d.coreDialog.w/2}else{d.los.setStyles({top:"-9px",right:"10px","background-position":"-13px 0"});c.left=d.coreDialog.l-d.coreDialog.w/2}c.top=d.coreDialog.t+d.coreDialog.h/2+10}}}d.options.bgel.store("vp",c);d.coreFloor.morph({width:[0,d.options.width?d.options.width:d.coreDialog.clientWidth>360?360:d.coreDialog.clientWidth],height:[0,d.coreDialog.offsetHeight],left:[c.left,c.left-d.coreDialog.w/2],top:[c.top,c.top-d.coreDialog.h/2]})}};gewa.util.mask=function(a){this.options=$extend({mid:"mskid_defined_",table:"",content:"",title:"",element:document.body,opacity:"0.2",zindex:600,bgcolor:"#fff"},a||{});if($(this.options.element)){this.options.element=$(this.options.element)}else{this.options.element=document.body}this.dialog=new Element("div",{styles:{width:"130px",height:"30px",position:"absolute","z-index":this.options.zindex+1,background:"#eee",padding:"2px",border:"1px solid #aaa"}}).inject(document.body);
this.dialog.set("id",this.options.mid+"maskDialog");this.dialog.position({relativeTo:this.options.element,position:"center",edge:"center"});this.winSize=this.options.element.getScrollSize();this.winfacebox=new Element("div",{styles:{position:"absolute",width:this.winSize.x+"px",height:this.winSize.y+"px",top:"0",left:"0","z-indent":"9",opacity:this.options.opacity,"background-color":this.options.bgcolor,"z-index":this.options.zindex}}).inject($(document.body));this.winfacebox.set("id",this.options.mid+"winfacebox");gewara.util.toCenter(this.winfacebox,this.options.element);this.loadUrl=gewara.util.cdnPath+"css/home/load.gif";new Element("h2",{text:this.options.title?this.options.title:"请稍等...",styles:{height:"22px",width:"100%","line-height":"22px",color:"#333","font-size":"12px","font-weight":"normal","text-indent":"8px",background:"#eee",display:"block"}}).inject(this.dialog);new Element("div",{styles:{height:"8px",width:"100%",background:"#eee url("+this.loadUrl+") center center no-repeat"}}).inject(this.dialog)
};gewa.util.mask2=function(a){this.options=$extend({mid:"mskid_defined_",table:"",content:"",title:"",element:document.body,opacity:"0.4",zindex:600,bgcolor:"#000",height:""},a||{});if($(this.options.element)){this.options.element=$(this.options.element)}else{this.options.element=document.body}this.dialog=new Element("div",{styles:{width:"130px",height:"30px",position:"absolute","z-index":this.options.zindex+1}}).inject(document.body);this.dialog.set("id",this.options.mid+"maskDialog");this.dialog.position({relativeTo:this.options.element,position:"center",edge:"center"});this.winSize=this.options.element.getScrollSize();this.winfacebox=new Element("div",{styles:{position:"absolute",width:this.winSize.x+"px",height:this.options.opacity?this.options.opacity:this.winSize.y+"px",top:"0",left:"0","z-index":"9",opacity:this.options.opacity,"background-color":this.options.bgcolor,"z-index":this.options.zindex}}).inject($(document.body));this.winfacebox.set("id",this.options.mid+"winfacebox");
gewara.util.toCenter(this.winfacebox,this.options.element);this.loadUrl=gewara.util.cdnPath+"css/images/loading4.gif";new Element("div",{styles:{height:"8px",width:"100%",background:"url("+this.loadUrl+") center center no-repeat"}}).inject(this.dialog)};gewa.util.clearMask=function(){var b=arguments[0]&&$defined(arguments[0])?arguments[0]:"mskid_defined_",c=b+"maskDialog",a=b+"winfacebox";if($(c)&&$(a)){$(c).set("tween",{duration:1000,onComplete:function(){document.getElements("*[id="+a+"]").dispose();document.getElements("*[id="+c+"]").dispose()}}).tween("opacity","0")}};gewa.util.popoFlag=function(b){b=new Event(b);var a=this[0],c=this[1];if(a!=b.target&&!a.hasChild(b.target)&&!c.hasChild(b.target)&&c!=b.target){if(this[3]){this[3]()}document.removeEvents(this[2],this[4])}};gewa.util.loadData=function(){var a="T"+Date.now();var b=arguments[0]?arguments[0]:"";GewaraUtil.mask(b,a);gewara.util.sendLoad(arguments[0],arguments[1],arguments[2],function(){GewaraUtil.unmask(a);this(arguments[0])
}.bind(arguments[3]&&typeof(arguments[3])=="function"?arguments[3]:$empty),arguments[4])};gewa.util.dispose=function(){gewa.util.hide(arguments[0],function(){this.dispose()}.bind($(arguments[0])))};gewa.util.hide=function(){var b=$(arguments[0]);if(b.retrieve("fx")==null){var a=new Fx.Reveal(b,{duration:500,transition:"linear",onComplete:function(){if(typeof(this)=="function"){this()}}.bind(arguments[1]?arguments[1]:this)});b.store("fx",a);a.dissolve()}else{b.retrieve("fx").dissolve()}};gewa.util.show=function(){var b=$(arguments[0]);if(b.retrieve("fx")==null){var a=new Fx.Reveal(b,{duration:500,transition:"linear",onComplete:function(){if(typeof(this)=="function"){this()}}.bind(arguments[1]?arguments[1]:this)});b.store("fx",a);a.reveal()}else{b.retrieve("fx").reveal()}};gewa.util.shutOpen=function(e,c,b,f){var d=$(e),a=c,b=$(b),h="收起",g="展开";if(d){if(b){if(b.hasClass("shut")){b.removeClass("shut");b.set("text",b.get("text").replace(h,g));$(d).tween("height",f);return}else{b.addClass("shut");
b.set("text",b.get("text").replace(g,h))}}$(d).tween("height",a)}};var HoverGroup=new Class({Implements:[Options,Events],Binds:["enter","leave","remain"],options:{elements:[],delay:300,start:["mouseenter"],remain:[],end:["mouseleave"]},initialize:function(a){this.setOptions(a);this.attachTo(this.options.elements);this.addEvents({leave:function(){this.active=false},enter:function(){this.active=true}})},elements:[],attachTo:function(d,e){var b={},c={},a={};this.options.start.each(function(f){b[f]=this.enter},this);this.options.end.each(function(f){a[f]=this.leave},this);this.options.remain.each(function(f){c[f]=this.remain},this);if(e){d.each(function(f){f.removeEvents(b).removeEvents(a).removeEvents(c);this.elements.erase(f)})}else{d.each(function(f){f.addEvents(b).addEvents(a).addEvents(c)});this.elements.combine(d)}return this},detachFrom:function(a){this.attachTo(a,true)},enter:function(a){this.isMoused=true;this.assert(a)},leave:function(a){this.isMoused=false;this.assert(a)},remain:function(a){if(this.active){this.enter(a)
}},assert:function(a){$clear(this.assertion);this.assertion=(function(){if(!this.isMoused&&this.active){this.fireEvent("leave",a)}else{if(this.isMoused&&!this.active){this.fireEvent("enter",a)}}}).delay(this.options.delay,this)}});var dwCheckboxes=new Class({Implements:[Options],options:{elements:"input[type=checkbox]",mode:"toggle",relativ:""},initialize:function(a){this.setOptions(a);document.ondragstart=function(){return false};this.options.elements=$$(this.options.elements);this.manage()},manage:function(){var a=0;this.options.elements.each(function(c){c.addEvents({mousedown:function(d){d.stop();a=1;c.checked=!c.checked},mouseenter:function(d){if(a===1){c.checked=("toggle"==this.options.mode?!c.checked:"check"==this.options.mode)}this.allManager()}.bind(this),click:function(d){c.checked=!c.checked;a=0;this.allManager()}.bind(this)});var b=$$("label[for="+c.get("id")+"]");if(b.length){b[0].addEvent("click",function(){c.checked=!c.checked})}}.bind(this));window.addEvent("mouseup",function(){a=0;
this.allManager()}.bind(this))},allManager:function(){if(this.options.relativ){if(this.options.elements.filter(function(a){return a.checked}).length==this.options.elements.length){this.options.relativ.checked=true}else{this.options.relativ.checked=false}}}});String.implement({equals:function(a){return(this==a||JSON.encode(this)==JSON.encode(a))}});Element.implement({click:function(a){return this.addEvent("click",a)},hasEvent:function(a,b){var c=this.retrieve("events");return c&&c[a]&&(b==undefined||c[a].keys.contains(b))},definedHight:function(a){if(this.retrieve("height")==null){this.store("height",this.getDimensions().y)}this.setStyles({height:0,opacity:0,display:"block"});if(this.retrieve("fx")==null){this.set("morph",{duration:240,transition:Fx.Transitions.linear,link:"cancel",onComplete:function(){if(a&&typeof a=="function"){a()}}}).morph({height:this.retrieve("height"),opacity:1});this.store("fx",true)}else{this.morph({height:this.retrieve("height"),opacity:1})}},zeroHight:function(){this.morph({height:0,opacity:0})
},hasProperty:function(a){return this.getProperty(a)?true:false},toggleDisplay:function(){if(this.getStyle("display")=="none"){this.show()}else{this.hide()}},PlayPicture:function(a,g,h,e){var c={},b=this.getElement(".selected"),i=this,d=this.getElements(".selected");if($defined(a)&&this.retrieve(a)==null){var f=new Element("img",{src:gewara.util.cdnPath+"css/images/loading3.gif",styles:{top:"46%",left:"46%"}}).inject(this);c.img=Asset.image(a,{styles:{opacity:0},onLoad:function(){if(this.width>g||this.height>h){rateWidth=this.width/g;rateHeight=this.height/h;if(rateWidth>rateHeight){c.width=g;c.height=this.height/rateWidth}else{c.width=this.width/rateHeight;c.height=h}}else{c.width=this.width;c.height=this.height}c.left=(g-c.width)/2;c.top=(h-c.height)/2;if(b!=null&&b!=this){if(gewa.util.container.pic){gewa.util.container.pic.dispose("pic")}d.removeClass("selected");b.morph({height:0,width:0,opacity:0,left:b.width/2,top:b.height/2})}f.dispose();this.setStyles({height:0,width:0,left:c.width/2,top:c.height/2});
this.addClass("selected").morph({height:c.height,opacity:1,width:c.width,left:0,top:0});i.morph({height:c.height,width:c.width,"margin-left":c.left,"margin-top":c.top});if(typeof(e)=="function"){e(true)}}}).inject(this);this.store(a,c)}else{var c=this.retrieve(a);b.morph({height:0,width:0,opacity:0,left:b.width/2,top:b.height/2});if(c!=null&&$defined(a)){if(gewa.util.container.pic){gewa.util.container.pic.dispose("pic")}d.removeClass("selected");c.img.addClass("selected").morph({height:c.height,opacity:1,width:c.width,left:0,top:0});i.morph({height:c.height,width:c.width,"margin-left":c.left,"margin-top":c.top})}else{if(!gewa.util.container.pic){gewa.util.maskContent(i,"没有图片了...","",220,"pic")}}if(typeof(e)=="function"){e(true)}}},hover:function(c,e,a,f,g,b){if(!$(c)){return null}c=$(c);if(c.retrieve("hover")==null){var d=new HoverGroup({elements:[this,c],delay:$defined(g)?g:300,onEnter:function(){if(a&&typeof a=="function"){a()}c.definedHight(e);if(b&&typeof b=="function"){b()}},onLeave:function(){c.zeroHight();
if(f&&typeof f=="function"){f()}}});c.store("hover",d);this.store("hover",d)}},mousehover:function(b,a){return this.addEvents({mouseenter:function(c){b.attempt(c,this)},mouseleave:function(c){a.attempt(c,this)}})},toPos:function(c,b,a,d){a=$defined(a)?a:0;d=$defined(d)?d:10;this.position({relativeTo:c,position:b,offset:{x:a,y:d}})},autoTips:function(a){a=a||{};if(document.body.retrieve("autotips")==null){var b={};b.child={};b.child.width=a.width;b.ispoint=a.ispoint||false;b.child.height=window.getSize().y;b.o=this.getPosition();b.point="upperRight";a.border=a.border||"#cdcdcd";b.inject=new Element("div",{styles:{width:b.child.width,height:b.child.height,position:"fixed",bottom:0,left:0,opacity:0,overflow:"hidden",background:a.bgColor,"z-index":100,"border-left":"1px solid "+a.border}}).inject(document.body);b.html=new Element("div",{styles:{width:b.child.width-1,height:"100%",overflow:"hidden","border-left":"1px solid #ffffff"}}).inject(b.inject);if(!b.ispoint){b.pl=new Element("div",{styles:{width:"16px",height:a.ch||"22px","border-width":"1px 0","border-style":"solid","border-color":a.plborder||a.border,position:"absolute","z-index":a.plIndex||101,display:"none",background:a.plBgcolor||a.bgColor}}).inject(document.body)
}window.addEvents({scroll:function(){var c=document.getScroll().y,d=window.getSize().y;if(!window.XMLHttpRequest){b.inject.setStyles({top:c,position:"absolute"})}},resize:function(){b.child.height=window.getSize().y;b.inject.setStyle("height",window.getSize().y)}});b.property={};b.property.content=function(d,c,e){b.html.innerHTML=$(d)?$(d).innerHTML:d;b.property.go(c);if(e&&typeof e=="function"){e()}};b.pos=b.inject.getPosition();b.isAttach=false;b.property.go=function(d){a.el=d;var c=!b.ispoint?10:0;b.inject.setStyle("left",d.getPosition().x+d.getDimensions().x+c);if(!b.ispoint){b.pl.position({relativeTo:d,position:b.point,offset:{x:-5,y:0}})}};b.isHide=function(){return b.isAttach};b.inject.addEvents({mouseenter:function(){b.isAttach=true;if(a.clazz&&a.el){a.el.addClass(a.clazz)}},mouseleave:function(){b.isAttach=false;b.hide.delay(120,[a.clazz])}});b.show=function(){b.inject.morph({width:b.child.width,opacity:1,onComplete:function(){b.isAttach=true;if(document.getElements("select").length>0&&!window.XMLHttpRequest){document.getElements("select").hide()
}if(!b.ispoint){b.pl.show()}if(a.clazz&&a.el){a.el.addClass(a.clazz)}}.bind(b.inject)})};b.hide=function(){if(!b.isAttach){if(!b.ispoint){b.pl.hide()}b.inject.morph({width:0,opacity:0,onComplete:function(){b.isAttach=false;if(document.getElements("select").length>0&&!window.XMLHttpRequest){document.getElements("select").show()}if(a.clazz&&a.el){a.el.removeClass(a.clazz)}}.bind(b.inject)})}};document.body.store("autotips",b);return b}else{return document.body.retrieve("autotips")}}});var Widget=new Class({Implements:[Class.Occlude],initialize:function(a){if(this.occlude("widget",a)){return this.occluded}}});var Collapsable=new Class({Extends:Fx.Reveal,initialize:function(b,e,d,a,c){this.clicker=$(b);this.section=$(e);this.f=a;this.parent(c);this.obj=d;this.addEvents()},addEvents:function(){this.clicker.addEvent("click",function(b){var a=$(b)?$(b):$(b.target);if(!a.hasClass("AC")){a=a.getParent(".AC")}if($defined(this.obj)&&this.obj!=null){checkLogin(true,function(){var c=this.obj.elements.indexOf(a);
this.obj.options.count=c;this.element=this.obj.loadElements[c];this.obj.replay();if(a.retrieve(a.get("lang"))==null){this.obj.getReplay(a,this.obj.loadElements[c].getElement("ul").getNext("._replayList"),a.get("id"))}if(typeof(this.f)=="function"){this.f()}this.toggle()}.bind(this))}else{this.element=this.section;if(typeof(this.f)=="function"){this.f()}this.toggle()}}.bind(this))}});var modifyDefiend=new Class({Extends:Fx.Reveal,initialize:function(a,b){this.selectSwitchDis=$$("select"+a);this.radioSwitchDis=$$("input"+a);this.parent(this.section,b);if(this.options.address&&$(this.options.address)){this.address=$(this.options.address)}this.elementTo=$(this.options.to);this.cookieCitycode=this.options.cookieCitycode;this.select();this.radio()},addEvents:function(b,a){if(b.get("lang")==null||b.get("lang")==""){if(this.elementTo.getElement("div")){this.elementTo.getElement("div").show()}this.elementTo.getElement('input[type="radio"]').checked=true;if($defined(this.dialog)&&this.dialog!=null){this.hide();
this.clearChoice()}}else{this.elementPlugs(b);this.element=this.dialog;gewa.util.mask({element:this.elementTo,title:"正在加载,请稍候..."});this.selection(b,a);this.update(b.get("lang"),function(){this.loadElement.getElements("input[type='text']").each(function(e){if(!$("myScript"+e.get("name"))){var c=this,d=new Date();new Asset.javascript(gewara.util.basePath+"activity/getConst.xhtml?citycode="+this.cookieCitycode+"&tag="+b.get("lang")+"&v="+d.getMilliseconds(),{id:"myScript"+e.get("name"),onLoad:function(){c.autoChoice(b,e)}})}else{this.autoChoice(b,e)}}.bind(this))}.bind(this));this.reveal()}if(this.choice&&this.elementTo){this.choice.store("relatedid",null);this.choice.store("categoryid",null);this.elementTo.store("relatedid",null);this.elementTo.store("categoryid",null)}OverText.update()},autoChoice:function(filter,item){var tokens=eval(filter.get("lang")+item.get("lang"));new Autocompleter.Local(item,tokens,{delay:100,maxChoices:10,ipt:item,relatedFun:this.objectRelated.bind(this),filter:function(){var values=this.queryValue.split(/ +/);
return this.tokens.filter(function(token){var result=values.every(function(v){var reg=new RegExp(v.escapeRegExp(),"i");return reg.test(token.skey)});return result})},injectChoice:function(choice){modifyPlug(this,choice,item.get("name"),item.get("lang"))},addChoiceEvents:function(el){return el.addEvents({mouseover:this.choiceOver.bind(this,[el]),click:this.choiceSelect.bind(this,[el])})}})},selection:function(b,a){this.elementTo.getElement("div").hide();this.clearChoice();this.elementTo.getElements('input[type="radio"]').each(function(c){this.showChoice.show();if(c.value.trim()==b.get("lang").trim()){c.checked=true;new Element("span",{text:"请选择关联的"+c.get("title"),styles:{"padding-right":"8px",cursor:"pointer"}}).inject(new Element("span").addClass("releBt releHover").addEvent("click",function(){this.addEvents(c,false);this.dialog.show()}.bind(this)).inject(this.showChoice));if(!a){new Element("img",{src:gewara.util.cdnPath+"css/images/blank.gif"}).addEvent("click",function(){this.elementTo.getElement('input[type="radio"]').checked=true;
this.elementTo.getElement("div").show();this.dialog.hide();this.clearChoice();if(this.address){this.address.value="";this.address.fireEvent("blur",[this.address])}c.checked="";OverText.update()}.bind(this)).inject(new Element("span",{text:c.getParent().get("text")}).inject(new Element("span",{"class":"releBt releHover"}).inject(this.showChoice,"top")))}GewaraUtil.unmask()}else{c.checked=""}}.bind(this));OverText.update()},create:function(b){this.dialog=new Element("div",{"class":"plugpanel",styles:{width:"600px",display:"none",visibility:"visible"}}).inject(document.body);this.inner=new Element("div",{"class":"inner"}).inject(this.dialog);new Element("img",{src:gewara.util.cdnPath+"css/home/min_pt.gif",styles:{position:"absolute",top:"-5px",left:"20px"}}).inject(this.inner);this.close=new Element("span",{"class":"more",styles:{background:"url("+gewara.util.cdnPath+"css/home/del.gif) no-repeat",width:"10px",height:"10px",display:"inline-block",top:"10px",cursor:"pointer"}}).addEvent("click",function(){this.dialog.hide();
this.choice.empty();if(Browser.ie6){document.getElements("select").fade(1)}}.bind(this)).inject(this.inner);this.loadElement=new Element("div").inject(this.inner);new Element("span",{"class":"gr-r"}).inject(new Element("span",{"class":"gr-l"}).inject(new Element("div",{"class":"line mt10"}).inject(this.inner)),"after");this.choice=new Element("dd").inject(new Element("dl",{"class":"ui_80 clear relePlugs mt10"}).inject(this.inner));new Element("b",{text:"你已选择"}).inject(new Element("dt").inject(this.choice,"before"));this.footer=new Element("div",{"class":"plugFooter mt10"}).inject(this.inner);this.sure=new Element("label",{"class":"button redBt minBt ml20"}).addEvents({mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")},click:function(){this.confirmChoice("relatedid","categoryid")}.bind(this)}).inject(this.footer);new Element("input",{type:"button",value:"确认，添加"}).inject(this.sure);this.cancel=new Element("label",{"class":"button whiteBt minBt ml10"}).addEvents({mouseenter:function(){this.addClass("hover")
},mouseleave:function(){this.removeClass("hover")},click:function(){this.choice.empty();this.dialog.hide();if(Browser.ie6){document.getElements("select").fade(1)}}.bind(this)}).inject(this.footer);new Element("input",{type:"button",value:"取消"}).inject(this.cancel);this.dialog.toPos(this.elementTo,"bottomLeft",0,0);var a={dialog:this.dialog,close:this.close,loadEm:this.loadElement,choice:this.choice,sure:this.sure,cancel:this.cancel};this.dialog.store(b.get("lang"),a)},elementPlugs:function(a){if(!$defined(this.dialog)&&this.dialog==null){this.create(a)}else{if(this.dialog.retrieve(a.get("lang"))!=null){var b=this.dialog.retrieve(a.get("lang"));this.dialog=b.dialog;this.close=b.close.addEvent("click",function(){this.dialog.hide()}.bind(this));this.loadElement=b.loadEm;this.choice=b.choice;this.sure=b.sure.addEvent("click",function(){this.confirmChoice("relatedid","categoryid")}.bind(this));this.cancel=this.cancel.addEvent("click",function(){this.dialog.hide()}.bind(this))}else{this.create(a)
}}},select:function(){this.selectSwitchDis.addEvent("change",function(a){if(this.dialog){this.dialog.hide()}this.addEvents($(a.target).getElements("option").filter(function(b){return b.get("selected")})[0],true)}.bind(this))},radio:function(){this.radioSwitchDis.addEvent("click",function(a){if($(a.target).checked=true){this.addEvents($(a.target),false)}}.bind(this))},clearChoice:function(){if(this.elementTo.getElements("div.relePlugs").length>0){this.showChoice=this.elementTo.getElement("div.relePlugs");this.showChoice.hide().empty()}else{this.showChoice=new Element("div",{"class":"relePlugs clear"}).inject(this.elementTo,"bottom")}if(Browser.ie6){document.getElements("select").fade(0)}},update:function(d,c){var b=gewara.util.basePath+"ajaxLoadUserFav.xhtml";var a={tag:d,citycode:this.cookieCitycode};if(this.loadElement.retrieve(d)==null){GewaraUtil.sendLoad(this.loadElement,b,a,function(){c();this.loadElement.store(d,this.loadElement.get("html"));this.switchobject();gewaUtil.textOver(".text")
}.bind(this))}else{this.loadElement.innerHTML=this.loadElement.retrieve(d);c();this.switchobject();gewaUtil.textOver(".text")}},switchobject:function(){var a=this;this.loadElement.getElements("a").addEvent("click",function(b){b.preventDefault();var c={rel:this.get("rel"),id:this.get("id"),name:this.get("name"),text:this.get("text"),address:this.get("config")?this.get("config"):""};a.objectRelated(c)})},objectRelated:function(c,f,b){if(!this.choice){return}var i=this;if(this.choice.retrieve(c.rel)==null){var h=new Element("span").addClass("releBt releHover _plugC").inject(f?this.showChoice:this.choice);if(i.address&&c.address!=""&&c.address!=null){i.address.value=c.address;i.address.fireEvent("focus",[i.address])}var a=new Element("input",{type:"hidden",name:c.rel,value:c.id}).inject(new Element("img",{src:gewara.util.cdnPath+"css/images/blank.gif"}).addEvent("click",function(){if(i.address&&c.rel=="relatedid"){i.address.value="";i.address.fireEvent("blur",[i.address])}i.choice.store(c.rel,null);
i.elementTo.store(c.rel,null);if(b==""&&i.showChoice.getElements("._plugC").length<2){i.elementTo.getElement('input[type="radio"]').checked=true;i.elementTo.getElement("div").show();i.dialog.hide();OverText.update();i.clearChoice()}this.getParent(".releBt").dispose();if(i.elementTo.retrieve("relatedid")==null&&i.elementTo.retrieve("categoryid")==null){i.showChoice.getLast().show()}}).inject(new Element("span",{text:c.text}).inject(h)),"before");if(c.rel=="categoryid"){new Element("input",{type:"hidden",name:"category",value:c.name}).inject(a,"before")}i.choice.store(c.rel,h);if(f){i.elementTo.getElement(".releBt").hide();i.elementTo.store(c.rel,h)}}else{var g=i.choice.retrieve(c.rel).getElement("span"),e=g.getElements("input"),d=e.getNext();g.set("text",c.text);e.each(function(j){if(j.name=="category"){j.value=c.name}else{if(j.name=="categoryid"){j.value=c.id}else{j.value=c.id}}j.inject(g)});d.inject(g)}},confirmChoice:function(b,a){var d=$("plugChoose"),c=$("plug_show");this.elementTo.store(b,this.choice.retrieve(b));
this.elementTo.store(a,this.choice.retrieve(a));if(this.choice){this.choice.getElements("._plugC").inject(this.showChoice.getElement(".releBt"),"after")}if(this.elementTo.retrieve(b)==null&&this.elementTo.retrieve(a)==null){this.showChoice.getLast().show()}else{this.showChoice.getLast().hide()}this.dialog.hide();if(Browser.ie6){document.getElements("select").fade(1)}},reset:function(a){if(a.lang!=""){this.selection(a,true);this.create(a)}var b={rel:a.rel,id:a.id,name:a.name,text:a.text,address:a.get("config")};this.objectRelated(b,true,a.lang)}});gewa.util.removeBodyClick=function(b,a,c){b=$(b);document.addEvent("click",function(f){var d=$(f.target);if(d!=b&&!b.contains(d)&&d!=a&&!a.contains(d)){document.removeEvent("click",arguments.callee);b.hide();if(c){c()}}})};(function(){var b=function(e,c,d,h){var f=e[c];var g=[];while(f){if(f.nodeType==1){if(!d||Element.match(f,d)){break}else{g.push(f)}}f=f[c]}return new Elements(g,{ddup:false,cash:!h})};var a=function(e,c,f){var d=0;var g=[];while(d<f){g.push(e.getElements(c)[d]);
d++}return new Elements(g,{ddup:false})};Element.implement({getAllPreviousUntil:function(c,d){return b(this,"previousSibling",c,d)},getAllNextUntil:function(c,d){return b(this,"nextSibling",c,d)},getParentsUntil:function(c,d){return b(this,"parentNode",c,d)},getElementsByCount:function(c,d){return a(this,c,d)}})})();Fx.implement({initStyles:function(){this.init={};$A(arguments).each(function(b){if(b=="opacity"){this.init.opacity=this.element.get("opacity")}else{(this.element.getStyle(b).test("px"))?this.init[b]=this.element.getStyle(b).toInt():this.init[b]=this.element.getStyle(b)}},this);return this},removeAuto:function(){if(!this.init){this.init={}}$A(arguments).each(function(b){if(this.element.getStyle(b)=="auto"){this.element.setStyle(b,"0px");this.init[b]=0}},this);return this},setPosition:function(){if(this.element.getStyle("position")=="static"){this.element.setStyle("position","relative")}return this}});Fx.Toggle=new Class({Extends:Fx.Tween,initialize:function(b,a){this.parent(b,a);
this.initStyles("height","width","opacity");this.element.setStyle("overflow","hidden")},toggleHeight:function(d,c){var b=this.element.getChildren().getDimensions(),a=this.init.height;d=d||0;if(a==d&&b.length>0){b.each(function(e){a=e.y+a})}a=a=="auto"?d:a;(this.element.getStyle("height").toInt()>d)?this.start("height",d):this.start("height",a);if(c&&typeof(c)=="function"){c()}return this},toggleHeightValue:function(a){a=a||0;this.start("height",a);return this},toggleWidth:function(){(this.element.getStyle("width").toInt()>0)?this.start("width",0):this.start("width",this.init.width);return this},toggleOpacity:function(){(this.element.getStyle("opacity").toInt()>0)?this.start("opacity",0):this.start("opacity",this.init.opacity);return this},toggleDisplay:function(){this.toggleProperty("display","none","block");return this},toggleVisibility:function(){this.toggleProperty("visibility","hidden","visible");return this},toggleStyle:function(){},toggleProperty:function(b,d,c,a){if($string(d)&&$string(c)){if(!a){(this.element.getStyle(b)==d.toLowerCase())?this.element.setStyle(b,c):this.element.setStyle(b,d)
}else{(this.element.getStyle(b)==d.toLowerCase())?this.start(b,c):this.start(b,d)}}else{if($int(d)&&$int(c)){if(!a){(this.element.getStyle(b).toInt()==d)?this.set(b,c):this.set(b,d)}else{(this.element.getStyle(b).toInt()==d)?this.start(b,c):this.start(b,d)}}}return this},toggle:function(a){switch(a){case"height":this.toggleHeight();break;case"width":this.toggleWidth();break;case"opacity":this.toggleOpacity();break;case"display":this.toggleDisplay();break;case"visibility":this.toggleVisibility();break}return this}});Fx.Grow=new Class({Extends:Fx.Morph,initialize:function(c,b,a){this.parent(c,b);this.values=a||{height:200,width:200,fontsize:10};this.element.setStyle("overflow","hidden")},start:function(b){var b=b||this.values,a=this.element.getDimensions().x,c=this.element.getDimensions().y;this.parent({top:(c>0)?[(this.element.getParent().clientHeight-this.values.height)/2,this.values.height/2]:[this.values.height/2,(this.element.getParent().clientHeight-this.values.height)/2],left:(a>0)?[(this.element.getParent().clientWidth-this.values.width)/2,this.element.getParent().clientWidth-this.values.width/2]:[this.values.width/2,(this.element.getParent().clientWidth-this.values.width)/2],height:(c>0)?[this.values.height,0]:[0,this.values.height],width:(a>0)?[this.values.width,0]:[0,this.values.width],opacity:(c>0&&a>0)?[1,0]:[0,1]})
}});gewa.util.pagePos=function(b){var a;if(b){a=$(b)}else{var c=gewa.util.getRequestParams("topos");a=$(c.trim())}if(a){$(window).scrollTo(0,a.getPosition().y)}};gewa.util.getRequestParams=function(b,e){var a=window.location.search||e;if(a&&a.indexOf(b)>0){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i"),d=a.substr(1).match(c);return(d!=null)?d[2]:""}else{return""}};gewa.util.getUrlParams=function(c){var b=window.location.search||c;if(b){array=b.substr(1).split("&");var a={};if(array){array.each(function(e){keyValue=e.split("=");var d=keyValue[0];if($chk(d)){a[d]=keyValue[1]?keyValue[1]:""}})}return a}else{return{}}};gewa.util.setInterval=function(){};var Icon=new Class({Implements:[Options,Events],options:{unit:["32","20"],dir:{xg:"格小拉",jd:"经典"},icon:new Object(),path:GewaraUtil.cdnPath+"img/minFace/",isLoad:[0,0]},initialize:function(a){this.setOptions(a);this.getIconTitle()},getIconTitle:function(){this.options.icon=[{"01":"点头","02":"发飙","03":"发呆","04":"呵呵","05":"黑线","06":"贱贱","07":"惊讶","08":"可怜","09":"哭","010":"酷","011":"狂汗","012":"喷","013":"期待","014":"亲亲","015":"色眯眯","016":"微笑","017":"笑","018":"笑cry","019":"疑问","020":"晕"},{"01":"害羞","02":"可爱","03":"呵呵","04":"花心","05":"嘻嘻","06":"亲亲","07":"噢耶","08":"懒得理你","09":"抱抱","010":"鄙视","011":"汗","012":"晕","013":"泪","014":"悲伤","015":"闭嘴","016":"吃惊","017":"酷","018":"哈哈","019":"困","020":"花","021":"伤心","022":"邮件","023":"电话","024":"干杯","025":"调谢","026":"握手","027":"good","028":"唱歌","029":"得意","030":"疑问","031":"便便","032":"呆","033":"河蟹","034":"囧","035":"咖啡","036":"礼花","037":"礼物","038":"篮球","039":"骷髅","040":"闪电","041":"弱","042":"怒","043":"衰","044":"失望","045":"生病","046":"睡觉","047":"太阳","048":"下雨","049":"心","050":"星","051":"药","052":"月亮","053":"钟","054":"抓狂","055":"足球"}]
},innerHTML:function(h,a){h=$(h);a=$(a);var d="",g="",e="";Object.each(this.options.dir,function(j,i){g+=this.replaceTabs(i,j)}.bind(this));var c=new Element("div",{html:d,"class":"dalogIcon uidialog clear",id:"uidialog"});var f=new Element("ul",{"class":"dalogIconTags clear",html:g,id:"dalogIconTags"}).inject(c);for(var b=0;b<Object.getLength(this.options.dir);b++){if(b==0){e+="<div class='dalogIconBox clear'></div>"}else{e+="<div class='dalogIconBox none clear'></div>"}}new Element("div",{html:e,"class":"dalogIconConts clear",id:"dalogIconConts"}).inject(f,"after");gewa.util.tips(h,c,422,"icon","",function(){var j=this;var i=f.getElements("a");i.each(function(l,k){l.addEvent("click",function(){if(j.options.isLoad[k]===0){j.loadImg(k,a)}$("uidialog").getElements(".dalogIconBox").addClass("none");$("uidialog").getElements(".dalogIconBox")[k].removeClass("none")})});i.addEvent("click",function(){i.each(function(k){k.getParent("li").removeClass("select")});this.getParent("li").addClass("select")
});document.addEvent("click",function(m){var l=$(m.target),k=gewa.util.container.icon;if(l!=k.coreDialog&&!k.coreDialog.contains(l)&&l!=h&&!h.contains(l)){document.removeEvent("click",arguments.callee);k.dispose(["icon"],true)}})}.bind(this),"","0");this.loadImg(0,a)},replaceTabs:function(a,b){return"<li class='$2'><a href='javascript:void(0);'>$1</a></li>".replace(/\$1|\$2/g,function(c){if(c=="$2"){if(a=="xg"){return c="select"}else{return c=""}}return c=b}.bind(this))},loadImg:function(b,a){var d=$("uidialog").getElements(".dalogIconBox")[b];var c="";Object.each(this.options.icon[b],function(f,e){c+=this.replaceHTML(e,f,b)}.bind(this));d.innerHTML=c;this.bindEvent(a);this.options.isLoad[b]=1},replaceHTML:function(b,c,a){return"<a href='' rel='[$3]'><img src='$1' width='$4' height='$4' title='$2'/></a>".replace(/\$1|\$2|\$3|\$4/g,function(d){if(d=="$1"){return d=this.options.path+Object.keys(this.options.dir)[a]+"/"+b+".gif"}else{if(d=="$3"){return d=Object.keys(this.options.dir)[a]+b}else{if(d=="$4"){return d=this.options.unit[a]
}else{return d=c}}}}.bind(this))},bindEvent:function(a){$("dalogIconConts").getElements("a").each(function(c){if(c.hasEvent("click")){return}c.addEvent("click",function(b){b.preventDefault();try{a.focus();if(a.hasEvent("focus")&&Browser.ie){a.fireEvent("focus")}a.value+=this.get("rel")}catch(b){}})})}});var IconOld=new Class({Implements:[Options,Events],options:{icon:new Object(),path:GewaraUtil.cdnPath+"/img/minFace/"},initialize:function(a){this.setOptions(a);this.getIconTitle()},getIconTitle:function(){this.options.icon={"01":"害羞","02":"可爱","03":"呵呵","04":"花心","05":"嘻嘻","06":"亲亲","07":"噢耶","08":"懒得理你","09":"抱抱","010":"鄙视","011":"汗","012":"晕","013":"泪","014":"悲伤","015":"闭嘴","016":"吃惊","017":"酷","018":"哈哈","019":"困","020":"花","021":"伤心","022":"邮件","023":"电话","024":"干杯","025":"调谢","026":"握手","027":"good","028":"唱歌","029":"得意","030":"疑问","031":"便便","032":"呆","033":"河蟹","034":"囧","035":"咖啡","036":"礼花","037":"礼物","038":"篮球","039":"骷髅","040":"闪电","041":"弱","042":"怒","043":"衰","044":"失望","045":"生病","046":"睡觉","047":"太阳","048":"下雨","049":"心","050":"星","051":"药","052":"月亮","053":"钟","054":"抓狂","055":"足球"}
},innerHTML:function(d,a){d=$(d);a=$(a);var c="";Object.each(this.options.icon,function(f,e){c+=this.replaceHTML(e,f)}.bind(this));var b=new Element("div",{html:c,"class":"dalogIcon uidialog clear",id:"uidialog"});gewa.util.tips(d,b,396,"icon","",function(){b.getElements("a").addEvent("click",function(f){f.preventDefault();try{a.focus();if(a.hasEvent("focus")&&Browser.ie){a.fireEvent("focus")}a.insertAtCursor(this.get("rel"))}catch(f){}});document.addEvent("click",function(h){var g=$(h.target),f=gewa.util.container.icon;if(g!=f.coreDialog&&!f.coreDialog.contains(g)&&g!=d&&!d.contains(g)){document.removeEvent("click",arguments.callee);f.dispose(["icon"],true)}})},"","0")},replaceHTML:function(a,b){return"<a href='' rel='[$3]'><img src='$1' width='20' height='20' title='$2'/></a>".replace(/\$1|\$2|\$3/g,function(c){if(c=="$1"){return c=this.options.path+a+".gif"}else{if(c=="$3"){return c=a}else{return c=b}}}.bind(this))}});gewa.util.makeRelation=function(b,a){checkLogin(true,function(){a=$(a);
GewaraUtil.sendRequest(GewaraUtil.basePath+"micro/addMicroAttention.xhtml",{memberid:b},function(d){if(d.success){a.hide();var c=new Element("span",{text:"|",styles:{background:"#EFEFEF",border:"1px solid #cccccc",display:"inline-block",height:"22px","line-height":"22px",padding:"0 8px","float":"left"}}).inject(a,"before");new Element("span",{text:"取消",styles:{color:"#C03B0C","margin-left":"5px",cursor:"pointer"}}).addEvent("click",function(){gewaUtil.cancelRelation(b,this.getParent(),a)}).inject(c);new Element("span",{text:"已关注",styles:{color:"#666666","margin-right":"5px"}}).inject(c,"top")}else{gewaUtil.alert(d.msg)}})})};gewa.util.cancelRelation=function(c,a,b){checkLogin(true,function(){if($(a)){a=$(a)}GewaraUtil.sendRequest(GewaraUtil.basePath+"micro/cancelAttention.xhtml",{memberid:c},function(d){if(d.success){gewaUtil.alert("取消成功！",function(){if($(a)){a.dispose()}if($(b)){$(b).show();$(b).removeClass("none")}})}else{gewaUtil.alert(d.msg)}},"get")})};gewa.util.dialogSingleUpdate=function(c,a,b){c={id:$(c)};
if(c.id.retrieve("iframe")==null){c.html=new Element("div",{styles:{display:"none"}}).inject(document.body);new Element("iframe",{src:"blank.html",name:"iframe_async_upload",id:"iframe_async_upload",styles:{display:"none"}}).inject(c.html);c.form=new Element("form",{action:GewaraUtil.basePath+"common/uploadPicture.xhtml",method:"post",target:"iframe_async_upload"}).inject(c.html);if(Browser.ie6||Browser.ie7){c.form.setAttribute("encoding","multipart/form-data")}else{c.form.setAttribute("enctype","multipart/form-data")}new Element("input",{type:"hidden",name:"callback",value:b}).inject(c.form);new Element("input",{type:"hidden",name:"callbackUrl",value:GewaraUtil.basePath+"common/afterUploadPicture.xhtml?uploadtag=micro&callbackf=gewa.util.updateCallback"}).inject(c.form);c.t=new Element("div",{text:"支持上传 .gif .jpg .png 格式图片，最大不超过2M。",styles:{width:"100%",height:"22px",overflow:"hidden","text-indent":"10px",color:"#999"}}).inject(c.form);c.pic=new Element("div",{id:"async_upload",styles:{width:"290px",height:"120px",overflow:"hidden",position:"relative","margin-top":"10px"}}).inject(c.form);
c.tl=new Element("div",{id:"async_upload_file",styles:{width:"76px",height:"24px",overflow:"hidden",position:"absolute",left:"95px",top:"49px"}}).inject(c.pic);c.input=new Element("input",{type:"file",name:"headlogo",id:"file_async_upload",styles:{background:"transparent",outline:"none","hide-focus":"expression(this.hideFocus=true)",opacity:0,position:"absolute","z-index":2,left:"-60px",width:150,top:"-2px","font-size":"20px",visibility:"visible",cursor:"pointer"}}).addEvent("change",function(){checkLogin(true,function(){c.form.submit()})}).inject(c.tl);new Element("span",{text:"上传图片"}).inject(new Element("a",{"for":"file_async_upload","class":"button minBt redBt",href:"javascript:void(0);"}).addEvent("click",function(){c.input.fireEvent("focus")}).inject(c.tl),"top");c.id.store("iframe",c.html)}else{c.html=c.id.retrieve("iframe")}gewa.util.tips(c.id,c.html,340,"dailogpic","",function(){document.addEvent("click",function(g){var f=$(g.target),d=gewa.util.container.dailogpic;if(f!=d.coreDialog&&!d.coreDialog.contains(f)&&f!=c.id&&!c.id.contains(f)){document.removeEvent("click",arguments.callee);
d.dispose(["dailogpic"],true)}})},"","0")};gewa.util.updateCallback=function(b){var a={};a.img=Asset.image(GewaraUtil.cdnPath+b.picpath,{onLoad:function(){if(this.width>290||this.height>120){rateWidth=this.width/290;rateHeight=this.height/120;if(rateWidth>rateHeight){this.width=290;this.height=this.height/rateWidth}else{this.width=this.width/rateHeight;this.height=120}this.setStyles({"margin-left":(290-this.width)/2,"margin-top":(120-this.height)/2})}}}).inject("async_upload");$("async_upload_file").hide();a.input=new Element("input",{type:"hidden",name:"bodypic",id:"bodypic",value:b.picpath}).inject(b.callback,"before");$(b.callback).value=$(b.callback).value+"分享图片";if($("wala_defV")){$("wala_defV").hide()}new Element("span",{text:"删除图片",styles:{display:"inline-block",background:"#fff","border-radius":"3px",height:"20px","line-height":"20px",padding:"0 6px",cursor:"pointer",color:"#DD9966",border:"1px solid #ddd",position:"absolute","*line-height":"21px",left:115,top:49,"z-index":1}}).addEvent("click",function(){GewaraUtil.sendRequest(GewaraUtil.basePath+"micro/delMicroBlogPic.xhtml",{picpath:b.picpath},function(c){this.dispose();
a.img.dispose();a.input.dispose();$("async_upload_file").show()}.bind(this))}).inject("async_upload")};gewa.util.replay=new Class({Implements:[Options,Events],options:{},initialize:function(a){this.setOptions(a)},createMessageDialog:function(i){if(i.id.contains("img")){i.id=i.id.substring(3);c="回复";var e=this}else{var e=this,b=(i._this.get("lang")=="f")?true:false,c=b?"转发":"回复"}if(i.element.retrieve("dom")==null){var a=new Element("dl",{"class":"isFirstNode"}).inject(i.element,"top");new Element("img",{"class":"picmin",src:(GewaraUtil.cdnPath+(GewaraUtil.member.headUrl!=""?GewaraUtil.member.headUrl:"cw30h30/img/default_head.png")),width:30,height:30}).inject(new Element("span",{"class":"picmin"})).inject(new Element("dt").inject(a));var g=new Element("dd").inject(a);i.atmemberid=new Element("input",{type:"hidden",name:"atmemberid"}).inject(g,"top");i.replyid=new Element("input",{type:"hidden",name:"replyid"}).inject(g,"top");var h=new Date().getTime()+i.id;i.replayBt=new Element("button",{html:c,"class":"button"}).addEvent("click",function(){if(i.textarea.value.trim()==""){i.textarea.highlight("#ffcc99","#fff")
}else{e.datas=this.getParent("dd").toQueryString().parseQueryString();e.datas.commentid=i.id;e.criteDom=new Element("div").hide().inject(a,"after");checkLogin(true,function(){GewaraUtil.sendLoad(e.criteDom,GewaraUtil.basePath+"activity/ajax/sns/oldReplyComment.xhtml",e.datas,function(j){if(j.success){i.textarea.value="";e.criteDom.reveal()}else{gewaUtil.alert(j.json.msg)}})})}}).inject(g);var f=new Element("div",{"class":"review"}).inject(g);new Element("input",{type:"checkbox",checked:b?"checked":"",name:"isMicro",id:h,styles:{"margin-right":"3px"}}).addEvent("click",function(){if(b){this.checked=b}}).inject(new Element("label",{html:"转发到我的哇啦","class":"left ui_wala_rzf","for":h}).inject(f),"top");var d=new Element("b",{html:140,styles:{"float":"right","font-family":"Constantia,Georgia","font-size":"14px",color:"#CC3300","margin-right":"70px"}}).inject(f);i.textarea=new Element("textarea",{name:"body",id:"body",root:"text",alt:"请输入"+c+"内容...",styles:{color:"#666"}}).inject(g,"top");i.textarea.addEvent("focus",function(){this.addClass("onFocus")
});i.textarea.addEvent("blur",function(){this.removeClass("onFocus")});i.textarea.addEvent("keyup",function(){this.value=this.value.replace(/\n/g,"");if(this.value.length>0){i.replayBt.addClass("onButton")}else{i.replayBt.removeClass("onButton")}if(140-this.value.length>=0){e.values=this.value;d.innerHTML=140-this.value.length;this.setStyle("height",this.getScrollSize().y)}else{this.value=e.values;d.innerHTML=0;this.highlight("#ffcc99","#fff")}}).inject(g,"top");if(i._this.hasProperty("form")){i.textarea.set("value",(i._this.hasProperty("form"))?i._this.get("form"):"");if(i._this.hasProperty("data-atmid")){i.atmemberid.set("value",i._this.get("data-atmid"))}if(i._this.hasProperty("data-replyid")){i.replyid.set("value",i._this.get("data-replyid"))}}new Element("em",{"class":"dmore"}).inject(new Element("span",{"class":"iserm",text:"表情"}).addEvent("click",function(){i.icon.innerHTML(this,i.textarea)}).inject(f,"top"));if(typeof i.callback=="function"){i.callback.run()}i.element.store("dom",a)
}else{i.node=i.element.retrieve("dom");i.button=i.node.getElement("button");i.textArea=i.node.getElement("textArea");i.checkbox=i.node.getElement("input[type=checkbox]");i.atmemberid=i.node.getElement("input[name=atmemberid]");i.replyid=i.node.getElement("input[name=replyid]");i.checkbox.removeEvents("click");i.button.checked="";i.button.set("text","回复");i.checkbox.checked="";if(i._this.hasProperty("form")){i.textArea.value=i._this.get("form");if(i._this.hasProperty("data-atmid")){i.atmemberid.value=i._this.get("data-atmid")}if(i._this.hasProperty("data-replyid")){i.replyid.value=i._this.get("data-replyid")}}else{i.textArea.set("alt","请输入回复的内容...")}if(typeof i.callback=="function"){i.callback.run()}}}});function logout(){var a=GewaraUtil.basePath+"cas/logout.xhtml?ptn=smp";new Request({url:a,method:"get",onComplete:function(){gewaUtil.alert("成功退出！",refreshPage)}}).send()}gewa.util.messageInit=function(){var a={};a.tgs=document.getElements("*[lang=r],*[lang=f]");if(a.tgs.length>0){if(!$("walasCss")){Asset.css(GewaraUtil.cdnPath+"css/readwala.css",{id:"walasCss"})
}a.replay=new gewa.util.replay();a.icon=new Icon();a.tgs.addEvent("click",function(b){b.preventDefault();a.url=this.get("rel");a.element=this.getParent("*[data=isvalid] div[root=replay]");a.id=this.id;a._this=this;a.replay.createMessageDialog(a)})}};var RatingGroup=new Class({initialize:function(d,f,a,e,b,h){this.groupId=d;this.itemList=$(d).getElements("li");this.rating=f.toInt();this.tag=a;this.relatedid=e;this.desc=$(this.groupId+"Desc");this.group_id=$(this.groupId+"Point");this.marks=$defined(b)&&typeof(b)=="object"?b:false;this.callback=h||"";var c=1;var g=this;this.starList=[];if(this.rating==0&&this.marks){this.marks[this.groupId]=0}this.itemList.each(function(j,i){if(i%2!=0){j.set("class","no")}if(i<this.rating){if(i%2!=0){j.set("class","on")}else{j.set("class","half")}if(this.desc){this.desc.set("text",j.get("lang"))}if(this.group_id){this.group_id.set("text",j.id+".0")}if(this.marks){this.marks[this.groupId]=j.id}}this.starList[i]=j.get("class");j.addEvents({mouseover:function(){this.showStatus(j.id);
if(this.desc){this.desc.set("text",j.get("lang"))}if(this.group_id){this.group_id.set("text",j.id+".0")}}.bind(this),mouseout:function(){this.resetStatus()}.bind(this),click:function(){this.vote(j)}.bind(this)});c++}.bind(this))},resetStatus:function(){var a=1;this.itemList.each(function(c,b){if(b>=10){return}if(this.starList[b]=="on"||this.starList[b]=="half"){if(this.desc){this.desc.set("text",c.get("lang"))}if(this.group_id){this.group_id.set("text",c.id+".0")}if(b%2!=0){c.set("class","on")}else{c.set("class","half")}}else{if(c.hasClass("on")||b%2!=0){c.set("class","no")}else{c.set("class","")}}a++}.bind(this));if(!this.itemList.some(function(b){return(b.hasClass("on")||b.hasClass("half"))})){if($(this.groupId+"Desc")){$(this.groupId+"Desc").set("text","")}if(this.group_id){this.group_id.set("text","")}}},showStatus:function(b){var a=1;this.itemList.each(function(d,c){if(c>=10){return}if(a<=b){if(c%2!=0||d.hasClass("on")){d.set("class","on")}else{d.set("class","half")}}else{if(d.hasClass("on")||c%2!=0){d.set("class","no")
}else{d.set("class","")}}a++}.bind(this))},vote:function(a){checkLogin(true,function(){var d=this.groupId;var e=this;this.showStatus(a.id);if(this.marks){this.marks[this.groupId]=a.id;this.rating=a.id;this.itemList.each(function(g,f){this.starList[f]=g.get("class")}.bind(this));if(this.callback&&typeof this.callback=="function"){this.callback()}else{if(typeof(showMovieMark)=="function"&&this.groupId=="generalmark"){showMovieMark()}}}else{var c=GewaraUtil.basePath+"ma/common/addComment.xhtml",b={tag:this.tag,relatedid:this.relatedid,marks:d+"="+a.id};GewaraUtil.sendRequest(c,b,function(f){if(f.success){this.rating=a.id;this.itemList.each(function(h,g){this.starList[g]=h.get("class")}.bind(this));if(typeof(showMovieMark)=="function"&&this.groupId=="generalmark"){showMovieMark()}}else{gewaUtil.alert(f.msg)}}.bind(this))}}.bind(this))},fixStar:function(a){this.itemList.each(function(b){b.removeEvents("mouseover");b.removeEvents("mouseout");b.removeEvents("click")})}});gewa.util.deleteReComment=function(a){checkLogin(true,function(){gewaUtil.confirm("确认要删除吗?",function(){var c=GewaraUtil.basePath+"activity/ajax/sns/deleteMicroReComment.xhtml?r="+GewaraUtil.rtime();
var b={id:a};GewaraUtil.sendRequest(c,b,function(d){if(d.success){document.getElement("div[id="+a+"]").set("dissolve",{duration:"long",onComplete:function(){this.dispose()}.bind(document.getElement("div[id="+a+"]"))}).dissolve()}else{gewaUtil.alert(d.json.msg)}})})})};gewa.util.affix=function(b){var a=function(c){var g=c.getPosition().y,i=c.getStyle("position"),f=c.getDimensions().y,e=$$(".index_wrap")[0],d=$$(".index_wrap")[0].getDimensions().y,h=$$(".index_wrap")[0].getPosition().y;window.addEvent("scroll",function(){var j=this.getScroll().y;if(j>g){if(window.XMLHttpRequest){c.setStyles({position:"fixed",top:0})}else{c.setStyles({top:j})}}else{c.setStyles({position:"absolute",top:g})}if(e){if(f+Document.getScrollTop()>=d+h){e.setStyles({position:"relative"});c.setStyles({position:"absolute",bottom:"0",top:""})}else{e.setStyles({position:"static"})}}})};if($type(b)==="array"){return b.each(function(c){a(c)})}else{if($type(b)==="element"){a(b)}}};var GewaOverText=new Class({Implements:[Options,Events,Class.Occlude],Binds:["reposition","assert","focus","hide","keypress"],options:{element:"label",labelClass:"overTxtLabel",positionOptions:{position:"upperLeft",edge:"upperLeft",offset:{x:4,y:2}},poll:false,pollInterval:250,wrap:false},property:"GewaOverText",initialize:function(b,a){b=this.element=document.id(b);
if(this.occlude()){return this.occluded}this.setOptions(a);this.attach(b);GewaOverText.instances.push(this);if(this.options.poll){this.poll()}},toElement:function(){return this.element},attach:function(){var b=this.element,a=this.options,c=a.textOverride||b.get("alt")||b.get("title");if(!c){return this}var d=this.text=Element(a.element,{"class":a.labelClass,styles:{lineHeight:this.element.getDimensions().y,height:this.element.getDimensions().y,position:"absolute",cursor:"text",color:"#ccc",width:this.element.getDimensions().x,"text-indent":6},html:c,events:{click:function(){this.element.focus()}.bind(this)}}).inject(b,"after");if(a.element=="label"){if(!b.get("id")){b.set("id","input_"+String.uniqueID())}d.set("for",b.get("id"))}if(a.wrap){this.textHolder=new Element("div.overTxtWrapper",{styles:{lineHeight:"normal",position:"relative"}}).grab(d).inject(b,"before")}return this.enable()},destroy:function(){this.element.eliminate(this.property);this.disable();if(this.text){this.text.destroy()
}if(this.textHolder){this.textHolder.destroy()}return this},disable:function(){this.element.removeEvents({focus:this.focus,blur:this.assert,keypress:this.keypress,keyup:this.assert,change:this.assert});window.removeEvent("resize",this.reposition);this.hide(true,true);return this},enable:function(){this.element.addEvents({focus:this.focus,blur:this.assert,keypress:this.keypress,keyup:this.assert,change:this.assert});window.addEvent("resize",this.reposition);this.reposition();return this},wrap:function(){if(this.options.element=="label"){if(!this.element.get("id")){this.element.set("id","input_"+String.uniqueID())}this.text.set("for",this.element.get("id"))}},startPolling:function(){this.pollingPaused=false;return this.poll()},poll:function(a){if(this.poller&&!a){return this}if(a){clearInterval(this.poller)}else{this.poller=(function(){if(!this.pollingPaused){this.assert(true)}}).periodical(this.options.pollInterval,this)}return this},stopPolling:function(){this.pollingPaused=true;return this.poll(true)
},focus:function(){this.text.setStyle("color","#dedede");return this},hide:function(c,a){if(this.text&&(this.text.isDisplayed()&&(!this.element.get("disabled")||a))){this.text.hide();this.fireEvent("textHide",[this.text,this.element]);this.pollingPaused=true;if(!c){try{this.element.fireEvent("focus");this.element.focus()}catch(b){}}}return this},show:function(){if(this.text&&!this.text.isDisplayed()){this.text.show();this.reposition();this.fireEvent("textShow",[this.text,this.element]);this.pollingPaused=false}return this},test:function(){return !this.element.get("value")},keypress:function(){return this["hide"](true)},assert:function(a){this.text.setStyle("color","#ddd");return this[this.test()?"show":"hide"](a)},reposition:function(){this.assert(true);if(!this.element.isVisible()){return this.stopPolling().hide()}if(this.text&&this.test()){this.text.position(Object.merge({position:"upperLeft",edge:"upperLeft",offset:{x:0,y:1}},{relativeTo:this.element}))}return this}});GewaOverText.instances=[];
Object.append(GewaOverText,{each:function(a){return GewaOverText.instances.each(function(c,b){if(c.element&&c.text){a.call(GewaOverText,c,b)}})},update:function(){return GewaOverText.each(function(a){return a.reposition()})},hideAll:function(){return GewaOverText.each(function(a){return a.hide(true,true)})},showAll:function(){return GewaOverText.each(function(a){return a.show()})}});gewa.util.textOver=function(b,a){try{if($$("input"+b+" ,textarea"+b).length>0){b=$$("input"+b+" ,textarea"+b)}else{return}b.each(function(f,e){var d=f.getPosition();if(f.hasProperty("alt")&&d.x>0&&d.y>0&&f.value==""){(function(){if(f.retrieve("label")==null){var g=new GewaOverText(f);f.store("label",g)}else{GewaOverText.update()}}).delay(500)}})}catch(c){}};gewa.util.fixIE=function(){if(Browser.ie&&9>parseInt(Browser.version,10)){var b=function(){1300>(document.documentElement.clientWidth||document.body.clientWidth)?document.body.addClass("wrap_mini"):document.body.removeClass("wrap_mini")};b()}};var activity={};function refreshActivityCaptcha(d,c){var b=gewara.util.httpsPath;var f=gewara.util.basePath;if(c){f=c.replace("https","http");b=c}if(!document.location.href.contains("gewara.com")){var a=f.indexOf("://");if(a>0){a+=3;f=f.substring(a,f.length);a=f.indexOf("/");f=f.substring(a,f.length)}var e=b.indexOf("://");if(e>0){e+=3;b=b.substring(e,b.length);e=b.indexOf("/");b=b.substring(e,b.length)}}if($(d+"Img")){$(d+"Img").setStyle("background","url("+gewara.util.cdnPath+"css/images/loading2.gif) center center no-repeat")}if($(d).value==""){gewara.util.sendRequest(f+"getCaptchaId.xhtml",{r:gewara.util.rtime()},function(g){if(g.success){$(d).value=g.retval;$(d+"Img").src=b+"captcha.xhtml?captchaId="+g.retval+"&r="+gewara.util.rtime()}else{alert("获取验证码出错，请重新获取！")}},"get")}else{$(d+"Img").src=b+"captcha.xhtml?captchaId="+$(d).value+"&r="+gewara.util.rtime()}$(d+"Input").value="";$(d+"Input").onfocus=null}activity.tab=new Class({Implements:[Events,Options],options:{switchType:".",switchCase:"switchCase",switchContent:"switchContent",switchTo:-1,switchDelay:300,switchSelect:"select",switchEvent:"click",preventDefault:false,switchCallback:$empty,switchTrigger:$empty},initialize:function(){var a=Array.link(arguments,{options:Object.type,element:$defined});
this.element=$(a.element)||document.body;this.setOptions(a.options||{});this.group={navs:null,contents:null};this.triggers=$$(this.options.switchType+this.options.switchCase);if(this.options.switchTo==-1){this.switchTo=0}else{this.switchTo=this.options.switchTo}this.isDelay=true;this.bindGroup();this.init();this.initTrigger()},init:function(){if(this.element.retrieve("tab")==null){if(this.group.contents.length){this.group.navs[this.switchTo].addClass(this.options.switchSelect);this.exCall($(this.group.navs[this.switchTo]))}this.attach();this.element.store("tab",this)}else{return null}},initTrigger:function(){this.activeTrigger=(this.triggers.filter(function(a){return a.hasClass("active")}))[0]},attach:function(){var a=this;this.group.navs.addEvent(this.options.switchEvent,function(b){if($defined(b)){b.preventDefault()}if(this.hasClass(a.options.switchSelect)){return}if(a.isDelay&&a.options.switchEvent=="click"){a.isDelay=false;a.switchSelection(this)}else{this.store("isDelay",true);(function(){if(this.retrieve("isDelay")==null){return
}a.switchSelection(this)}.bind(this)).delay(a.options.switchDelay)}}).addEvent("mouseleave",function(){this.store("isDelay",null)});this.options.switchCallback&&this.options.switchCallback.call(this)},exCall:function(a){var b=this;if(!a||!a.retrieve("target")){return}a.addClass("switchCasePass");a.retrieve("target").reveal({duration:150,onComplete:function(){if(a.hasClass("switchCasePass")){a.removeClass("switchCasePass");var c=a.retrieve("callback");if(c!=null){if(!c.singleRun){a.store("runback",null)}if(a.retrieve("runback")==null){c.callback.run(b);a.store("runback",true)}}b.isDelay=true}}})},detach:function(){this.group.navs.removeEvent(this.options.switchEvent,arguments.callee);return this},bindGroup:function(){this.group.navs=this.element.getElements(this.checkSwitch(this.options.switchCase));this.group.contents=this.element.getElements(this.checkSwitch(this.options.switchContent));for(var a=0;a<this.group.navs.length;a++){this.group.navs[a].store("target",this.group.contents[a])}},switchSelection:function(a){this.tempNode=this.group.navs.filter(function(b){return b.retrieve("target")!=null&&b.retrieve("target").getStyle("display")!="none"
});if(this.tempNode.length>0){this.tempNode.retrieve("target").dissolve({duration:150})}this.group.navs.removeClass(this.options.switchSelect);a.addClass(this.options.switchSelect);this.activeTrigger=a;this.exCall(a)},checkSwitch:function(a){return(".".test(this.options.switchType))?(this.options.switchType+a):(a+this.options.prototype)}});activity.create=new Class({Implements:[Options,Events],options:{edits:"*[even=save]",panel:"*[data-type=panel]",requestUrl:""},initialize:function(b,a){this.setOptions(a);this.element=document.id(b);this.boundEvent(this.element)},boundEvent:function(a){var b=this;a.getElements(this.options.edits).addEvent("click",function(c){c.preventDefault();b[this.get("even")].run({node:this,fun:b})})},save:function(c){var b={};var a=GewaraUtil.getValues(c.fun.element);b.jsonStr=JSON.encode(a);gewara.util.sendRequest(c.fun.options.requestUrl,a,function(d){if(d.success){gewaUtil.alert("创建活动成功，5秒后跳转到编辑页面！",function(){gotoURL(d.url)})}else{gewaUtil.alert(d.msg)}})}});
activity.edit=new Class({Implements:[Options,Events],options:{edits:[{even:"save",trigger:"click"},{even:"cancel",trigger:"click"},{even:"edit",trigger:"click"},{even:"price_easy",trigger:"blur"},{even:"price_setup",trigger:"click"},{even:"price_save",trigger:"click"},{even:"price_cancel",trigger:"click"},{even:"price_edit",trigger:"click"},{even:"price_del",trigger:"click"},{even:"price_limited",trigger:"click"},{even:"member_save",trigger:"blur"}],panel:"*[data-type=panel]",saveUrl:"",editorUrl:"",priceSaveUrl:"",priceDelUrl:"",objectId:""},initialize:function(b,a){this.setOptions(a);this.element=document.id(b);this.boundEvent(this.element)},boundEvent:function(a){var b=this;this.options.edits.each(function(c){a.getElements("*[even="+c.even+"]").removeEvents();a.addEvent(c.trigger+":relay(*[even="+c.even+"])",function(d){if(window.defaultAcDate){defaultAcDate()}b[this.get("even")].run({node:this,fun:b});return false})})},overText:function(){GewaOverText.update()},show:function(a){if(a){if(a.hasProperty("style")){a.removeProperty("style")
}else{a.show()}}},validate:function(b){var a=true;for(var c=0;c<b.length;c++){if(!$chk(b[c].get("value"))&&b[c].isDisplayed()){GewaraUtil.showValidateErr(b[c],b[c].get("alt"));a=false;break}}return a},save:function(b){b.fun.currPanel=b.node.getParent(b.fun.options.panel);b.fun.otherPanel=b.fun.currPanel.getSiblings(b.fun.options.panel);var a={};if(!b.fun.validate(b.fun.currPanel.getElements("input[type=text][validate]"))){return}a=GewaraUtil.getValues(b.fun.currPanel,",");a.activityId=b.fun.options.objectId;gewara.util.sendRequest(b.fun.options.editorUrl,a,function(c){if(c.success){if(a.mode=="addressMode"){setAddress(c.retval)}c.retval&&b.fun.otherPanel.getFirst().set("html",c.retval);if(b.node.getSiblings(".acCancel").length&&b.node.getSiblings(".acCancel")[0].hasProperty("even")){b.fun.cancel.run(b)}}else{gewaUtil.alert(c.msg)}})},edit:function(a){a.fun.currPanel=a.node.getParent(a.fun.options.panel);a.fun.otherPanel=a.fun.currPanel.getSiblings(a.fun.options.panel);a.fun.currPanel.hide();
a.fun.show(a.fun.otherPanel);GewaOverText.update()},cancel:function(a){a.fun.currPanel=a.node.getParent(a.fun.options.panel);a.fun.otherPanel=a.fun.currPanel.getSiblings(a.fun.options.panel);a.fun.currPanel.hide();a.fun.show(a.fun.otherPanel);GewaOverText.update()},member_save:function(a){a.fun.save(a)},price_easy:function(a){a.fun.save(a)},price_setup:function(a){$("ticketPrices").toggleClass("none")},price_save:function(b){b.fun.currPanel=b.node.getParent(b.fun.options.panel);var a={};if(!b.fun.validate(b.fun.currPanel.getElements("input[type=text]"))){return}a=GewaraUtil.getValues(b.fun.currPanel,",");a.activityId=b.fun.options.objectId;!a.isLimited&&(a.isLimited="",a.limitCount="");gewara.util.sendRequest(b.fun.options.priceSaveUrl,a,function(c){if(c.success){if(a.feeId){gewaUtil.alert("修改费用成功！",function(){$$("*[feeId="+a.feeId+"]").getParent().set("html",c.retval);b.fun.price_cancel.run(b)})}else{gewaUtil.alert("添加费用成功！",function(){new Element("tbody",{"class":"h55","data-type":"panel",html:c.retval}).inject(b.fun.element.getElement("thead"),"after");
b.fun.price_cancel.run(b)})}}else{gewaUtil.alert(c.msg)}})},price_edit:function(d){d.fun.currPanel=d.node.getParent(d.fun.options.panel);d.fun.lastPanel=d.fun.currPanel.getParent().getLast(d.fun.options.panel);var a=d.fun.lastPanel.getElements("input");for(var b=0;b<a.length;b++){var c=d.fun.currPanel.getElement("tr").get(a[b].get("name"));if(a[b].get("name")=="isLimited"){a[b].set("checked",!!c)}else{if(a[b].get("name")=="limitCount"){!!c?a[b].show():a[b].hide()}c&&a[b].set("value",c)}}GewaOverText.update()},price_cancel:function(a){a.fun.currPanel=a.node.getParent(a.fun.options.panel);a.fun.currPanel.getElements("input[type=text]").set("value","");a.fun.currPanel.getElements("input[name=feeId]").set("value","");a.fun.currPanel.getElements("input[type=checkbox]").each(function(b){b.get("checked")&&b.click()});GewaOverText.update()},price_del:function(b){var a=b.node.getParent(b.fun.options.panel);gewaUtil.confirm("确定要删除吗？",function(){gewara.util.sendRequest(b.fun.options.priceDelUrl,{activityId:b.fun.options.objectId,feeId:b.node.get("feeId")},function(c){if(c.success){gewaUtil.alert(c.retval||c.msg,function(){a.dispose();
GewaOverText.update()})}else{gewaUtil.alert(c.msg)}})})},price_limited:function(b){var a=$(b.node.get("for"))||b.node;if(a.get("checked")){$$("input[name=limitCount]").show()}else{$$("input[name=limitCount]").hide()}GewaOverText.update()},price_focus:function(){}});activity.selectBar=new Class({Implements:[Options,Events],parameter:{},options:{source:"",more:true,moreTrigger:".plugIn_tabs_more",moreContent:"plugIn_tabs_special",simulate:false,simulateSelect:".simulate_select",activeSelect:"selected",callback:$empty},initialize:function(a,b){if(!$(a)){return}else{this.container=$(a)}b&&this.setOptions(b);this.content=$(this.options.content);this.url=this.options.source;this.simulateData=$(this.options.simulateData);this.init()},init:function(){this.bindBar()},getParameter:function(){this.parameter=GewaraUtil.getValues(this.container);return this.parameter},setFocus:function(a){if(!a){return}a.getParent("label").getSiblings().removeClass(this.options.activeSelect);a.getParent("label").addClass(this.options.activeSelect)
},clearValues:function(){var a=this;a.container.getElements('input[type="radio"][name!="hasLogo"]').each(function(b){b.set("checked",false);b.getParent("label").removeClass(a.options.activeSelect)});a.container.getElements("input[type=checkbox]").set("checked",false);a.container.getElements("select").set("value","")},clearValue:function(a){var c='input[name=="'+a+'"]';var b=this;b.container.getElements(c).each(function(d){d.set("checked",false);d.getParent("label").removeClass(b.options.activeSelect)})},bindBar:function(){var a=this;a.container.getElements("input[name]").addEvent("click",function(){a.setFocus(this);if(this.get("name")=="hasLogo"){a.doAllParameter()}else{a.clearValue("hasLogo");a.doParameter()}});a.container.getElements("select").addEvent("change",function(){a.doParameter()});if(a.options.more){a.more=new Fx.Reveal($(a.options.moreContent),{duration:150});if(a.more){$$(a.options.moreTrigger).addEvent("click",function(){a.more.toggle()})}}if(a.options.simulate){var a=this;
this.simulateSelect=$$(this.options.simulateSelect);this.simulateSelect.each(function(b){b.addEvent("click",function(){b.getNext().toggle()});b.getParent().addEvent("mouseleave",function(){b.getNext().hide()});b.getNext().addEvent("click:relay(a)",function(){if(b.getElement(".simulate_value").get("value")!=this.get("data")){b.getElement(".select_value").set("html",this.get("html"));b.getElement(".simulate_value").set("value",this.get("data"));a.doParameter();b.getNext().hide()}})})}},doParameter:function(){values=this.getParameter();values.hasLogo=false;values.keyWord="";if($("keyWord")){$("keyWord").value=""}this.options.callback&&this.options.callback.call(this,values)},doAllParameter:function(){values=this.parameter;Object.each(values,function(b,a,d){if(a!="tag"){if(values[a]!="special"){values[a]=""}}});values.hasLogo=false;values.sign="";values.keyWord="";if($("keyWord")){$("keyWord").value=""}this.options.callback&&this.options.callback.call(this,values)}});activity.applyManage=new Class({Implements:[Options,Events],searchBar:"searchBar",sxForm:"sxForm",options:{table:"applyManage_tbl",buttons:{stopBtn:"stopBtn",downloadBtn:"downloadBtn",notifyBtn:"notifyBtn"},urls:{search:"",del:"",send:"",stop:""},callback:$empty,captcha:"activityCaptcha",httpsPath:"/activtiy/"},initialize:function(a){a&&this.setOptions(a);
this.table=$(this.options.table);if(!this.table){return}this.stopBtn=$(this.options.buttons.stopBtn);this.downloadBtn=$(this.options.buttons.downloadBtn);this.notifyBtn=$(this.options.buttons.notifyBtn);this.searchBar=$(this.searchBar);this.sxForm=$(this.sxForm);this.bindEvent();if(this.options.urls.search){this.doSearch(this.options.urls.search,this.table.getProperties("activityId","isFee"))}},bindEvent:function(){this.stopBtn&&this.eventStop();this.downloadBtn&&this.eventDownload();this.notifyBtn&&this.eventNotify();this.searchBar&&this.eventSearch();this.eventDelete();this.eventSend()},eventStop:function(){var a=this;a.stopBtn.addEvent("click",function(){gewara.util.sendRequest(a.options.urls.stop,{activityId:a.table.get("activityId")},function(b){if(b.success){gewaUtil.alert("修改报名状态成功！");a.stopBtn.getFirst().set("text",b.retval)}else{gewaUtil.alert(b.retval)}})})},eventDownload:function(){},eventNotify:function(){var a=this;a.nicknames=[];a.checkboxLength=0;a.table.addEvent("click:relay(thead a)",function(){var b=a.table.getElements("tbody tr td:last-child input[type=checkbox]");
if(b.get("checked").contains(false)){b.set("checked",true)}else{b.set("checked",false)}a.updateCheckbox()});a.table.addEvent("click:relay(tbody input[type=checkbox])",function(){a.updateCheckbox()});a.table.addEvent("click:relay(tbody a.iNote)",function(){a.nicknames=[];a.nicknames.push(this.getParent("tr").get("nickname"));a.memberidList=[];a.memberidList.push(this.getParent("tr").get("memberid"));a.pushMaillist(a.nicknames,a.memberidList)});a.notifyBtn.addEvent("click",function(){a.nicknames=[];a.checkboxChecked.each(function(c,b){a.nicknames.push(c.getParent("tr").get("nickname"))});a.memberidList=[];a.checkboxChecked.each(function(c,b){a.memberidList.push(c.getParent("tr").get("memberid"))});a.pushMaillist(a.nicknames,a.memberidList)})},updateCheckbox:function(){var a=this;a.checkbox=a.table.getElements("tbody tr td:last-child input[type=checkbox]");a.checkboxChecked=a.table.getElements("tbody tr td:last-child input[type=checkbox]:checked");a.checkboxUnChecked=a.checkbox;a.checkboxChecked.each(function(c,b){a.checkboxUnChecked.erase(c)
});if(a.checkboxChecked.length>=10){a.checkboxUnChecked.set("disabled",true)}else{a.checkboxUnChecked.set("disabled",false)}},pushMaillist:function(){var a=this;if($("messageDiv").hasClass("none")){$("messageDiv").removeClass("none")}new Fx.Scroll(window).toElement("messageDiv");a.nicknames=a.nicknames.unique();a.memberidList=a.memberidList.unique();if(a.sxForm&&a.nicknames.length&&a.memberidList.length&&a.sxForm.getElement('input[name="memberidList"]')&&a.sxForm.getElement('input[name="userKey"]')){a.sxForm.getElement('input[name="memberidList"]').set("value",a.memberidList.join(","));a.sxForm.getElement('input[name="userKey"]').set("value",a.nicknames.join(","));a.sxForm.getElement('input[name="subject"]').focus()}},eventDelete:function(){var a=this;a.table.addEvent("click:relay(tbody a.iDet)",function(){var b=this.getParent("tr");gewa.util.confirm("确定要删除吗？",function(){gewara.util.sendRequest(a.options.urls.del,{applyJoinId:b.get("applyJoinId")},function(){a.deleteRow(b);a.styleZebra();
a.updateCheckbox()})})})},eventSearch:function(){var a=this;a.searchBar.getFirst(".button").addEvent("click",function(){a.searchBar.data={};Object.merge(a.searchBar.data,a.table.getProperties("activityId","isFee"));a.searchBar.getElements("input,select").each(function(c,b){Object.merge(a.searchBar.data,JSON.decode('{"'+c.get("name")+'":"'+c.get("value")+'"}'))});a.doSearch(a.options.urls.search,a.searchBar.data)});a.table.addEvent("click:relay(tfoot a)",function(b,c){b.preventDefault();a.doSearch(this.get("href"),{})})},doSearch:function(b,c){var a=this;gewara.util.sendRequest(b,c,function(d){if(d.success){a.table.set("html",d.retval);a.styleZebra();a.updateCheckbox();if(a.options.callback){a.options.callback.apply(a)}}})},eventSend:function(){var a=this;var g=a.sxForm.getElement('input[name="memberidList"]');var d=a.sxForm.getElement('input[name="subject"]');var f=a.sxForm.getElement('textarea[name="content"]');var e=a.sxForm.getElement('input[name="captchaId"]');var b=a.sxForm.getElement('input[name="captcha"]');
var c=a.sxForm.getElement(".button");c.addEvent("click",function(){if(!$chk(d.get("value"))){GewaraUtil.showValidateErr("subject","标题不能为空！");return}if(!$chk(f.get("value"))){GewaraUtil.showValidateErr("content","通知内容不能为空！");return}gewara.util.sendRequest(a.options.urls.send,{memberidList:g.get("value"),subject:d.get("value"),content:f.get("value"),captchaId:e.get("value"),captcha:b.get("value")},function(h){if(h.success){gewaUtil.alert(h.retval||"发送成功！",function(){$("messageDiv").addClass("none")})}else{refreshActivityCaptcha(a.options.captcha,a.options.httpsPath);gewaUtil.alert(h.msg)}})})},styleZebra:function(){var a=this;a.table.getElements("tbody tr:even").addClass("zebra");a.table.getElements("tbody tr:odd").removeClass("zebra")},deleteRow:function(a){a&&a.dispose()}});activity.even=new Class({Implements:[Options,Events],options:{container:"",events:[{name:"",url:"",event:""}],objectId:""},initialize:function(a){this.setOptions(a);this.bindEvent();this.container=$(this.options.container)||document.body
},bindEvent:function(){var a=this;a.options.events.each(function(b){a.el=$$("*[even="+b.name+"]");if(a.el.length>0){a.el.store("name",b.name);b.url&&a.el.store("cleanUrl",b.url);b.url&&a.el.store("url",b.url+"?activityId="+a.options.objectId);a.el.store("event",b.event);a.el.each(function(c){c.addEvent(c.retrieve("event"),function(){var d=this;checkLogin(true,function(){a[d.get("even")]&&a[d.get("even")].call(this,d,a)})})})}})},createAc:function(b,a){gewa.util.maskContent("",a.options.container,"发起新活动",582,a.options.container,"","","",false,"",function(){gewa.util.textOver(".acText,.dateTips");GewaOverText.update()},true)},saveAc:function(e,b){var c=e.retrieve("url");var d={};var a=GewaraUtil.getValues(b.container);d.jsonStr=JSON.encode(a);gewara.util.sendRequest(c,a,function(f){if(f.success){gotoURL(f.url)}else{if(f.msg=="unbindmobile"){gewa.util.confirm("发起活动需要绑定手机验证，请先绑定手机！",function(){GewaraUtil.openwin("http://www.gewara.com/home/acct/bindMobile.xhtml","_blank")})}else{var g=f.msg;
if(g=="1"){gewaUtil.alert("您的发表体验机会已用完，完善账户信息就可以使用哇啦、站内信、活动、知道、论坛的所有功能啦！",function(){gotoURL("http://www.gewara.com/home/acct/safetyCenter.xhtml")})}else{if(g=="7"){gewaUtil.alert("您的发表体验机会已用完，确认您的邮件地址就可以使用哇啦、站内信、活动、知道、论坛的所有功能啦！",function(){gotoURL("http://www.gewara.com/home/acct/safetyCenter.xhtml")})}else{if(g=="0"){gewaUtil.alert("非法请求！")}else{if(g=="51"){gewaUtil.alert("操作过于频繁！")}}}}if(g=="1"||g=="7"||g=="0"||g=="51"){return}gewaUtil.alert(g)}}})},copyAc:function(c,a){var b=c.retrieve("url");gewa.util.issure("","copyAcAlert","",490,"copyConfirm",function(){gewa.util.container.copyConfirm.dispose("copyConfirm");gewara.util.sendRequest(b,"",function(d){if(d.success){gotoURL(d.url)}else{gewaUtil.alert(d.msg)}})})},deleteAc:function(c,a){var b=c.retrieve("url");gewaUtil.confirm("确定要删除吗？",function(){gewara.util.sendRequest(b,"",function(d){if(d.success){gotoURL(d.url)}else{gewaUtil.alert(d.msg)}})})},publishAc:function(f,a){var c=f.retrieve("cleanUrl");var b={};b.jsonStr={};var e=document.getElements("*[data-type=savedata]");
var d={};document.getElements("*[data-type=price]").each(function(h,g){d[g]=JSON.encode(GewaraUtil.getValues(h))});e.each(function(i,g){if(i.name=="activityId"){b[i.get("name")]=i.get("value")}else{if(i.type=="radio"){if(i.checked){b.jsonStr[i.get("name")]=i.get("value")}}else{if(i.type=="checkbox"){if(i.checked){var j=b.jsonStr[i.get("name")];if(j){j=new Array(j).flatten();j.push(i.get("value"));j=j.toString();b.jsonStr[i.get("name")]=j}else{b.jsonStr[i.get("name")]=i.get("value")}}}else{var h="";if(i.match("textArea")){h=editor.html();h=h.replace("loading.gif","failed.png")}b.jsonStr[i.get("name")]=(h)?h:i.get("value")}}}});b.allFee=JSON.encode(d);b.jsonStr=JSON.encode(b.jsonStr);gewara.util.sendRequest(c,b,function(g){if(g.success){if(g.retval.contains("http")){gotoURL(g.retval)}else{gotoURL(GewaraUtil.basePath+g.retval)}}else{gewaUtil.alert(g.msg)}})},previewAc:function(f,a){var c=f.retrieve("cleanUrl");var b={};b.jsonStr={};var e=document.getElements("*[data-type=savedata]");var d={};
document.getElements("*[data-type=price]").each(function(h,g){d[g]=JSON.encode(GewaraUtil.getValues(h))});e.each(function(i,g){if(i.name=="activityId"){b[i.get("name")]=i.get("value")}else{if(i.type=="radio"){if(i.checked){b.jsonStr[i.get("name")]=i.get("value")}}else{var h="";if(i.match("textArea")){h=editor.html();h=h.replace("loading.gif","failed.png")}b.jsonStr[i.get("name")]=(h)?h:i.get("value")}}});b.allFee=JSON.encode(d);b.jsonStr=JSON.encode(b.jsonStr);gewara.util.sendRequest(c,b,function(g){if(g.success){if(g.retval.contains("http")){gotoURL(g.retval)}else{gotoURL(GewaraUtil.basePath+g.retval)}}else{gewaUtil.alert(g.msg)}})},joinAc:function(c,a){var b=c.retrieve("url");if(a.toggle){return}a.toggle=true;if($("joinDialog")){gewa.util.issure("","joinDialog","活动报名",420,"keys",function(){if(!GewaraUtil.baseValidForm("joinDialog")){return false}gewa.util.container.keys.dispose("keys");var e=GewaraUtil.getValues("joinDialog");var g=$("joinJsonData").getElements("input[type=text]");var f="{";
g.each(function(i,h){if(i.get("value")!=""){f+='"'+i.get("lang")+'":"'+i.get("value")+'",'}});f+="}";var d=JSON.decode(f);e.jsonString=JSON.encode(d);gewara.util.sendRequest(b,e,function(h){a.toggle=false;if(h.success){var i=a.getShareHtml();gewa.util.maskContent("",i,"报名提醒",560,"keyss","","","",true,function(){refreshPage()},function(){if($("superShare")){$("bdshare").inject("superShare");$("bdshare").removeProperty("style")}})}else{gewaUtil.alert(h.msg)}})},"填写好了，确认",function(){a.toggle=false})}else{gewara.util.sendRequest(b,"",function(d){a.toggle=false;if(d.success){var e=a.getShareHtml();gewa.util.maskContent("",e,"报名提醒",560,"keys","","","",true,function(){refreshPage()},function(){if($("superShare")){$("bdshare").inject("superShare");$("bdshare").removeProperty("style")}})}else{gewaUtil.alert(d.msg)}})}},getShareHtml:function(){var a='<div style="width:80%;margin:0 auto;height:100px;overflow:hidden;line-height:100px;font-size:28px;font-weight:bold;margin-top:10px;"><img height="100" style="float:left;" src="http://img5.gewara.com/css/home/register_succ.png">恭喜，已报名成功！</div>';
if(_bd_share_config&&_bd_share_config.common.bdText){a+='<div style="width: 80%; margin: 10px auto 0;"><div style="font-size: 16px; padding: 0px 0px 20px; line-height: 23px;"><div style="height:auto;background:#f9f9f9;border:1px solid #bbb;padding:15px;outline:none;" id="editShareDesc">'+_bd_share_config.common.bdText+'</div><div style="margin-top:10px;">把内容分享到：</div>';a+='<div class="superShare" id="superShare" style="margin-top:5px;"></div></div></div>'}return a},quitAc:function(c,a){var b=c.retrieve("url");gewara.util.sendRequest(b,"",function(d){if(d.success){refreshPage()}else{gewaUtil.alert(d.msg)}})},remindAc:function(c,a){var b=c.retrieve("url");gewara.util.sendRequest(b,"",function(d){if(d.success){$("agendaid").value=d.agendaid;gewa.util.issure("","agenda","设置短信提醒",310,"agenda",function(){if($("agendamobile").value!=""){values={agendaid:$("agendaid").value,sendtime:$("sendtime").value,mobile:$("agendamobile").value};gewara.util.sendRequest("/exchange/subject/saveAgenda.xhtml",values,function(e){if(e.success){gewaUtil.container.agenda.dispose("agenda");
gewaUtil.alert("提交成功！你可以在<a href='/home/sns/myLifePlans.xhtml' target='_blank' class='brown'>生活安排</a>查看或修改内容。","","",310)}else{gewaUtil.alert(e.msg,"","",310)}})}else{gewaUtil.alert("请填写短信通知的手机号码！","","",310);return false}})}else{if(d.errorMap){gewaUtil.alert('你已设置提醒，请到<a href="/home/sns/myLifePlans.xhtml" target="_blank">生活安排</a>中查看或修改内容。',"","",330)}else{gewaUtil.alert(d.msg,"","",310)}}})},spreadAc:function(d,b){var c=d.retrieve("url");var a=GewaraUtil.getValues("isWb_content");var e=$("Wb");if(e){if(e.get("checked")){gewara.util.sendRequest(c,a,function(f){if(f.success){gewaUtil.alert("发布到微博成功！")}else{gewaUtil.alert(f.msg)}})}else{gewaUtil.alert("请先绑定微博！",function(){e.focus()})}}else{gewara.util.sendRequest(c,a,function(f){if(f.success){gewaUtil.alert("邀请成功！")}else{gewaUtil.alert(f.msg)}})}}});activity.countDown=new Class({Implements:[Options,Events],options:{activityId:"",url:"",timer:"timerAc",joinType:"joinType"},initialize:function(a){this.setOptions(a);this.timer=this.options.timer;
this.joinType=this.options.joinType;this.activityId=this.options.activityId;this.url=this.options.url;this.getTime()},getTime:function(){var a=this;gewara.util.sendRequest(a.url,{activityId:a.activityId},function(b){if(b.success){a.remain=b.retval*1;if(a.remain<=0){$(a.timer)&&$(a.timer).dispose();$(a.joinType)&&$(a.joinType).show()}else{$(a.timer)&&$(a.timer).show();$(a.joinType)&&$(a.joinType).hide();a.pfun=a.setTime.periodical(1000,{countDown:a})}}else{}})},setTime:function(){var a=this.countDown;var e=Math.floor(a.remain/(1000*60*60*24))%30;var c=Math.floor(a.remain/(1000*60*60))%24;var d=Math.floor(a.remain/(1000*60))%60;var b=Math.floor(a.remain/1000)%60;if(c>0){if($("RemainD")){$("RemainD").removeClass("none")}if($("panelH")){$("panelH").show()}if($("panelM")){$("panelM").hide()}}else{if($("panelH")){$("panelH").hide()}if($("panelM")){$("panelM").show()}}$("RemainD").innerHTML=(e<10?"0":"")+e;$("RemainH").innerHTML=(c<10?"0":"")+c;$("RemainM").innerHTML=(d<10?"0":"")+d;$("RemainS").innerHTML=(b<10?"0":"")+b;
a.remain-=1000;if(((a.remain/1000).toInt()*1000)%60000==0){$clear(a.pfun);a.getTime&&a.getTime.call(a)}if(a.remain<0){$clear(a.pfun);return}}});activity.layout=new Class({Implements:[Options,Events],options:{bindFixed:[],menus:{},toggle:"sideTags"},fixedT:null,catchFixed:{},menu:null,menuMaxTop:67,menuFx:null,toggleCatch:false,autoToggle:false,loading:[],initialize:function(a){this.setOptions(a);window.addEvents({scroll:function(){}.bind(this),resize:function(){this.resize()}.bind(this)});this.resize();this.createMenu()},createMenu:function(){this.menu=$$(".superMore");if(this.menu.length==0){return}this.menu=this.menu[0];this.menu.getElement("em").addEvent("click",function(){if(!this.menu.retrieve("key")){this.toggleMenu();this.menu.store("key",true)}else{this.doToggleMenu()}}.bind(this)).inject(this.menu);document.addEvent("click",function(b){var a=$(b.target);if(a!=this.menu&&!this.menu.contains(a)){this.doToggleMenu(true)}}.bind(this))},toggleMenu:function(){if(!this.options.menus){return
}this.meunToggleFlag=true;this.menuUl=new Element("ul").inject(this.menu);this.menuFx=new Fx.Morph(this.menuUl,{duration:400,onComplete:function(){this.meunToggleFlag=!this.meunToggleFlag}.bind(this)});var a=Object.values(this.options.menus);Object.keys(this.options.menus).each(function(f,c){if(f=="handle"){new Element("li",{html:a[c],"class":"headle"}).addEvent("click",function(){this.doToggleMenu()}.bind(this)).inject(this.menuUl)}else{if(f=="typeMenu"){var d=Object.values(a[c]),e=new Element("li",{"class":"typeMenu clear"}).inject(this.menuUl);Object.keys(a[c]).each(function(h,j){new Element("a",{href:h,html:d[j]}).inject(e)})}else{if(f=="spreadMenu"){var g=Object.values(a[c]),b=new Element("li",{"class":"spreadMenu clear"}).inject(this.menuUl);Object.keys(a[c]).each(function(h,j){new Element("a",{href:h,html:g[j]}).inject(b)})}else{if(f=="selector"){this.menuUl.getElement("a:contains("+a[c]+")").addClass("select")}else{new Element("a",{href:f,title:a[c],html:a[c]}).inject(new Element("li").inject(this.menuUl))
}}}}}.bind(this));this.menuH=this.menuUl.getDimensions().y-2;this.doToggleMenu()},doToggleMenu:function(a){if(this.meunToggleFlag&&!a){this.menuFx.start({opacity:[0,1],width:[0,200],height:[0,this.menuH]})}else{if(!this.menuFx||this.menuFx&&this.menuFx.element.getDimensions().height<50){return}this.menuFx.start({opacity:[1,0],width:[200,0],height:[this.menuH,0]})}},resize:function(){this.scrollX=window.getScroll().x;if(document.getWidth()<1024){if(this.fixedT){this.fixedT.setStyles({width:1024,left:-this.scrollX});this.fixedT.getElements(".superInnerPlugs").addClass("superChangePlugs")}if(Browser.ie){$("_body").addClass("superLayout_ie")}}else{if(this.fixedT){this.fixedT.setStyles({width:"100%",left:0});this.fixedT.getElements(".superInnerPlugs").removeClass("superChangePlugs")}if(Browser.ie){$("_body").removeClass("superLayout_ie")}}},scroll:function(){if(Browser.ie6){return}this.initHtml();this.scrollY=window.getScroll().y;if(this.fixedT&&$("footPlace")&&this.scrollY>=$("footPlace").getPosition().y-this.fixedT.getDimensions().height){this.fixedT.setStyle("top",$("footPlace").getPosition().y-this.fixedT.getDimensions().height-this.scrollY);
return}else{this.fixedT.setStyle("top",0)}this.options.bindFixed.each(function(a){if(this.scrollY>Object.values(a)[0].getPosition().y-90){if(this.catchFixed[Object.keys(a)[0]]){return}this[Object.keys(a)[0]]("big",Object.values(a)[0]);this.catchFixed[Object.keys(a)[0]]=true}else{if(!this.catchFixed[Object.keys(a)[0]]){return}this[Object.keys(a)[0]]("min",Object.values(a)[0]);this.catchFixed[Object.keys(a)[0]]=null}}.bind(this));if(this.scrollY>this.getBottomY()-80){this.fixedT.setStyle("top",this.getBottomY()-this.scrollY-80)}this.resize()},titleCallback:function(b,a){if(b=="big"){if(this.fixedT){this.fixedT.show();this.fixedT.store("title",$("superTitle").getParent());this.fixedTitleParent=$("superTitle").getParent()}if(!this.fixedT.getElement("superTitle")){if(this.fixedTitleParent){this.fixedTitleParent.setStyle("padding-top",$("superTitle").getDimensions().height)}$("superTitle").inject(this.fixedT.getElement("dl[data-type=inside]"))}}else{if(this.fixedT){if(this.fixedTitleParent){this.fixedTitleParent.setStyle("padding-top",0)
}$("superTitle").inject(this.fixedT.retrieve("title"));this.fixedT.hide()}}},walaCallback:function(b,a){if(!this.fixedT||!$("walaBt")){return}if($("wala_listing_content")){if(b=="big"){if(!this.fixedT.retrieve("walaText")){this.fixedT.store("walaTitle",$("walaBt").getParent())}$("walaBt").inject(this.fixedT.getElement("div[data-type=wala]"));this.fixedT.store("walaText",$("wala_listing_content").getParent());$("wala_listing_content").inject(this.fixedT.getElement("div[data-type=wala]"))}else{$("walaBt").inject(this.fixedT.retrieve("walaTitle"),"top");$("wala_listing_content").inject(this.fixedT.retrieve("walaText"),"top")}}},footerCallback:function(b,a){if(!this.fixedT||!$("walaBt")){return}if(a){this.loading=$$(".ui_loading");if(this.loading.length>0){if(!this.footer){this.footer=$("footerContaner")}if(this.loading[this.loading.length-1].getPosition().y<this.footer.getPosition().y){return}this.floor=document.getElement("div[data-id=footerCallback]");if(!this.footer&&!this.floor){return
}if(b=="big"){this.floor.inject(new Element("dd").inject(this.fixedT.getElement("dl[data-type=inside]"),"bottom"))}else{this.floor.inject("generalSuperPanel","bottom")}}else{return}}},initHtml:function(){if(this.fixedT){return}this.fixedT=new Element("div",{"class":"superTitle_fixed",html:'<div class="sf_inner clear"><div class="sf_left"><dl class="superTop_fixed clear" data-type="inside"></dl></div><div class="superWalaFixed" id="superWalaFixed"><div class="superWalaFixedInner"><div class="ui_wala ui_wala_isRightWala" data-type="wala"></div></div></div></div>'}).inject(document.body)},getBottomY:function(){return $("superFooter").getPosition().y}});(function(i,f,c){var q={Implements:[Options,Events],options:{step:30,scrollerHtml:'<span class="decrease"></span><div class="scroll"><div class="handle"><div class="handleL"><div class="handleR"><div class="handleC"></div></div></div></div></div><span class="increase"></span>',mode:"vertical",rtl:false,laze:false,margins:0,wrapped:null,callback:$empty,hasWheel:true,flag:false},element:null,scroller:null,scrollSize:0,areaSize:0,position:0,slider:null,events:null,generated:false,attached:false,isAttached:true,axis:"y",dir:"top",property:"height",initialize:function b(w,v){this.setOptions(v);this.element=f(w);this.axis=(this.options.mode=="vertical")?"y":"x";this.dir=(this.options.mode=="vertical")?"top":this.options.rtl?"right":"left";this.property=(this.options.mode=="vertical")?"height":"width";this.constrcut();this.attach();if(this.options.flag){var u=f(this.options.wrapped).getDimensions().x-this.element.getDimensions().x,t=0;var y=function(){if(t<=u*2-10){this.slider.set(t);t++}else{$clear(s)
}}.bind(this);var s=y.periodical(40);this.element.addEvent("mouseenter",function(){$clear(s)})}if(this.options.laze&&this.isAttached){this.lazeObject()}},constrcut:function n(){var v=this;this.scroller={};var s=this.scroller.element=new Element("div",{"class":"scroller",html:this.options.scrollerHtml}).addClass(this.options.mode),u,v=this,t;this.scroller.inc=s.getElement(".decrease");this.scroller.dec=s.getElement(".increase");this.scroller.scroll=s.getElement(".scroll");this.scroller.handle=s.getElement(".handle");this.scrolled=(this.options.wrapped)?f(this.options.wrapped):(function(){var w=v.element.get("html");v.element.empty();return new Element("div",{html:w,"class":"wrapped"}).inject(v.element)}());this.element.setStyle("overflow","hidden");this.element.adopt(s);if(this.axis=="y"){this.scroller.scroll.setStyle("height",this.element.getDimensions()[this.axis]-this.element.getElement(".increase").getDimensions()[this.axis]*2)}if(this.axis=="x"){this.scroller.scroll.setStyle("width",this.element.getDimensions()[this.axis]-this.element.getElement(".increase").getDimensions()[this.axis]*2)
}this.areaSize=this.element.getDimensions()[this.axis];this.scrollSize=this.scrolled.getDimensions()[this.axis];u=this.areaSize/this.scrollSize;t=+this.scroller.scroll.getDimensions()[this.axis]*u-2;this.scroller.handle.setStyle(this.property,t.toInt());if(this.slider==null){this.slider=new Slider(this.scroller.scroll,this.scroller.handle,{mode:this.options.mode,range:[0,this.scrollSize-this.areaSize]})}else{this.isAttach()}this.generated=true},resizeScroll:function(){var t,u=this,s;this.scrolled=f(this.options.wrapped);this.element.setStyle("overflow","hidden");this.scrolled.removeProperties("style");this.scrolled.setStyle("overflow","scroll");this.scrollSize=this.scrolled.getScrollSize()[this.axis];this.scrolled.setStyle("overflow","hidden");var v=this.position;this.areaSize=this.element.getDimensions()[this.axis];t=this.areaSize/this.scrollSize;s=this.areaSize*t-2;this.scroller.handle.setStyle(this.property,s.toInt());this.scrolled.setStyle(this.property,this.scrollSize);this.slider.setRange([0,this.scrollSize-this.areaSize]);
this.slider.autosize();this.slider.set(v)},attach:function o(){var v=this;if(this.attached){return}if(!this.generated){this.generate()}this.events={scrollUp:function t(){v.scorllSize=v.position-v.options.step;v.slider.set(v.scorllSize)},scrollDown:function s(){v.scorllSize=v.position+v.options.step;v.slider.set(v.scorllSize)},manageWheel:function u(w){w.preventDefault();if(w.wheel>0){v.events.scrollUp()}else{v.events.scrollDown()}}.bind(this)};if(this.options.hasWheel){this.element.addEvent("mousewheel",this.events.manageWheel)}this.scroller.inc.addEvent("click",this.events.scrollUp);this.scroller.dec.addEvent("click",this.events.scrollDown);this.slider.addEvent("change",function(w){v.options.callback.delay(60,this,[w]);if(w<v.position){v.decrease(v.position-w)}else{v.increase(w-v.position)}if(v.options.laze){v.lazeObject()}});this.attached=true;this.isAttach()},isAttach:function g(){if(this.scrollSize-this.areaSize>0){if(!this.element.hasEvent("mousewheel")&&this.options.hasWheel){this.element.addEvent("mousewheel",this.events.manageWheel)
}this.scroller.element.fade(1);this.slider.setRange([0,this.scrollSize-this.areaSize])}else{this.element.removeEvents("mousewheel");this.scroller.element.fade(0)}this.slider.autosize();this.slider.set(0)},detach:function r(){this.element.removeEvent("mousewheel",this.events.manageWheel);this.slider.detach();this.scroller.each(function(s){s.destroy()});this.generated=false;this.attached=false},increase:function k(s){s=s||this.options.step;if(this.position+s>this.scrollSize-this.areaSize){this.position=this.scrollSize-this.areaSize}else{this.position+=s}this.scrolled.setStyle("margin-"+this.dir,-1*this.position);this.fireEvent("increase",[this.position])},decrease:function a(s){s=s||this.options.step;if(this.position-s<0){this.position=0}else{this.position-=s}this.scrolled.setStyle("margin-"+this.dir,-1*this.position);this.fireEvent("decrease",[this.position])},toElement:function j(){return this.element},lazeObject:function d(){if(this.scrolled.getChildren().length>0){this.scrolled.getChildren().each(function(t,s){if(t.getDimensions()[this.axis]*(s+1)-(this.areaSize+(this.isAttached?0:this.position))<=t.getDimensions()[this.axis]){this.showLaze(t)
}}.bind(this))}this.isAttached=false},showLaze:function m(s){this.recursionLaze(s);s.morph("opacity",1)},recursionLaze:function h(s){if(s.getChildren().length>0){s.getChildren().each(function(t){this.recursionLaze(t)}.bind(this))}else{if(s.hasProperty("lazeSrc")){Asset.image(s.get("lazeSrc"),{onLoad:function(){s.setStyle("background","#eee url("+this.get("src")+") center center no-repeat");s.removeProperty("lazeSrc");this.dispose()}})}}},getSub:function p(){return this.scrollSize-this.areaSize},setStyle:function e(s,t){return this.scrolled.getChildren().each(function(v,u){if(s==0&&u==0){return t(v)}if(s==u){return t(v)}}.bind(this))}},l=this.ScrollerBar=new Class(q)}).apply(this,[this,document.id]);(function(h,e){var b=new Date(),l=[b.getFullYear(),b.getMonth(),b.getDate()].join("-"),f=new Date(b.getFullYear(),b.getMonth(),b.getDate()),k=h.document;function c(d){this.version="1.5";this.isOpen=false;this.focus=false;this.id=null;this.container=null;this.element=null;this.selectedDate=null;this.opts={year:new Date().getFullYear(),month:new Date().getMonth(),dayNames:["日","一","二","三","四","五","六"],dayNamesFull:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesFull:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],startDay:0,weekNumbers:false,selectOtherMonths:false,showOtherMonths:true,showNavigation:true,hasTimeSelector:false,months:1,rel:null,inline:false,disablePast:false,dateFormat:"Y-m-d",position:"bottom",offerset:{x:0,y:0},minDate:null,maxDate:null,selectorTime:false,onBeforeOpen:function(){},onBeforeClose:function(){},onOpen:function(){},onClose:function(){},onSelect:function(){},onBeforeShowDay:function(){return[true,""]
}};for(var o in d){if(d.hasOwnProperty(o)){this.opts[o]=d[o]}}this.init.call(this)}c.Util={addClass:function(o,d){if(o&&!this.hasClass(o,d)){o.className+=o.className.length>0?" "+d:d}},hasClass:function(o,d){if(o&&typeof o.className!="undefined"&&typeof o.nodeType!="undefined"&&o.nodeType===1){return o.className.match(new RegExp("(\\s|^)"+d+"(\\s|$)"))}return false},removeClass:function(p,d){if(this.hasClass(p,d)){var o=new RegExp("(\\s|^)"+d+"(\\s|$)");p.className=p.className.replace(o," ")}},addEvent:function(p,o,d){$(p).addEvent(o,d)},getElementsByClass:function(s,o,v){var u=[];if(o===null){o=k}if(v===null){v="*"}var q=o.getElementsByTagName(v);var d=q.length;var t=new RegExp("(^|\\s)"+s+"(\\s|$)");for(var r=0,p=0;r<d;r++){if(t.test(q[r].className)){u[p]=q[r];p++}}return u},getEventTarget:function(o){var d;if(!o){o=h.event}if(o.target){d=o.target}else{if(o.srcElement){d=o.srcElement}}if(d.nodeType==3){d=d.parentNode}return d}};function m(o){var p,d,q=o?8:7,r=k.createElement("tr");for(p=0;
p<q;p++){d=k.createElement("td");c.Util.addClass(d,"bcal-empty");r.appendChild(d)}return r}function j(o){var p=0,d=0;if(o.offsetParent){do{p+=o.offsetLeft;d+=o.offsetTop}while(o=o.offsetParent);return[p,d]}}function a(o,d){if(o>0&&o<d-1){return 0}else{if(o>0&&o===d-1){return 2}else{if(o===0&&o===d-1){return 3}else{if(o===0&&o<d-1){return 1}}}}}function n(u,p){function t(v){return(v+"").length===2?v:"0"+v}var q,d,s,o=[],r=new Date(p);for(q=0,d=u.length;q<d;q++){s=u.charAt(q);switch(s){case"Y":o.push(r.getFullYear());break;case"y":o.push((r.getFullYear()+"").slice(-2));break;case"m":o.push(t(r.getMonth()+1));break;case"n":o.push(r.getMonth()+1);break;case"F":o.push(this.opts.monthNamesFull[r.getMonth()]);break;case"M":o.push(this.opts.monthNames[r.getMonth()]);break;case"d":o.push(t(r.getDate()));break;case"j":o.push(r.getDate());break;case"D":o.push(this.opts.dayNamesFull[r.getDay()].slice(0,3));break;case"l":o.push(this.opts.dayNamesFull[r.getDay()]);break;default:o.push(s)}}return o.join("")
}function g(d,o){var p=Object.prototype.toString.call(o).slice(8,-1);return o!==e&&o!==null&&p===d}c.prototype={init:function(){var d=this,p=0,q;d.element=k.getElementById(d.opts.element),div=null;if(!d.element){return}if(d.element.nodeType===1&&d.element.nodeName=="INPUT"&&d.element.value.length>0){d.element.value=d.element.value.split(" ")[0];var o=new Date(Date.parse(d.element.value));d.selectedDate=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate());d.opts.year=d.selectedDate.getFullYear();d.opts.month=d.selectedDate.getMonth()}d.element.style.cursor="pointer";if(!d.opts.inline&&$(d.element).retrieve("key")==null){$(d.element).store("key",true);c.Util.addEvent(d.element,"focus",function(r){div=d.creatCalendarNode();if(d.isOpen){d.close()}else{d.open()}});c.Util.addEvent(d.element,"blur",function(r){if(d.isOpen&&!d.focus){d.close()}});c.Util.addEvent(d.element,"keydown",function(s){div=d.creatCalendarNode();var r=s.charCode?s.charCode:s.keyCode?s.keyCode:0;switch(r){case 9:d.close();
break;case 27:d.close();break}});document.addEvent("mousedown",function(t){div=d.creatCalendarNode();var s=c.Util.getEventTarget(t),r=$(d.container);s=$(s);if(s!=r&&!r.contains(s)&&s!=$(d.element)){d.close.call(d);return}})}else{d.element.appendChild(div)}return d},creatCalendarNode:function(){if(!this.container){var q=k.createElement("div"),o=k.getElementsByTagName("body")[0];this.id=Math.floor(Math.random()*9999999);q.setAttribute("id",["bcal-container",this.id].join("-"));c.Util.addClass(q,"bcal-container");q.style.display="none";q.style.position="absolute";this.container=q;o.appendChild(q);var p=this.opts.year,d=this.opts.month;for(i=0;i<this.opts.months;i++){this.draw(p,d+i,a(i,this.opts.months))}if(this.opts.hasTimeSelector){this.setSelectorTimeBox()}if(this.opts.rel){this.element.getParent(".dateTextIcon").hide()}return q}else{return this.container}},setSelectorTimeBox:function(){var p=this.element.getParent(".dateTextIcon");var s=new Element("label",{"class":"_selectorTimes"}).inject(p?p:this.element,"after"),q=this;
var r="";if(this.element.value!=""){r=this.element.value}r=r.split(" ")[0];if(this.element.get("data-init")){r=r+" "+this.element.get("data-init")}else{s.addClass("_selectorDisabel")}var d=new Element("input",{type:"hidden",name:this.element.get("name"),id:"hidden"+this.id,value:r,"data-type":this.element.get("data-type")?this.element.get("data-type"):""}).inject(s,"before");this.element.store("id",d);this.element.removeProperties("name","data-type");var o=new Element("input",{type:"text",id:"rele"+this.id,value:this.element.get("data-init")?this.element.get("data-init"):"00:00",readonly:"readonly"}).addEvent("focus",function(){if(q.element.value==""){if(!q.opts.rel){q.element.focus();return}}if(q.opts.rel){q.element.value=q.opts.rel.element.value}if($("selector"+q.id)){q.refresh.call(q);if(q.element.retrieve("time")){q.selectorUpdate(q.element.retrieve("time"))}$("selector"+q.id).position({relativeTo:"rele"+q.id,position:"leftBottom",offset:{x:-4,y:6}}).show()}else{s.removeClass("_selectorDisabel");
q.selectorEver(s);document.addEvent("mousedown",function(u){var t=$(u.target);if(t!=o&&t!=$("selector"+q.id)&&!$("selector"+q.id).contains(t)){$("selector"+q.id).hide()}})}}).inject(s);this.element.store("for",o)},selectorEver:function(s){var u=new Element("div",{id:"selector"+this.id,"class":"_timeOptions","data-type":"selector",styles:{width:88,"z-index":99,background:"#fff",height:136,overflow:"hidden","overflow-y":"auto",border:"1px solid #CCCCCC",position:"absolute"}}).inject(s,"after");var q=s.getElement("input"),o=this;var d=new Element("ul").inject(u);var r=new Fx.Scroll(u,{duration:0,wait:false});d.store("fx",r);var p=this.element.value,t=this.selectorTimes();if(this.element.value!=""){$("hidden"+o.id).value=this.element.value+" "+$("rele"+this.id).value}p=p.split(" ")[0];t.each(function(w,v){new Element("li",{"data-type":p+" "+w,text:w,"class":w==q.value?"selected":""}).addEvents({click:function(){q.value=this.innerHTML;if($("hidden"+o.id)){$("hidden"+o.id).value=this.get("data-type")
}if($("selector"+o.id)){$("selector"+o.id).getElements("li").removeClass("selected");this.addClass("selected");$("selector"+o.id).hide()}},mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")}}).inject(d)});u.position({relativeTo:s,position:"leftBottom",offset:{x:0,y:-1}});r.toElement(d.getElements("li")[19],"y");this.element.store("time",d)},selectorUpdate:function(p){p.innerHTML="";var o=this.element.value,q=this.selectorTimes(),d=this.id;if(this.element.value!=""){$("hidden"+d).value=this.element.value+" "+$("rele"+d).value}q.each(function(r){new Element("li",{"data-type":o+" "+r,text:r,"class":$("rele"+this.id).value==r?"selected":""}).addEvents({click:function(){if($("rele"+d)){$("rele"+d).value=this.innerHTML}if($("hidden"+d)){$("hidden"+d).value=this.get("data-type")}if($("selector"+d)){$("selector"+d).getElements("li").removeClass("selected");this.addClass("selected");$("selector"+d).hide()}},mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")
}}).inject(p)}.bind(this))},selectorTimes:function(){return["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"]},setPramasMinDate:function(d,o){this.opts.minDate=d;this.refresh.call(this);if(!this.opts.hasTimeSelector&&o){$(this.element).focus()}return this},setParamasMaxDate:function(d){this.opts.maxDate=d;this.refresh.call(this);if(!this.opts.hasTimeSelector){$(this.element).focus()}return this},setOptionsRel:function(d){this.opts.rel=d;return this},autoTips:function(p,o){if($("hidden"+p.id)&&$("hidden"+o.id)){var r=new Date(Date.parse($("hidden"+p.id).value)),q=new Date(Date.parse($("hidden"+o.id).value));if(r>q){var d=new Element("div",{text:"开始时间不能大于结束时间哦！",styles:{position:"absolute","z-index":9999,background:"#FFBB99",width:"245px","text-align":"center",height:"30px","line-height":"30px"}}).position({relativeTo:p.element.getParent(),position:"leftBottom",offset:{x:0,y:1}}).inject(document.body);
(function(){d.dispose()}).delay(2000)}}},formatDate:function(){return n.apply(this,arguments)},cf:function(){var d={c0101:"春节",c0115:"元宵",c0505:"端午",c0707:"七夕",c0715:"中元",c0815:"中秋",c0909:"重阳",c1208:"腊八",c1224:"小年",c0100:"除夕"};return d},wf:function(){var d={w0101:"元旦",w0214:"情人",w0308:"妇女",w0312:"植树",w0401:"愚人",w0501:"五一",w0504:"青年",w0520:"母亲",w0601:"儿童",w0808:"父亲",w0910:"教师",w1001:"国庆",w1111:"单身",w1212:"狂购",w1224:"平安",w1225:"圣诞"};return d},getLunarInfo:function(){var d=new Array(19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448);
return d},lYearDays:function(p){var d,o=348;for(d=32768;d>8;d>>=1){o+=(this.getLunarInfo()[p-1900]&d)?1:0}return(o+this.leapDays(p))},leapDays:function(d){if(this.leapMonth(d)){return((this.getLunarInfo()[d-1900]&65536)?30:29)}else{return(0)}},leapMonth:function(d){return(this.getLunarInfo()[d-1900]&15)},monthDays:function(o,d){return((this.getLunarInfo()[o-1900]&(65536>>d))?30:29)},Lunar:function(x){var r,d=0,z=0;var o=new Date(1900,0,31);var q=(x-o)/86400000;var s=q+40;var y=14;for(r=1900;r<2050&&q>0;r++){z=this.lYearDays(r);q-=z;s+=12}if(q<0){q+=z;r--;s-=12}var u=r;var p=r-1864;d=this.leapMonth(r);var w=false;for(r=1;r<13&&q>0;r++){if(d>0&&r==(d+1)&&w==false){--r;w=true;z=this.leapDays(u)}else{z=this.monthDays(u,r)}if(w==true&&r==(d+1)){w=false}q-=z;if(w==false){s++}}if(q==0&&d>0&&r==d+1){if(w){w=false}else{w=true;--r;--s}}if(q<0){q+=z;--r;--s}var t=r;var v=q+1;return[t,v]},draw:function(q,d,L,M){var u=this,T=typeof M==="undefined"?Math.floor(Math.random()*9999999):M,v=new Date(q,d,1),s=new Date(q,d+1,0).getDate(),B=new Date(q,d,0).getDate(),X=v.getUTCDay(),w=v.getDay(),P,G,R,S=0,y=u.opts.weekNumbers?8:7,C=k.createElement("table"),H=k.createElement("thead"),O=k.createElement("tbody"),x,J,I,Y,W,t,D,z,Q,A,K,r=false;
u.container.innerHTML="";if(u.opts.minDate!==null){r=true}x=k.createElement("tr");c.Util.addClass(x,"bcal-hcall");J=k.createElement("th");if(u.opts.showNavigation&&(L===1||L===3)){c.Util.addEvent(J,"click",function(Z){u.container.innerHTML="";for(P=0;P<u.opts.months;P++){u.draw(q,d-u.opts.months+P,a(P,u.opts.months));if(P===0){u.opts.year=q;u.opts.month=d-u.opts.months}}});J.style.cursor="pointer";J.style.backgroundPosition="center -30px";c.Util.addClass(J,"bcal-nav");I=k.createTextNode("<");J.appendChild(I)}else{c.Util.addClass(J,"bcal-navi")}x.appendChild(J);J=k.createElement("th");J.colSpan=(y===7)?5:6;c.Util.addClass(J,"bcal-month");J.appendChild(k.createTextNode(v.getFullYear()+"年  "+u.opts.monthNamesFull[v.getMonth()]));x.appendChild(J);J=k.createElement("th");if(u.opts.showNavigation&&(L===2||L===3)){J.style.cursor="pointer";c.Util.addClass(J,"bcal-nav");I=k.createTextNode(">");J.style.backgroundPosition="center -2px";c.Util.addEvent(J,"click",function(Z){u.container.innerHTML="";
for(P=0;P<u.opts.months;P++){u.draw(q,d+P+1,a(P,u.opts.months));if(P===0){u.opts.month=d+1;u.opts.year=q}}});J.appendChild(I)}else{c.Util.addClass(J,"bcal-navi")}x.appendChild(J);H.appendChild(x);x=k.createElement("tr");if(u.opts.weekNumbers){J=k.createElement("th");J.appendChild(k.createTextNode("wk"));c.Util.addClass(J,"bcal-wnum");x.appendChild(J)}for(P=0;P<7;P++){J=k.createElement("th");I=k.createTextNode(u.opts.dayNames[(u.opts.startDay+P)%7]);c.Util.addClass(J,"bcal-wday");J.appendChild(I);x.appendChild(J)}H.appendChild(x);C.appendChild(H);G=u.opts.startDay+1-w;while(G>1){G-=7}while(G<=s){t=new Date(q,d,G+X);x=k.createElement("tr");if(u.opts.weekNumbers){J=k.createElement("td");c.Util.addClass(J,"bcal-week");Y=new Date(t.getFullYear(),t.getMonth(),t.getDate()-(t.getDay()||7)+3);W=new Date(Y.getFullYear(),0,4);J.appendChild(k.createTextNode(1+Math.round((Y-W)/86400000/7)));x.appendChild(J)}for(P=0;P<7;P++){J=k.createElement("td");if(G>0&&G<=s){D=new Date(q,d,G);J.setAttribute("bcal-date",D.getTime());
c.Util.addClass(J,"bcal-date");if(!Browser.ie){if(D.getMonth()!==u.currMonthCatch||u.currDay>29){u.currMonthCatch=D.getMonth();var U=u.Lunar(D);u.currDay=U[1];u.currMonth=U[0]}else{u.currDay++}}var N=D.getMonth()+1;var p="c"+(u.currMonth<10?(0+""+u.currMonth):u.currMonth)+""+(u.currDay<10?(0+""+u.currDay):u.currDay),V="w"+(N<10?(0+""+N):N)+""+(D.getDate()<10?(0+""+D.getDate()):D.getDate());if(l===[D.getFullYear(),D.getMonth(),D.getDate()].join("-")){c.Util.addClass(J,"bcal-today");I=k.createTextNode("今天")}else{if(u.wf()[V]!==e){c.Util.addClass(J,"bcal-festival");I=k.createTextNode(u.wf()[V])}else{if(u.cf()[p]!==e){c.Util.addClass(J,"bcal-festival");I=k.createTextNode(u.cf()[p])}else{I=k.createTextNode(G)}}}J.appendChild(I);J.setAttribute("title",D.format("%Y-%m-%d"));z=u.opts.onBeforeShowDay.apply(u,[D]);if(u.opts.disablePast===true&&D<f){c.Util.addClass(J,"bcal-past")}else{if(r&&D<u.opts.minDate||u.opts.maxDate&&D>u.opts.maxDate){c.Util.addClass(J,"bcal-past")}else{if(z[0]===false){c.Util.addClass(J,z[1])
}else{u.bind.call(u,J)}}}}else{if(u.opts.showOtherMonths){var F=G>0?G-s:B+G,o=G>0?d+1:d-1;D=new Date(q,o,F);if(!Browser.ie){if(D.getMonth()!==u.currMonthCatch||u.currDay>29){u.currMonthCatch=D.getMonth();var U=u.Lunar(D);u.currDay=U[1];u.currMonth=U[0]}else{u.currDay++}}var N=D.getMonth()+1;var p="c"+(u.currMonth<10?(0+""+u.currMonth):u.currMonth)+""+(u.currDay<10?(0+""+u.currDay):u.currDay),V="w"+(N<10?(0+""+N):N)+""+(D.getDate()<10?(0+""+D.getDate()):D.getDate());if(u.wf()[V]!==e){c.Util.addClass(J,"bcal-festival");I=k.createTextNode(u.wf()[V])}else{if(u.cf()[p]!==e){c.Util.addClass(J,"bcal-festival");I=k.createTextNode(u.cf()[p])}else{I=k.createTextNode(F)}}J.appendChild(I);J.setAttribute("bcal-date",D.getTime());J.setAttribute("title",D.format("%Y-%m-%d"));if(u.opts.selectOtherMonths){u.bind.call(u,J)}if(f<D){if(r&&D<u.opts.minDate||u.opts.maxDate&&D>u.opts.maxDate){c.Util.addClass(J,"bcal-empty")}else{c.Util.addClass(J,"bcal-date");u.bind.call(u,J)}}else{c.Util.addClass(J,"bcal-empty")
}}}if(u.selectedDate!==null&&u.selectedDate.getTime()===D.getTime()&&u.opts.month===d){c.Util.addClass(J,"bcal-selected")}x.appendChild(J);O.appendChild(x);G++}S++}if(S===5){O.appendChild(m(u.opts.weekNumbers))}else{if(S===4){O.appendChild(m(u.opts.weekNumbers));O.appendChild(m(u.opts.weekNumbers))}}c.Util.addClass(C,"bcal-table");C.setAttribute("id",["bcal-table",T].join("-"));C.appendChild(O);c.Util.addEvent(C,"click",function(Z){u.focus=true});var E=k.getElementById(["bcal-table",T].join("-"));if(E){u.container.removeChild(E)}u.container.appendChild(C)},bind:function(d){var o=this,r,p,q;c.Util.addEvent(d,"click",(function(t,s){return function(){r=c.Util.getElementsByClass("bcal-selected",t.container,"td");for(p=0,q=r.length;p<q;p++){c.Util.removeClass(r[p],"bcal-selected")}c.Util.addClass(s,"bcal-selected");var u=parseInt(s.getAttribute("bcal-date"),10);t.selectedDate=new Date(u);t.opts.year=t.selectedDate.getFullYear();t.opts.month=t.selectedDate.getMonth();if(t.opts.element&&!t.opts.inline){t.close();
t.element.value=t.formatDate(t.opts.dateFormat,u)}t.opts.onSelect.apply(t,[t.element,t.formatDate(t.opts.dateFormat,u),u,s]);t.refresh.call(t)}})(o,d))},open:function(){var o=this,p=j(o.element),d;d=o.opts.onBeforeOpen.apply(o,[]);if(d===false){return o}switch(o.opts.position){case"bottom":o.container.style.top=(p[1]+o.element.offsetHeight+o.opts.offerset.y)+"px";break;case"top":o.container.style.display="";o.container.style.top=(p[1]-o.container.offsetHeight-o.opts.offerset.y)+"px";break}o.container.style.left=p[0]-o.opts.offerset.x+"px";o.container.style.display="";o.opts.onOpen.apply(o,[o.element]);o.isOpen=true;o.focus=true;return o},close:function(){var o=this,d;d=o.opts.onBeforeClose.apply(o,[]);if(d===false){return o}o.container.style.display="none";o.opts.onClose.apply(o,[]);o.isOpen=false;o.focus=false;return o},detach:function(){var d=this;d.element.style.cursor="text";d.container.parentNode.removeChild(d.container);return d.element},option:function(p){var o=this;switch(arguments.length){case 1:if(g("String",p)&&o.opts[p]){return o.opts[p]
}else{if(g("Object",p)){for(var d in p){if(p.hasOwnProperty(d)){o.opts[d]=p[d]}}}}break;case 2:if(o.opts[p]){o.opts[p]=arguments[1]}break}return o},refresh:function(){var o=this;o.container.innerHTML="";var p=o.opts.year,d=o.opts.month;for(i=0;i<o.opts.months;i++){o.draw(p,d+i,a(i,o.opts.months))}return o}};return(h.Calendar=c)})(window);var amTips=new Class({Implements:[Options,Events],options:{position:"right",fixed:false,center:true,content:"title",html:false,isHover:false,balloon:true,arrowSize:16,arrowOffset:12,distance:8,motion:6,motionOnShow:true,motionOnHide:true,showOn:"mouseenter",hideOn:"mouseleave",showDelay:0,hideDelay:0,callback:$empty,className:"plugs_tips",borderColor:"#ffa463",bgColor:"#ffffe1",color:"#333",width:"auto",offset:{x:0,y:0},automove:false,ispointer:true,delay:3000,isFly:false,fx:{duration:"short"},mouseBandCallback:"",ajax:false},initialize:function(c,a){this.setOptions(a);var b=this;this.boundShow=(function(d){this.store("isHover",true);if(b.options.isHover){(function(){if(this.retrieve("isHover")){b.doAttach.apply(this,[b])}else{return}}.bind(this)).delay(600)}else{b.doAttach.apply(this,[b])}});this.boundHide=(function(){this.store("isHover",null);this.store("isLeave",null);if(b.options.automove){(function(){if(this.retrieve("isLeave")==null){b.hide(this)}}.bind(this)).delay(400)}else{b.hide(this)
}});if(!["top","right","bottom","left","inside"].contains(this.options.position)){this.options.position="top"}if(c){this.attach(c)}return this},doAttach:function(a){if(!a.options.ajax){this.store("isLeave",true);if(a.options.mouseBandCallback){if(typeof a.options.mouseBandCallback=="function"){a.options.mouseBandCallback.run({_this:a})}}else{a.show(this)}}else{if(typeof a.options.mouseBandCallback=="function"){a.options.mouseBandCallback.apply(a,[this])}}},attach:function(b){var a=this;$$(b).each(function(c){if(!a.options.isFly){if(c.retrieve("hasevent")){return}evs={};evs[a.options.showOn]=a.boundShow;evs[a.options.hideOn]=a.boundHide;c.addEvents(evs);c.store("hasevent",true)}c.store("object",a)});return this},detach:function(c){var b=this;var a={};a[this.options.showOn]=this.boundShow;a[this.options.hideOn]=this.boundHide;$$(c).each(function(d){b.hide(d);d.removeEvents(a);d.eliminate("hasevent");d.eliminate("object")});return this},show:function(b){var a=b.retrieve("_tips");if(a){if(a.getStyle("opacity")==1){clearTimeout(a.retrieve("timeout"));
return this}}var c=this._create(b);if(c==null){return this}b.store("_tips",c);this._animate(c,"in");b.store("visible",true);this.fireEvent("show",[c,b]);return this},hide:function(a){var b=a.retrieve("_tips");if(!b){return this}this._animate(b,"out");a.store("visible",false);this.fireEvent("hide",[b,a]);return this},toggle:function(a){if(a.retrieve("visible")){return this.hide(a)}else{return this.show(a)}},_create:function(d){var e=this.options;e.c=e.content;e.opos=e.position;if(e.c=="title"){e.c="plugs-tips";if(!d.get("plugs-tips")){d.setProperty("plugs-tips",d.get("title"))}d.set("title","")}if(!e.center){if(e.position=="left"||e.position=="right"){e.offset.y=-e.arrowSize/2}else{e.offset.x=-e.arrowSize/2}}e.cnt=(typeof(e.c)=="string"?d.get(e.c):e.c(d));e.cwr=new Element("div").addClass(e.className).setStyles({margin:0,border:"1px solid "+e.borderColor,padding:"1px 10px 3px",background:e.bgColor,"border-radius":"3px","z-index":999,color:e.color});if(!e.isFly){var c={};c[e.showOn]=function(){d.store("isLeave",true)
};c[e.hideOn]=this.boundHide.bind(d);e.cwr.addEvents(c)}e.tip=new Element("div").addClass(e.className+"-wrapper").setStyles({margin:0,padding:0,"z-index":e.cwr.getStyle("z-index")>100?e.cwr.getStyle("z-index"):100}).adopt(e.cwr);e.tip.setStyle("max-width",e.width);if(e.cnt){if($(e.cnt)){if(e.adoptdom){e.cwr.adopt(e.cnt)}else{e.cwr.set("html",typeof(e.cnt)=="string"?e.cnt:e.cnt.get("html"))}}else{e.cwr.set("html",e.cnt)}}else{return null}e.tip.setStyles({position:(e.fixed?"fixed":"absolute"),opacity:0,top:0,left:0}).inject(document.body);if(e.balloon&&e.ispointer?(!e.isFly):(!e.ispointer)){var a=new Element("div").addClass(e.className+"-triangle").setStyles({margin:0,padding:0});e.tipborder=new Element("i",{html:"◆",styles:{"z-index":1,color:e.borderColor}}).inject(a);e.tipbg=new Element("i",{html:"◆",styles:{"z-index":9,color:e.bgColor}}).inject(a);e.ccstyle={width:e.arrowSize,height:e.arrowSize,display:"block","font-family":"SimSun",position:"absolute","font-style":"normal"};e.tipborder.setStyles(e.ccstyle);
e.tipbg.setStyles(e.ccstyle);e.borderStyle={};var b={width:e.arrowSize,height:e.arrowSize,"line-height":e.arrowSize,overflow:"hidden",position:"absolute","z-index":3,"font-size":"1.2em"};switch(e.opos){case"inside":case"top":b.top="auto";b.bottom=-8;e.borderStyle.bottom=-1;break;case"right":e.borderStyle.left=-1;b.left=10;e.cwr.setStyle("margin-left",e.arrowSize);break;case"bottom":b.top=-7;if(Browser.ie6){b.top=-5}if(Browser.ie6){b.bottom=-10}e.borderStyle.top=-1;break;case"left":b.right=8;e.borderStyle.right=-1;if(Browser.ie7){b.position="absolute";b.right=8}else{b["float"]="right"}e.cwr.setStyle("margin-right",e.arrowSize);break}switch(e.opos){case"inside":case"top":case"bottom":b["margin-left"]=e.center?((e.tip.getSize().x/2>e.arrowSize)?(e.tip.getSize().x/2+e.arrowSize/2)-e.arrowSize:5):e.arrowOffset;break;case"left":case"right":b["margin-top"]=e.center?((e.tip.getSize().y/2>e.arrowSize)?(e.tip.getSize().y/2+e.arrowSize/2)-e.arrowSize:5):e.arrowOffset;break}e.tipborder.setStyles(e.borderStyle);
a.setStyles(b).inject(e.tip,(e.opos=="top"||e.opos=="inside")?"bottom":"top")}e.tipSz=e.tip.getSize();e.trgC=d.getCoordinates();e.offsetOption=("function"===typeof(e.offset)?Object.merge({x:0,y:0},e.offset(d)):e.offset);e.pos={x:e.trgC.left+e.offsetOption.x,y:e.trgC.top+e.offsetOption.y};if(e.opos=="inside"){e.tip.setStyles({width:e.tip.getStyle("width"),height:e.tip.getStyle("height")});d.setStyle("position","relative").adopt(e.tip);e.pos={x:e.offset.x,y:e.offset.y}}else{switch(e.opos){case"top":e.pos.y-=e.tipSz.y+e.distance;break;case"right":e.pos.x+=e.trgC.width+e.distance;break;case"bottom":e.pos.y+=e.trgC.height+e.distance;break;case"left":e.pos.x-=e.tipSz.x+e.distance;break}}if(e.center){switch(e.opos){case"top":case"bottom":e.pos.x+=(e.trgC.width/2-e.tipSz.x/2);break;case"left":case"right":e.pos.y+=(e.trgC.height/2-e.tipSz.y/2);break;case"inside":e.pos.x+=(e.trgC.width/2-e.tipSz.x/2);e.pos.y+=(e.trgC.height/2-e.tipSz.y/2);break}}e.pos.y=(d==$(document.body))?0:e.pos.y;e.pos.x=(d==$(document.body))?e.pos.x*2:e.pos.x;
if(d.match("body")){e.pos.y=15;e.pos.x=e.pos.x-$(document.body).getSize().x/2+e.tip.getSize().x/2;e.tip.getElement("div").setStyle("padding","1px 50px")}d.store("tips",e.tip);e.tip.set("morph",e.fx).store("position",e.pos);e.tip.setStyles({top:e.pos.y,left:e.pos.x});return e.tip},_animate:function(a,b){var c=this;clearTimeout(a.retrieve("timeout"));a.store("timeout",(function(e){var g=this.options,f=(b=="in");var d={opacity:f?1:0};if((g.motionOnShow&&f)||(g.motionOnHide&&!f)){var h=e.retrieve("position");if(!h){return}switch(g.position){case"inside":case"top":d.top=f?[h.y-g.motion,h.y]:h.y-g.motion;break;case"right":d.left=f?[h.x+g.motion,h.x]:h.x+g.motion;break;case"bottom":d.top=f?[h.y+g.motion,h.y]:h.y+g.motion;break;case"left":d.left=f?[h.x-g.motion,h.x]:h.x-g.motion;break}}e.morph(d);if(!f){e.get("morph").chain(function(){c.options.callback.call(c);this.dispose()}.bind(e))}}).delay((b=="in")?this.options.showDelay:this.options.hideDelay,this,a));return this}});Element.implement({amTips:function(a){new amTips(this,a);
return this},amTipsShow:function(a){var c=this;var b=this.retrieve("object");if(b){b.show(this)}if(b.options.isFly||a){this.amTipsHide.delay(b.options.delay,[this])}return this},amTipsHide:function(){var b=this;if(typeof this=="object"){b=this[0]}else{b=this}var a=b.retrieve("object");if(a){a.hide(b)}return b},amTipsToggle:function(){var a=this.retrieve("object");if(a){a.toggle(this)}return this}});Element.Properties.amTips={get:function(){return this.retrieve("object")}};var evengo=new Class({Implements:[Options,Events],options:{element:".eventses",flag:true,fx:"",np:"left",right:0,times:3,width:98,allwidth:490,parent:"",auto:false,clear:$empty,control:true},initialize:function(b){this.setOptions(b);this.element=$(this.options.parent);this.options.element=this.element.getElements(".eventses");this.elements=this.element.getElements("li");var a=this;if(this.elements.length>5||this.options.auto||this.options.flag){var c=a.element.getElement("ul"),d=c.getElements("li").length*this.options.width;this.options.right=c.getStyle("right");if(this.elements.length<10){this.elements.each(function(e){e.clone().inject(c)});d=c.getElements("li").length*this.options.width}c.setStyle("width",d+"px");this.options.element.each(function(e){e.addEvent("click",function(){if(a.options.flag){a.options.flag=false;if(this.getNext()){a.options.np="right";var g=-d.toInt()+a.options.allwidth+a.options.times*a.options.width;var f=0;while(f<a.options.times){c.getLast().inject(c,"top");
f++}c.setStyles({left:"auto",right:g+"px"});a.options.fx.start("right",g,g-a.options.times*a.options.width)}else{a.options.np="left";a.options.fx.start("left",0,-a.options.times*a.options.width)}}})});this.options.fx=new Fx.Tween(this.element.getElement("ul"),{duration:1000,onComplete:function(){var f=this.element.getElement("ul");this.options.flag=true;if(this.options.np=="left"){var e=0;while(e<this.options.times){f.getFirst().inject(f);e++}}f.setStyle("left","0");$clear(this.options.clear);if(this.options.control&&this.options.auto){this.auto()}}.bind(this)})}if(this.options.auto){this.auto();this.element.addEvents({mouseenter:function(){a.options.control=false;$clear(a.options.clear)},mouseleave:function(){a.options.control=true;a.auto()}})}},auto:function(){this.options.clear=this.play.periodical(3000,this)},play:function(){this.options.np="left";this.options.fx.start("left",0,-this.options.times*this.options.width)}});var marquee=new Class({Implements:[Options,Events],options:{transition:"fade",autointerval:5000,items:".items",tween:{duration:1000},me:"",autotimer:0,flag:true,fx:""},initialize:function(b,a){this.setOptions(a);
this.element=$(b);this.initmarquee();this.auto()},initmarquee:function(){var a=this,b=this.element.getElements(this.options.items);b.each(function(d,c){var e={};e.h=d.getDimensions().y;e.fx=new Fx.Morph(d,{wait:false,duration:1000,transition:Fx.Transitions.linear,onComplete:function(){if(this.element.getChildren()){this.element.getChildren().fade("in")}a.readymarquee()}});d.store("obj",e);if(c==(b.length-1)){this.readymarquee()}}.bind(this))},readymarquee:function(){var a=this.element.getElements(this.options.items).getLast();a.setStyles({height:"0px",overflow:"hidden",visibility:"hidden",position:"relative"});a.hide();a.inject(this.element,"top");if(a.getChildren()){a.getChildren().fade("out")}},show:function(){if(this.options.flag){var a=this.element.getElement(this.options.items);if(a.retrieve("obj")!=null){var b=a.retrieve("obj");a.show();b.fx.start({height:[0,b.h],opacity:[0,1]});this.options.fx=b.fx}else{return}}},stop:function(){$(this.element.parentNode).addEvents({mouseenter:function(){if(this.options.fx){this.options.fx.pause()
}this.options.flag=false}.bind(this),mouseleave:function(){if(this.options.fx){this.options.fx.resume()}this.options.flag=true}.bind(this)})},auto:function(){this.options.autotimer=this.show.periodical(this.options.autointerval,this);this.stop()}});var objectSolid=new Class({Implements:[Options,Events],options:{autointerval:5000,pr:162,width:50,nav:".choiceNave"},initialize:function(a,c,d,b){this.setOptions(b);this.container=$(a);this.objWoher=$(c);this.objWohin=$(d);this.objMouse();this.defiend();this.cur=this.container.getElement("img");this.choice=this.objWoher.getFirst();this.textFx();this.autotimer=this.autoExecute.periodical(this.options.autointerval,this)},defiend:function(){this.objWoher.setStyle("width",this.objWoher.getElements("li").length*this.options.width+10);this.options.pr=(this.objWoher.getElements("li").length-1)*this.options.width+12;$$(this.options.nav).setStyle("right",Browser.Engine.version!=4?this.options.pr:this.options.pr-4)},objMouse:function(){var a=this;this.objWoher.getElements("li").each(function(c,b){if(this.container.retrieve(c.get("lang"))==null){this.container.store(c.get("lang"),new Element("img",{src:c.get("lang"),"class":"choiceImg",styles:{opacity:0}}).inject(new Element("a",{href:c.getElement("a").get("href"),target:"_blank"}).inject(this.container)))
}c.addEvent("mouseenter",function(){a.ansin(this,b)})}.bind(this));this.objWoher.addEvents({mouseenter:function(){$clear(this.autotimer)}.bind(this),mouseleave:function(){this.autotimer=this.autoExecute.periodical(this.options.autointerval,this)}.bind(this)})},autoExecute:function(){if(this.choice.getNext()){var a=this.objWoher.getElements("li").indexOf(this.choice.getNext());this.ansin(this.choice.getNext(),a)}else{this.choice=this.objWoher.getFirst();this.ansin(this.choice,0)}},ansin:function(c,b){this.choice=c;this.cur.morph({opacity:0,width:85,height:35,left:340,top:140});if(this.container.retrieve(c.get("lang"))!=null){this.container.retrieve(c.get("lang")).morph({height:280,width:680,opacity:1,left:0,top:0});var a=Browser.Engine.version!=4?this.options.pr:this.options.pr-4;$$(this.options.nav).tween("right",a-this.options.width*b);this.objWohin.innerHTML=this.choice.innerHTML;this.myFx.start("opacity",0,1);this.cur=this.container.retrieve(c.get("lang"))}},textFx:function(){this.myFx=new Fx.Tween(this.objWohin,{duration:"2000",transition:"bounce:out",link:"cancel",onComplete:function(){this.container.getElements("img").each(function(a){if(a!=this.cur){a.setStyles({width:680,height:280,left:680,top:0})
}}.bind(this))}.bind(this)})}});var adSoild=new Class({Implements:[Options,Events],options:{autointerval:5000,nav:".nav",choice:"choice",width:16,margin:5,position:{x:660,y:80}},initialize:function(a,c,b){this.setOptions(b);this.container=$(a);this.obj=$(c);this.defiend()},defiend:function(){this.width=this.obj.getDimensions().x;this.obj.setStyle("width",this.width);this.obj.getElements(this.options.nav).each(function(d,c){if(this.container.retrieve(d.get("name"))==null){var b=new Element("a",{href:d.get("href"),title:d.get("title"),target:"_blank"});var a=new Element("img",{src:d.get("name"),styles:{opacity:0}}).inject(b.inject(this.container));if(d.get("config")){new Element("img",{src:d.get("config"),style:{width:"1px",height:"1px",position:"absolute"}}).inject(b)}this.container.store(d.get("name"),a);if(this.obj.getElements(this.options.nav).length>1){d.addEvent("mouseenter",function(){this.ansin(a,c);this.choice=d}.bind(this))}}}.bind(this));if(this.obj.getElements(this.options.nav).length>1){this.choice=this.obj.getFirst();
this.createFx();this.ansin(this.container.retrieve(this.obj.getElement(".nav").get("name")),0);this.autotimer=this.autoExecute.periodical(this.options.autointerval,this);this.objMouse()}else{this.container.getElement("img").setStyle("opacity",1);$("navControl").addClass("none")}},objMouse:function(){this.container.getParent().addEvents({mouseenter:function(){$clear(this.autotimer)}.bind(this),mouseleave:function(){this.autotimer=this.autoExecute.periodical(this.options.autointerval,this)}.bind(this)})},autoExecute:function(){if(this.choice.getNext()){var a=this.obj.getElements(this.options.nav).indexOf(this.choice.getNext());this.choice=this.choice.getNext();this.ansin(this.container.retrieve(this.choice.get("name")),a)}else{this.choice=this.obj.getFirst();this.ansin(this.container.retrieve(this.choice.get("name")),0)}},ansin:function(b,a){this.myFx.start("right",this.width-this.options.width*(a+1)-this.options.margin*a);this.container.getElements("img").each(function(c){if(c!=b){c.morph({opacity:0,width:this.options.position.x/2,height:this.options.position.y/2,left:this.options.position.x/4,top:this.options.position.y/4})
}}.bind(this));b.morph({opacity:1});this.container.getElements("img").setStyles({width:this.options.position.x,height:this.options.position.y,left:0,top:0})},createFx:function(){this.myFx=new Fx.Tween(new Element("span",{styles:{right:this.width-this.options.width}}).addClass(this.options.choice).inject(this.container.getParent()),{duration:"500",transition:Fx.Transitions.Sine,link:"cancel"})}});var fackLayout=new Class({Implements:[Options,Events],options:{clazz:["off","on"],annal:""},initialize:function(c,b,a){this.setOptions(a);this.elements=$(c).getElements(b);this.options.annal=this.elements.getLast().addClass("on");this.build()},build:function(){var a=this;this.elements.addEvent("mouseenter",function(){a.options.annal.removeClass("on");this.addClass("on");a.options.annal=this})}});var JUSlideShow8=new Class({Implements:[Options,Events],options:{right:0,slider:true},initialize:function(a){this.setOptions(a);this.juSlide8Bg=$$(this.options.juSlide8Bg);this.juSlide8Menu=$$(this.options.juSlide8Menu);
this.juSlide8Info=$$(this.options.juSlide8Info);this.juSlideMenuImg=$$(this.options.juSlideMenuImg);this.juSlide=$(this.options.juSlide);this.maxIter=this.juSlide8Bg.length;this.currentIter=0;this.constructElement();this.isEeven=true;this.count=this.options.count;this.butPre=$$(this.options.butPre)[0];this.butNext=$$(this.options.butNext)[0];this.width=this.options.width||this.juSlide8Bg[0].getDimensions().x;this.nextIter=0;this.juSlideMenuImg[0].getParent().setStyle("width",this.juSlideMenuImg.length*this.juSlideMenuImg[0].getDimensions().x);if(this.juSlideMenuImg[0].getParent(".ju-group")){this.juSlideMenuImg[0].getParent(".ju-group").setStyle("width",627)}if(this.juSlideMenuImg.length>0){[this.butPre,this.butNext].each(function(b){b.addEvents({mouseleave:function(c){this.fade(1)},mouseenter:function(c){this.fade(0.5)},click:function(c){if(this.isEeven){if($(c.target)==this.butPre){this.previous(true)}else{this.next(true)}}else{this.isEeven=false}}.bind(this)})}.bind(this))}else{this.butPre.hide();
this.butNext.hide()}this.juSlide.addEvents({mouseleave:function(){this.clearTimer();this.prepareTimer()}.bind(this),mouseenter:function(){this.clearTimer()}.bind(this)});this.juSlide.removeClass("loading");this.juSlide8Menu.each(function(c,b){c.addEvents({click:function(d){d=new Event(d);d.stop();this.goToByClick(b);this.nextIter=b}.bind(this)})}.bind(this));this.juSlide8Info[0].morph({opacity:1,duration:200});this.juSlideMenuImg[0].addClass("select");this.prepareTimer()},constructElement:function(){this.juSlide8Bg.each(function(b,a){b.setStyles({position:"absolute",left:0});b.setStyle("opacity",0)}.bind(this));this.juSlide8Info.each(function(b,a){b.setStyle("opacity",0)}.bind(this));this.juSlide8Bg[0].setStyle("opacity",1);this.currInter=-1},clearTimer:function(){$clear(this.timer)},prepareTimer:function(){this.timer=this.next.periodical(this.options.transaction,this)},previous:function(a){this.nextIter=this.currentIter-1;if(this.nextIter<=-1){this.nextIter=this.maxIter-1}if(a){this.clearTimer();
this.changeItem(this.nextIter,-1);return}this.goTo(this.nextIter)},next:function(a){this.nextIter=this.currentIter+1;if(this.nextIter>=this.maxIter){this.nextIter=0}if(a){this.clearTimer();this.changeItem(this.nextIter);return}this.goTo(this.nextIter)},goToByClick:function(a){if(a!=this.currentIter){this.clearTimer();this.changeItem(a);this.prepareTimer()}},goTo:function(a){this.clearTimer();this.changeItem(a);this.prepareTimer()},slidCousor:function(b,a){if(this.juSlideMenuImg.length<=(this.width/this.juSlideMenuImg[0].getDimensions().x).toInt()){return}if((this.juSlideMenuImg.length/this.count).toInt()==1||this.count==1){this.left=this.juSlideMenuImg[0].getDimensions().x*((this.count==1)?(-((b>(this.juSlideMenuImg.length-this.width/this.juSlideMenuImg[0].getDimensions().x).toInt())?((this.juSlideMenuImg.length-this.width/this.juSlideMenuImg[0].getDimensions().x).toInt()+1):b)):((b>=this.count)?(-(this.juSlideMenuImg.length%this.count)):0));this.juSlideMenuImg[0].getParent().tween("margin-left",this.left)
}else{if(((a)?(b+1):b)%this.count==0&&((a)?(b+1):b)+((this.juSlideMenuImg.length%this.count==0)?this.count:(this.juSlideMenuImg.length%this.count))==this.juSlideMenuImg.length){this.left=this.juSlideMenuImg[0].getDimensions().x*(-(((a)?(b-1):b)-this.count+this.juSlideMenuImg.length%this.count));this.juSlideMenuImg[0].getParent().tween("margin-left",this.left)}else{if(((a)?(b+1):b)%this.count==0){this.left=this.juSlideMenuImg[0].getDimensions().x*(-((a)?((b+1)/this.count-1):b));this.juSlideMenuImg[0].getParent().tween("margin-left",this.left)}}}},changeItem:function(c,b){if(this.currentIter!=c){if(this.juSlide8Info[c].retrieve("key")==null){this.juSlide8Info[c].store("key",this.juSlide8Info[c].getDimensions())}if(this.juSlide8Bg[this.currentIter].retrieve("key")==null){this.juSlide8Bg[this.currentIter].store("key",this.juSlide8Bg[this.currentIter].getDimensions())}if(this.juSlide8Bg[c].retrieve("key")==null){this.juSlide8Bg[c].store("key",this.juSlide8Bg[c].getDimensions())}var e=this.juSlide8Info[c].retrieve("key");
var d=this.juSlide8Bg[this.currentIter].retrieve("key");var a=this.juSlide8Bg[c].retrieve("key");this.juSlide8Bg[c].setStyles({left:0,top:0,width:a.x,height:a.y});if(this.juSlide8Info.length>0){this.juSlide8Info[this.currentIter].hide()}this.juSlide8Bg[this.currentIter].morph({opacity:0,left:this.options.slider?d.x:0,link:"cancel",transition:Fx.Transitions.Sine.easeOut,onComplete:function(){if(this.juSlideMenuImg.length>0){this.juSlideMenuImg[this.currentIter].removeClass("select");this.juSlideMenuImg[c].addClass("select");this.slidCousor(c,b)}if(this.juSlide8Info.length>0){this.juSlide8Info[c].setStyles({opacity:1,right:-this.width,width:e.x,height:e.y,bottom:40}).show();this.juSlide8Info[c].morph({right:this.options.right});this.isEeven=true}}.bind(this)});this.juSlide8Bg[c].morph({opacity:1,duration:"long",onComplete:function(){this.juSlide8Bg[this.currentIter].setStyles({left:0,top:0,width:d.x,height:d.y})}.bind(this)});this.currentIter=c}}});var slide_3d=new Class({Implements:[Options,Events],options:{w:150,h:200,mw:96,mh:128,showCount:0,clear:$empty,autofor:"next",time:5000},initialize:function(c,b,a){this.element=$(c);
this.clint=this.element.getDimensions();this.loadding=new Element("div",{styles:{width:this.clint.x,height:this.clint.y,background:"url(/css/images/loading3.gif) center center no-repeat",position:"absolute",left:0,top:0}}).inject(this.element);if(b&&$$(b).length>0){this.dataList=$$(b)}else{return}this.init()},init:function(){new Element("span").addClass("moveLeft moveCursor").addEvent("click",function(){this.play("pre",true)}.bind(this)).inject(this.element.getParent());new Element("span").addClass("moveRight moveCursor").addEvent("click",function(){this.play("next",true)}.bind(this)).inject(this.element.getParent());var b=this.options.showCount;this.dataList.each(function(e,d){if(d!=0){e.getParent("div[data-role=3d]").fade(0)}this.loadImg(e,d==this.options.showCount?true:false,function(){if(d>b+1){this.fade(0)}})}.bind(this));var c=this.dataList[this.options.showCount].getParent("div[data-role=3d]"),a=c.getDimensions().y;c.getParent().setStyle("height",a);c.fade(1);this.element.getParent().addEvents({mouseenter:function(){$$(".moveCursor").fade(1);
$clear(this.options.clear)}.bind(this),mouseleave:function(){$$(".moveCursor").fade(0);this.autoPlay()}.bind(this)});this.autoPlay()},autoPlay:function(){this.options.clear=this.play.periodical(this.options.time,this)},play:function(d,b){if(!d){d=this.options.autofor}var f=this.element.getElements("img"),a=this.element.getElement(".select"),c=f.indexOf(a),e=[];if(d==="next"){if(b){$$(".moveLeft").fade(1)}e[0]=this.getPre(f,c,0,0);e[1]=a;e[2]=this.getNex(f,c,0,0);e[3]=this.getNex(f,c,1,0);if(e[2]){this.switchContent(e[2],f,c)}if(!e[3]){if(b){$$(".moveRight").fade(0)}this.options.autofor="pre"}e.each(function(h,g){if(h&&e[2]){this.resizePicture(h,g==2?true:false,g<2?true:false,function(){if(e[0]){e[0].fade(0)}e[1].removeClass("select")})}}.bind(this))}else{if(b){$$(".moveRight").fade(1)}e[0]=this.getPre(f,c,1,0);e[1]=this.getPre(f,c,0,0);e[2]=a;e[3]=this.getNex(f,c,0,0);if(e[1]){this.switchContent(e[1],f,c)}if(!e[0]){if(b){$$(".moveLeft").fade(0)}this.options.autofor="next"}e.each(function(h,g){if(h&&e[1]){this.resizePicture(h,g==1?true:false,g>0?false:true,function(){if(e[3]){e[3].fade(0)
}e[2].removeClass("select")})}}.bind(this))}},switchContent:function(e,c,b){this.dataList[b].getParent("div[data-role=3d]").fade(0);var a=this.dataList[c.indexOf(e)].getParent("div[data-role=3d]"),d=a.getDimensions().y;a.fade(1);a.getParent().morph({height:d})},getPre:function(e,c,b,a){var d=null;while(e[c--]&&a<=b){d=e[c];a++}return d},getNex:function(e,d,c,a){var b=null;while(e[d++]&&a<=c){b=e[d];a++}return b},resizePicture:function(d,a,b,g){var f={};if(d.width>a?this.options.w:this.options.mw||d.height>a?this.options.h:this.options.mh){var e=a?this.options.w:this.options.mw,c=a?this.options.h:this.options.mh;rateWidth=d.width/e;rateHeight=d.height/c;if(rateWidth>rateHeight){f.width=a?this.options.w:this.options.mw;f.height=d.height/rateWidth}else{f.width=d.width/rateHeight;f.height=a?this.options.h:this.options.mh}}else{f.width=d.width;f.height=d.height}if(b){f.left=0}else{f.left=this.clint.x-f.width}if(a){f.left=(this.clint.x-f.width)/2}f.top=(this.clint.y-f.height)/2;d.fade(1);d.morph({left:f.left,top:f.top,width:f.width,height:f.height,"z-index":a?2:1,opacity:1,duration:50,onComplete:function(){if(a){this.addClass("select")
}g.call(this)}.bind(d)})},loadImg:function(c,a,d){var b=this;Asset.image(c.get("lazeImg"),{styles:{opacity:0},onLoad:function(){b.loadding.fade("out");b.resizePicture(this,a,false,d)}}).inject(new Element("a",{href:c.get("href")?c.get("href"):"",title:c.get("text"),target:"_blank"}).inject(this.element))}});var sigleLeep=new Class({Implements:[Options,Events],options:{leepNode:"*[config=isleep]",orientation:".orientation",isNode:"li",disable:"disable",selector:"select",point:"horizontal",count:0,size:0,length:5,screen:0,callback:$empty,isrelative:{id:"",hasclass:".isrelative",event:"mouseenter",callback:$empty}},initialize:function(b,c,a){this.setOptions(a);this.element=$(b);this.fxNode=$(c);this.orientation=this.element.getElements(this.options.orientation);this.leepNode=this.fxNode.getElements(this.options.isNode);this.screen=this.options.screen!=0?this.options.screen:(this.options.point=="vertical"?this.leepNode[0].getDimensions().y:this.leepNode[0].getDimensions().x);this.coreFx();this.setPoint();
this.orientationEventDrive()},setPoint:function(){this.orientation[0].addClass("disable");this.pos=(this.options.point=="vertical")?(function(){return"top"})():(function(){this.fxNode.setStyle("width",this.options.size*this.leepNode.length);return"left"}.bind(this))();this.storage=0;this.count=this.options.count;this.storagePos=0;this.isFlag=true;this.screenCount=(this.screen/this.options.size).toInt();this.sigleCount=this.leepNode.length%this.screenCount;this.screenfianelCount=(this.leepNode.length/this.screenCount).toInt()},orientationEventDrive:function(){var a=this;if(this.leepNode.length<=this.options.length){this.orientation.hide()}this.orientation.addEvent("click",function(){a.options.callback.apply(a);if(this.hasClass("disable")||!a.isFlag){return}a.isFlag=false;if(a.orientation[0]==this){a.count--}else{a.count++}a.skipNode(this)});if(a.count>0){this.orientation[1].fireEvent("click")}if($(this.options.isrelative.id)){this.leepNode.filter(function(b){return b.hasProperty("relative")
}).addEvent(this.options.isrelative.event,function(b){if(document.getElement("*[isrelative="+this.get("relative")+"]")){$(a.options.isrelative.id).getElements(a.options.isrelative.hasclass).hide();document.getElement("*[isrelative="+this.get("relative")+"]").show()}else{a.options.isrelative.callback(this)}a.leepNode.removeClass("select");this.addClass("select")})}},skipNode:function(a){if(this.leepNode[this.count]&&$defined(this.leepNode[this.count])){this.coreExecute()}else{a.addClass("disable");this.count=this.storage}},coreExecute:function(){this.options.point=="vertical"?(function(){if(this.screenCount==1){this.fx.start({top:[this.storagePos,-(this.options.size)*this.count]})}else{if((this.screenfianelCount==1&&this.count==0)||(this.count==0&&this.sigleCount!=0)){this.fx.start({top:[(((this.screenfianelCount==1)?0:this.storagePos)-this.sigleCount*this.options.size),0]});return}if(this.screenfianelCount==this.count){if(this.screenfianelCount==1){this.fx.start({top:[0,-(this.sigleCount*this.options.size)]})
}else{this.fx.start({top:[this.storagePos,this.storagePos-this.sigleCount*this.options.size]})}}else{this.fx.start({top:[this.storagePos,-(this.screen*this.count)]})}}}.bind(this)()):(function(){if(this.screenCount==1){this.fx.start({left:[this.storagePos,-(this.options.size)*this.count]})}else{if((this.screenfianelCount==1&&this.count==0)||(this.count==0&&this.sigleCount!=0)){this.fx.start({left:[(((this.screenfianelCount==1)?0:this.storagePos)-this.sigleCount*this.options.size),0]});return}if(this.screenfianelCount==this.count){if(this.screenfianelCount==1){this.fx.start({left:[0,-(this.sigleCount*this.options.size)]})}else{this.fx.start({left:[this.storagePos,this.storagePos-this.sigleCount*this.options.size]})}}else{this.fx.start({left:[this.storagePos,-(this.screen*this.count)]})}}}.bind(this)())},coreFx:function(){if(this.leepNode.length>this.options.length){this.fx=new Fx.Morph(this.fxNode,{duration:"400",transition:Fx.Transitions.Sine.easeOut,onComplete:function(){if(this.storage){this.orientation.removeClass("disable")
}this.storage=this.count;this.storagePos=this.fxNode.getStyle((this.options.point=="vertical")?"top":"left").toInt();if(((this.screenCount==1)?this.options.length:0)+this.count>=this.screenfianelCount&&this.orientation[1]){this.orientation[1].addClass("disable")}else{this.orientation[1].removeClass("disable")}if(this.count==0&&this.orientation[0]){this.orientation[0].addClass("disable")}else{this.orientation[0].removeClass("disable")}this.isFlag=true;if($(this.options.isrelative.id)&&this.screenCount==1){if(document.getElement("*[isrelative="+this.leepNode[this.count].get("relative")+"]")){$(this.options.isrelative.id).getElements(this.options.isrelative.hasclass).hide();document.getElement("*[isrelative="+this.leepNode[this.count].get("relative")+"]").show()}else{this.options.isrelative.callback(this.leepNode[this.count])}this.leepNode.removeClass("select");this.leepNode[this.count].addClass("select")}}.bind(this)})}else{return}}});var slideGallery=new Class({Implements:[Options,Events],options:{holder:".opiList",elementsParent:"ul",elements:"li",nextItem:".next",prevItem:".prev",stop:".stop",start:".start",speed:600,duration:3000,steps:1,current:0,transition:"sine:in:out",direction:"horizontal",mode:"callback",currentClass:"current",nextDisableClass:"next-disable",prevDisableClass:"prev-disable",paging:false,pagingEvent:"click",pagingHolder:".paging",random:false,autoplay:false,autoplayOpposite:false,stopOnHover:true},initialize:function(a,b){if(a.length==null){this.gallery=a
}else{this.gallery=a[0]}if(!this.gallery){return false}this.setOptions(b);this.holder=this.gallery.getElement(this.options.holder);this.itemsParent=this.holder.getElement(this.options.elementsParent);this.items=this.itemsParent.getElements(this.options.elements);this.next=this.gallery.getElement(this.options.nextItem);this.prev=this.gallery.getElement(this.options.prevItem);this.stop=this.gallery.getElement(this.options.stop);this.start=this.gallery.getElement(this.options.start);this.current=this.options.current;this.bound={rotate:this.rotate.bind(this)};if(this.options.direction=="horizontal"){this.direction="margin-left";this.size=this.items[0].getWidth();this.visible=Math.round(this.holder.getWidth()/this.size)}else{this.direction="margin-top";this.size=this.items[0].getHeight();this.visible=Math.round(this.holder.getHeight()/this.size)}if(this.items.length<=this.visible){if(this.next){this.next.addClass(this.options.nextDisableClass).addEvent("click",function(){return false})}if(this.prev){this.prev.addClass(this.options.prevDisableClass).addEvent("click",function(){return false
})}if(this.stop){this.stop.addEvent("click",function(){return false})}if(this.start){this.start.addEvent("click",function(){return false})}this.gallery.addClass("stopped no-active");this.fireEvent("start",this.current,this.visible,this.items.length,this.items[this.current]);return false}this.options.steps=this.options.steps>this.visible?this.visible:this.options.steps;this.options.duration=this.options.duration<1000?1000:this.options.duration;this.options.speed=this.options.speed>6000?6000:this.options.speed;if(this.options.speed>this.options.duration){this.options.speed=this.options.duration}this.fx=new Fx.Tween(this.itemsParent,{property:this.direction,duration:this.options.speed,transition:this.options.transition,link:"cancel",fps:100,onCancel:function(){if(!this.callChain()){this.fireEvent("chainComplete",this.subject)}return this}});if(this.options.random){this.shuffle()}this.getInitialCurrent();if(this.options.mode=="circle"){while(this.items.length<this.options.steps+this.visible){this.itemsParent.innerHTML+=this.itemsParent.innerHTML;
this.items=this.itemsParent.getElements(this.options.elements)}for(var c=0;c<this.current;c++){this.items[c].inject(this.itemsParent,"bottom")}this.options.paging=false}else{if(this.options.paging){this.createPaging()}this.play(false)}if(this.next){this.next.addEvent("click",function(){this.nextSlide();return false}.bind(this))}if(this.prev){this.prev.addEvent("click",function(){this.prevSlide();return false}.bind(this))}if(this.options.autoplay||this.options.autoplayOpposite){this.timer=this.bound.rotate.delay(this.options.duration)}else{this.gallery.addClass("stopped")}if(this.start){this.start.addEvent("click",function(){clearTimeout(this.timer);this.gallery.removeClass("stopped");this.timer=this.bound.rotate.delay(this.options.duration);return false}.bind(this))}if(this.stop){this.stop.addEvent("click",function(){this.gallery.addClass("stopped");clearTimeout(this.timer);return false}.bind(this))}if(this.options.stopOnHover){this.gallery.addEvent("mouseenter",function(){clearTimeout(this.timer)
}.bind(this));this.gallery.addEvent("mouseleave",function(){if(!this.gallery.hasClass("stopped")){clearTimeout(this.timer);this.timer=this.bound.rotate.delay(this.options.duration)}}.bind(this))}this.fireEvent("start",this.current,this.visible,this.items.length,this.items[this.current])},getInitialCurrent:function(){var a=this.items.get("class").indexOf(this.options.currentClass);if(a!=-1){this.current=a}else{if(this.current>this.items.length-1){this.current=this.items.length-1}else{if(this.current<0){this.current=0}}}if(this.options.mode!="circle"&&this.visible+this.current>=this.items.length){this.current=this.items.length-this.visible}return this},rotate:function(){if(!this.options.autoplayOpposite){this.nextSlide()}else{this.prevSlide()}this.timer=this.bound.rotate.delay(this.options.duration);return this},play:function(a){if(this.options.mode=="line"){this.sidesChecking()}if(a){this.fx.start(-this.current*this.size)}else{this.fx.set(-this.current*this.size)}if(this.options.paging){this.setActivePage()
}this.fireEvent("play",this.current,this.visible,this.items.length,this.items[this.current]);return this},nextSlide:function(){if(this.options.mode!="circle"){if(this.visible+this.current>=this.items.length){if(this.options.mode=="callback"){this.current=0}}else{if(this.visible+this.current+this.options.steps>=this.items.length){this.current=this.items.length-this.visible}else{this.current+=this.options.steps}}this.play(true)}else{var a=this.current;if((this.current+=this.options.steps)>=this.items.length){this.current-=this.items.length}this.fx.start(-this.size*this.options.steps).chain(function(){for(var b=0;b<this.options.steps;b++){if(a>=this.items.length){a=0}this.items[a++].inject(this.itemsParent,"bottom")}this.fx.set(0)}.bind(this));this.fireEvent("play",this.current,this.visible,this.items.length,this.items[this.current])}return this},prevSlide:function(){if(this.options.mode!="circle"){if(this.current<=0){if(this.options.mode=="callback"){this.current=this.items.length-this.visible
}}else{if(this.current-this.options.steps<=0){this.current=0}else{this.current-=this.options.steps}}this.play(true)}else{for(var a=0;a<this.options.steps;a++){if(this.current-1<0){this.current=this.items.length}this.items[--this.current].inject(this.itemsParent,"top")}this.fx.set(-this.size*this.options.steps).start(0);this.fireEvent("play",this.current,this.visible,this.items.length,this.items[this.current])}return this},sidesChecking:function(){this.next.removeClass(this.options.nextDisableClass);this.prev.removeClass(this.options.prevDisableClass);if(this.visible+this.current>=this.items.length){this.next.addClass(this.options.nextDisableClass)}else{if(this.current==0){this.prev.addClass(this.options.prevDisableClass)}}return this},createPaging:function(){this.paging=new Element("ul");var c=this.gallery.getElement(this.options.pagingHolder);if(c!=null){this.paging.inject(c)}else{this.paging.inject(this.gallery).addClass("paging")}var b=Math.ceil((this.items.length-this.visible)/this.options.steps)+1;
var d="";for(var a=0;a<b;a++){d+='<li><a href="#">'+parseInt(a+1)+"</a></li>"}this.paging=this.paging.set("html",d).getElements("a");this.paging.each(function(f,e){f.addEvent(this.options.pagingEvent,function(){if(e<b-1){this.current=e*this.options.steps}else{this.current=this.items.length-this.visible}this.play(true);return false}.bind(this))}.bind(this));return this},setActivePage:function(){this.paging.removeClass("active")[Math.ceil(this.current/this.options.steps)].addClass("active");return this},shuffle:function(){var a="";this.items.sort(function(){return 0.5-Math.random()}).each(function(b){a+=new Element("div").adopt(b).get("html")});this.items=this.itemsParent.set("html",a).getElements(this.options.elements);return this}});var fadeGallery=new Class({Extends:slideGallery,initialize:function(a,b){if(b.mode=="circle"){b.mode="callback"}this.parent(a,b);this.fxFade=[];this.items.each(function(d,c){this.fxFade[c]=new Fx.Tween(d,{property:"opacity",duration:this.options.speed,transition:this.options.transition,link:"cancel"});
this.fxFade[c].set(0)}.bind(this));this.play(false)},play:function(a){if(this.previous==null){this.previous=0;return false}if(this.options.mode=="line"){this.sidesChecking()}if(a){this.fxFade[this.previous].start(0);this.fxFade[this.current].start(1)}else{this.fxFade[this.previous].set(0);this.fxFade[this.current].set(1)}this.previous=this.current;if(this.options.paging){this.setActivePage()}this.fireEvent("play",this.current,this.visible,this.items.length,this.items[this.current])}});var scrollNav=new Class({Implements:[Options,Events],options:{wrapper:window,activeClass:"select",disActiveClass:"disable",managerNode:{manager:"dl",panel:"dt",node:"dt label"},isFlag:false},position:0,oldposition:0,managerHeight:0,oldmanagerHeight:0,initialize:function(b,a){this.setOptions(a);this.wrapper=this.options.wrapper;this.nav=this.element=document.id(b);this.elements=[];this.offset=this.nav.getPosition().y;this.isFlag=this.options.isFlag;this.manager=this.nav.getElements(this.options.managerNode.manager);
this.panel=this.nav.getElements(this.options.managerNode.panel);this.node=this.nav.getElements(this.options.managerNode.node);this.createManager();this.attach();this.scrolla=new Fx.Scroll(window,{duration:1000,wait:false,link:"cancel",onComplete:function(){}.bind(this),onCancel:function(){}.bind(this)})},attach:function(){if(!this.boundScroll){this.boundScroll=this.scroll.bind(this)}this.wrapper.addEvent("scroll",this.boundScroll)},scroll:function(){this.position=this.wrapper.getScroll().y;if((this.position-this.oldposition).abs()<30){return}this.oldposition=this.position;footH=$$(".ui_footer")[0]?$$(".ui_footer")[0].getDimensions().y+40:0;var c=this.wrapper.getScroll().y,a,b=this.wrapper==window?document.body:this.wrapper;if((window.getScrollSize().y-footH)<=(this.wrapper.getScroll().y+this.nav.getDimensions().y)){this.nav.setStyles({top:window.getScrollSize().y-footH-this.nav.getDimensions().y,position:"absolute"})}else{this.nav.removeProperty("style")}if(!this.isFlag&&c>this.offset){this.nav.removeClass("fix_top").addClass("fix_nav");
this.isFlag=true}if(this.isFlag&&c<=this.offset){this.nav.removeClass("fix_nav").addClass("fix_top");this.isFlag=false}if(this.wrapper.getScroll().y<document.getElement('div[data*="movieBox"]').getDimensions().y){if($("movieAc")){$("movieAc").addClass("none")}}this.autoScroll()},createManager:function(){var a=this;this.node.addEvent("click",function(d){var b=this.getParent("dl");var c=document.getElement("div[data="+this.get("rel")+"]");if(c){if(b.hasClass("select")){a.scrolla.toElement(c)}else{a.scrolla.toElement(c);(function(){a.goWalk(b)}).delay(1000)}}})},goWalk:function(a){if(a.retrieve("loadLeftMenuAd")==null){GewaraUtil.sendLoad($(a.get("data-news")),"/ajax/loadLeftMenuAd.xhtml",{tag:a.get("data-tag")},function(c){});a.store("loadLeftMenuAd",true)}this.manager.removeClass("select");if(a.get("rel")=="movieBox"){if($("movieAc")){$("movieAc").addClass("none")}}if(a.getPrevious()){a.getAllPrevious().addClass("disable")}if(a.getNext()){a.getAllNext().removeClass("disable")}a.removeClass("disable");
a.addClass("select");var b=a.getDimensions().y;this.toggleSlide(a,b)},autoScroll:function(){var a=this;this.manager.each(function(b){var c=document.getElement("div[data="+b.get("rel")+"]");if(c){if(a.wrapper.getScroll().y>=c.getCoordinates().top-200&&a.wrapper.getScroll().y+500<(c.getCoordinates().top)+(c.getCoordinates().height)){a.goWalk(b)}}})},toggleSlide:function(a,b){var a=$(a);this.manager.each(function(c){if(a.get("rel")=="movieBox"){if($("movieAc")){$("movieAc").removeClass("none")}}else{if(c!=a){c.setStyle("height","auto")}}})}});var noobSlide=new Class({initialize:function(d){this.items=d.items;this.mode=d.mode||"horizontal";this.modes={horizontal:["left","width"],vertical:["top","height"]};this.size=d.size||240;this.box=d.box.setStyle(this.modes[this.mode][1],(this.size*this.items.length)+"px");this.button_event=d.button_event||"click";this.handle_event=d.handle_event||"click";this.onWalk=d.onWalk||null;this.currentIndex=null;this.previousIndex=null;this.nextIndex=null;this.interval=d.interval||5000;this.autoPlay=d.autoPlay||false;this._play=null;this.handles=d.handles||null;if(this.handles){this.addHandleButtons(this.handles)}this.buttons={previous:[],next:[],play:[],playback:[],stop:[]};if(d.addButtons){for(var c in d.addButtons){this.addActionButtons(c,$type(d.addButtons[c])=="array"?d.addButtons[c]:[d.addButtons[c]])}}this.fx=new Fx.Tween(this.box,$extend((d.fxOptions||{duration:500,wait:false}),{property:this.modes[this.mode][0]}));this.walk((d.startItem||0),true,true)},addHandleButtons:function(b){for(var c=0;
c<b.length;c++){b[c].addEvent(this.handle_event,this.walk.pass([c,true],this))}},addActionButtons:function(d,c){for(var e=0;e<c.length;e++){switch(d){case"previous":c[e].addEvent(this.button_event,this.previous.pass([true],this));break;case"next":c[e].addEvent(this.button_event,this.next.pass([true],this));break;case"play":c[e].addEvent(this.button_event,this.play.pass([this.interval,"next",false],this));break;case"playback":c[e].addEvent(this.button_event,this.play.pass([this.interval,"previous",false],this));break;case"stop":c[e].addEvent(this.button_event,this.stop.create({bind:this}));break}this.buttons[d].push(c[e])}},previous:function(b){this.walk((this.currentIndex>0?this.currentIndex-1:this.items.length-1),b)},next:function(b){this.walk((this.currentIndex<this.items.length-1?this.currentIndex+1:0),b)},play:function(e,d,f){this.stop();if(!f){this[d](false)}this._play=this[d].periodical(e,this,[false])},stop:function(){$clear(this._play)},walk:function(e,d,f){if(e!=this.currentIndex){this.currentIndex=e;
this.previousIndex=this.currentIndex+(this.currentIndex>0?-1:this.items.length-1);this.nextIndex=this.currentIndex+(this.currentIndex<this.items.length-1?1:1-this.items.length);if(d){this.stop()}if(f){this.fx.cancel().set((this.size*-this.currentIndex)+"px")}else{this.fx.start(this.size*-this.currentIndex)}if(d&&this.autoPlay){this.play(this.interval,"next",true)}if(this.onWalk){this.onWalk((this.items[this.currentIndex]||null),(this.handles&&this.handles[this.currentIndex]?this.handles[this.currentIndex]:null))}}}});